<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹</title>
    <link href="/2021/11/10/algorithm-test-11042/"/>
    <url>/2021/11/10/algorithm-test-11042/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ n ä¸ªèŠ‚ç‚¹å¹¶è¿”å›é“¾è¡¨çš„å¤´æŒ‡é’ˆ<br>ä¾‹å¦‚ï¼Œ<br>ç»™å‡ºçš„é“¾è¡¨ä¸º: 1â†’2â†’3â†’4â†’5, n=2<br>åˆ é™¤äº†é“¾è¡¨çš„å€’æ•°ç¬¬ nn ä¸ªèŠ‚ç‚¹ä¹‹å, é“¾è¡¨å˜ä¸º1â†’2â†’3â†’5.</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml">è¾“å…¥ï¼š</span><br><span class="xml"></span><span class="hljs-template-variable">&#123;1,2&#125;</span><span class="xml">,2    </span><br><span class="xml">è¿”å›å€¼ï¼š</span><br><span class="xml"></span><span class="hljs-template-variable">&#123;2&#125;</span><br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>è¿ç”¨å¿«æ…¢æŒ‡é’ˆçš„æ€æƒ³</li><li>è®© faster å…ˆèµ° n æ­¥ï¼Œå†è®© faster å’Œ slower ä¸€èµ·èµ°ï¼Œè¿™æ ·åœ¨ faster èµ°åˆ°é“¾è¡¨ç»“å°¾æ—¶ï¼Œå‡è®¾æ€»çš„æ˜¯ x æ­¥ï¼Œæ­¤æ—¶ slowerèµ°çš„æ­¥æ•°æ˜¯ x-n æ­¥ï¼Œé‚£è·ç¦»é“¾è¡¨å°¾å°±æ˜¯ x-(x-n) = n æ­¥</li></ol><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * function ListNode(x)&#123;</span><br><span class="hljs-comment"> *   this.val = x;</span><br><span class="hljs-comment"> *   this.next = null;</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>head ListNodeç±» </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>n intæ•´å‹ </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return </span>ListNodeç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeNthFromEnd</span>(<span class="hljs-params">head, n</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (head == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> head<br>    &#125;<br>    <span class="hljs-keyword">let</span> slower = head<br>    <span class="hljs-keyword">let</span> faster = head<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>        faster = faster.next<br>    &#125;<br>    <span class="hljs-comment">// åˆ¤æ–­ n æ˜¯å¦å¤§äº head çš„é•¿åº¦</span><br>    <span class="hljs-keyword">if</span> (faster == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> head.next<br>    &#125;<br>    <span class="hljs-keyword">while</span> (faster.next) &#123;<br>        faster = faster.next<br>        slower = slower.next<br>    &#125;<br>    slower.next = slower.next.next<br>    <span class="hljs-keyword">return</span> head<br>&#125;<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">removeNthFromEnd</span>: removeNthFromEnd<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è¡¨è¾¾å¼æ±‚å€¼</title>
    <link href="/2021/11/08/algorithm-test-11041/"/>
    <url>/2021/11/08/algorithm-test-11041/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>è¯·å†™ä¸€ä¸ªæ•´æ•°è®¡ç®—å™¨ï¼Œæ”¯æŒåŠ å‡ä¹˜ä¸‰ç§è¿ç®—å’Œæ‹¬å·ã€‚</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">è¾“å…¥ï¼š<br><span class="hljs-string">&quot;1+2&quot;</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹ 2"></a>ç¤ºä¾‹ 2</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼š<br>&quot;(2*(3<span class="hljs-string">-4</span>))*5&quot;<br>è¿”å›å€¼ï¼š<br><span class="hljs-string">-10</span><br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹ 3"></a>ç¤ºä¾‹ 3</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼š<br>&quot;3<span class="hljs-string">+2</span>*3*4<span class="hljs-string">-1</span>&quot;<br>è¿”å›å€¼ï¼š<br>26<br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>å¯¹äºã€Œä»»ä½•è¡¨è¾¾å¼ã€è€Œè¨€ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨ä¸¤ä¸ªæ ˆ nums å’Œ opsï¼š</p><ul><li>nums ï¼š å­˜æ”¾æ‰€æœ‰çš„æ•°å­—</li><li>ops ï¼šå­˜æ”¾æ‰€æœ‰çš„æ•°å­—ä»¥å¤–çš„æ“ä½œ</li></ul><p>ç„¶åä»å‰å¾€ååšï¼Œå¯¹éå†åˆ°çš„å­—ç¬¦åšåˆ†æƒ…å†µè®¨è®ºï¼š</p><ul><li>ç©ºæ ¼ : è·³è¿‡</li><li>( : ç›´æ¥åŠ å…¥ ops ä¸­ï¼Œç­‰å¾…ä¸ä¹‹åŒ¹é…çš„ )</li><li>) : ä½¿ç”¨ç°æœ‰çš„ nums å’Œ ops è¿›è¡Œè®¡ç®—ï¼Œç›´åˆ°é‡åˆ°å·¦è¾¹æœ€è¿‘çš„ä¸€ä¸ªå·¦æ‹¬å·ä¸ºæ­¢ï¼Œè®¡ç®—ç»“æœæ”¾åˆ° nums<br>æ•°å­— : ä»å½“å‰ä½ç½®å¼€å§‹ç»§ç»­å¾€åå–ï¼Œå°†æ•´ä¸€ä¸ªè¿ç»­æ•°å­—æ•´ä½“å–å‡ºï¼ŒåŠ å…¥ nums</li><li><code>+ - *</code> : éœ€è¦å°†æ“ä½œæ”¾å…¥ ops ä¸­ã€‚åœ¨æ”¾å…¥ä¹‹å‰å…ˆæŠŠæ ˆå†…å¯ä»¥ç®—çš„éƒ½ç®—æ‰ï¼ˆåªæœ‰ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œæ‰è¿›è¡Œè¿ç®—ï¼‰ï¼Œä½¿ç”¨ç°æœ‰çš„ nums å’Œ ops è¿›è¡Œè®¡ç®—ï¼Œç›´åˆ°æ²¡æœ‰æ“ä½œæˆ–è€…é‡åˆ°å·¦æ‹¬å·ï¼Œè®¡ç®—ç»“æœæ”¾åˆ° nums<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ ğŸŒ° æ¥ç†è§£ åªæœ‰ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œæ‰è¿›è¡Œè¿ç®— æ˜¯ä»€ä¹ˆæ„æ€ï¼š</li></ul><p>å› ä¸ºæˆ‘ä»¬æ˜¯ä»å‰å¾€ååšçš„ï¼Œå‡è®¾æˆ‘ä»¬å½“å‰å·²ç»æ‰«æåˆ° 2 + 1 äº†ï¼ˆæ­¤æ—¶æ ˆå†…çš„æ“ä½œä¸º + ï¼‰ã€‚</p><p>å¦‚æœåé¢å‡ºç°çš„ + 2 æˆ–è€… - 1 çš„è¯ï¼Œæ»¡è¶³ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œå¯ä»¥å°† 2 + 1 ç®—æ‰ï¼ŒæŠŠç»“æœæ”¾åˆ° nums ä¸­ï¼›<br>å¦‚æœåé¢å‡ºç°çš„æ˜¯ * 2 çš„è¯ï¼Œä¸æ»¡è¶³ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œè¿™æ—¶å€™ä¸èƒ½è®¡ç®— 2 + 1ã€‚</p><p>ä¸€äº›ç»†èŠ‚ï¼š</p><ul><li>ç”±äºç¬¬ä¸€ä¸ªæ•°å¯èƒ½æ˜¯è´Ÿæ•°ï¼Œä¸ºäº†å‡å°‘è¾¹ç•Œåˆ¤æ–­ã€‚ä¸€ä¸ªå°æŠ€å·§æ˜¯å…ˆå¾€ nums æ·»åŠ ä¸€ä¸ª 0</li><li>ä¸ºé˜²æ­¢ () å†…å‡ºç°çš„é¦–ä¸ªå­—ç¬¦ä¸ºè¿ç®—ç¬¦ï¼Œå°†æ‰€æœ‰çš„ç©ºæ ¼å»æ‰ï¼Œå¹¶å°† (- æ›¿æ¢ä¸º (0-ï¼Œ(+ æ›¿æ¢ä¸º (0+ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¸è¿›è¡Œè¿™æ ·çš„é¢„å¤„ç†ï¼Œå°†è¿™ä¸ªå¤„ç†é€»è¾‘æ”¾åˆ°å¾ªç¯é‡Œå»åšï¼‰</li><li>ä»ç†è®ºä¸Šåˆ†æï¼Œnums æœ€å¥½å­˜æ”¾çš„æ˜¯ longï¼Œè€Œä¸æ˜¯ intã€‚å› ä¸ºå¯èƒ½å­˜åœ¨ å¤§æ•° + å¤§æ•° + å¤§æ•° + â€¦ - å¤§æ•° - å¤§æ•° çš„è¡¨è¾¾å¼å¯¼è‡´ä¸­é—´ç»“æœæº¢å‡ºï¼Œæœ€ç»ˆç­”æ¡ˆä¸æº¢å‡ºçš„æƒ…å†µ</li></ul><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment"> * è¿”å›è¡¨è¾¾å¼çš„å€¼</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>s stringå­—ç¬¦ä¸² å¾…è®¡ç®—çš„è¡¨è¾¾å¼</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return </span>intæ•´å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">solve</span>(<span class="hljs-params">s</span>) </span>&#123;<br>    <span class="hljs-keyword">let</span> opsMap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([<br>        [<span class="hljs-string">&#x27;+&#x27;</span>, <span class="hljs-number">1</span>],<br>        [<span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-number">1</span>],<br>        [<span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-number">2</span>]<br>    ])<br>    <span class="hljs-comment">// å°†æ‰€æœ‰çš„ç©ºæ ¼å»æ‰</span><br>    s = s.replace(<span class="hljs-regexp">/^\s+/g</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-comment">// å­˜æ”¾æ‰€æœ‰çš„æ•°å­—</span><br>    <span class="hljs-keyword">let</span> nums = []<br>    <span class="hljs-comment">// ä¸ºäº†é˜²æ­¢ç¬¬ä¸€ä¸ªæ•°ä¸ºè´Ÿæ•°ï¼Œå…ˆå¾€ nums åŠ ä¸ª 0</span><br>    nums.push(<span class="hljs-number">0</span>)<br>    <span class="hljs-comment">// å­˜æ”¾æ“ä½œç¬¦</span><br>    <span class="hljs-keyword">let</span> ops = []<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; s.length; i++) &#123;<br>        <span class="hljs-keyword">if</span> (s[i] == <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>            ops.push(s[i])<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s[i] == <span class="hljs-string">&#x27;)&#x27;</span>) &#123;<br>            <span class="hljs-comment">// è®¡ç®—åˆ°æœ€è¿‘çš„ä¸€ä¸ªå·¦æ‹¬å·ä¸ºæ­¢</span><br>            <span class="hljs-keyword">while</span> (ops.length != <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">const</span> op = ops.pop()<br>                <span class="hljs-keyword">if</span> (op != <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>                    calc(nums, ops)<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">break</span><br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isNaN</span>(s[i])) &#123;<br>                <span class="hljs-keyword">let</span> u = <span class="hljs-number">0</span>,<br>                    j = i<br>                <span class="hljs-comment">// å°†ä» i ä½ç½®å¼€å§‹åé¢çš„è¿ç»­æ•°å­—æ•´ä½“å–å‡ºï¼ŒåŠ å…¥ nums</span><br>                <span class="hljs-keyword">while</span> (j &lt; s.length &amp;&amp; !<span class="hljs-built_in">isNaN</span>(s[j])) &#123;<br>                    u = u * <span class="hljs-number">10</span> + <span class="hljs-built_in">Number</span>(s[j++])<br>                    nums.push(u)<br>                    i = j - <span class="hljs-number">1</span><br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; s[i - <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;(&#x27;</span> || s[i - <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;+&#x27;</span> || s[i - <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;-&#x27;</span>) &#123;<br>                    nums.push(<span class="hljs-number">0</span>)<br>                &#125;<br>                <span class="hljs-comment">// æœ‰ä¸€ä¸ªæ–°æ“ä½œè¦å…¥æ ˆæ—¶ï¼Œå…ˆæŠŠæ ˆå†…å¯ä»¥ç®—çš„éƒ½ç®—äº†</span><br>                <span class="hljs-comment">// åªæœ‰æ»¡è¶³ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œæ‰è¿›è¡Œè¿ç®—</span><br>                <span class="hljs-keyword">while</span> (!(ops.length == <span class="hljs-number">0</span>) &amp;&amp; s[s.length - <span class="hljs-number">1</span>] != <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>                    <span class="hljs-keyword">const</span> prev = ops.pop()<br>                    <span class="hljs-keyword">if</span> (opsMap.get(prev) &gt;= opsMap.get(s[i])) &#123;<br>                        calc(nums, ops)<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">break</span><br>                    &#125;<br>                &#125;<br>                ops.push(s[i])<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ((ops.length !== <span class="hljs-number">0</span>) &amp;&amp; ops[ops.length - <span class="hljs-number">1</span>] != <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>        calc(nums, ops)<br>    &#125;<br>    <span class="hljs-keyword">return</span> nums.pop()<br>&#125;<br><br><span class="hljs-comment">// è®¡ç®—é€»è¾‘ï¼šä» nums ä¸­å–å‡ºä¸¤ä¸ªæ“ä½œæ•°ï¼Œä» ops ä¸­å–å‡ºè¿ç®—ç¬¦ï¼Œç„¶åæ ¹æ®è¿ç®—ç¬¦è®¡ç®—</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calc</span>(<span class="hljs-params">nums, ops</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (nums.length &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> (ops.length == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">let</span> b = nums.pop(),<br>        a = nums.pop()<br>    <span class="hljs-keyword">let</span> op = ops.pop()<br>    <span class="hljs-keyword">let</span> ans = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&#x27;+&#x27;</span>) &#123;<br>        ans = a + b<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&#x27;-&#x27;</span>) &#123;<br>        ans = a - b<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&#x27;*&#x27;</span>) &#123;<br>        ans = a * b<br>    &#125;<br>    nums.push(ans)<br>&#125;<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">solve</span>: solve<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¤§æ•°åŠ æ³•</title>
    <link href="/2021/11/04/algorithm-test-1104/"/>
    <url>/2021/11/04/algorithm-test-1104/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¯»å…¥ä¸¤ä¸ªæ•°å­—ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°è®¡ç®—å®ƒä»¬çš„å’Œï¼Œä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ã€‚</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">è¾“å…¥ï¼š<br><span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;99&quot;</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-string">&quot;100&quot;</span><br>è¯´æ˜ï¼š<br>1+<span class="hljs-attribute">99</span>=100    <br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹ 2"></a>ç¤ºä¾‹ 2</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">è¾“å…¥ï¼š<br><span class="hljs-string">&quot;114514&quot;</span>,<span class="hljs-string">&quot;&quot;</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-string">&quot;114514&quot;</span><br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>å…ˆæŠŠä¸¤ä¸ªæ•°è¡¥å…¨è‡³ç›¸åŒé•¿åº¦ï¼Œä¸å¤Ÿé•¿çš„å‰é¢è¡¥ 0</li><li>ä»ä¸ªä½å¼€å§‹åŠ ï¼Œå¤§äº 10 çš„è¿› 1ï¼Œå°äº 10 çš„å–ä½™æ•°</li><li>å½“æœ€å carry ç­‰äº 1 æ—¶ï¼Œéœ€è¦å†è¿›ä¸€ä½</li></ol><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment"> * è®¡ç®—ä¸¤ä¸ªæ•°ä¹‹å’Œ</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>s stringå­—ç¬¦ä¸² è¡¨ç¤ºç¬¬ä¸€ä¸ªæ•´æ•°</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>t stringå­—ç¬¦ä¸² è¡¨ç¤ºç¬¬äºŒä¸ªæ•´æ•°</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return </span>stringå­—ç¬¦ä¸²</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">solve</span>(<span class="hljs-params">s, t</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (s === <span class="hljs-string">&#x27;&#x27;</span> || t === <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> s + t<br>    &#125;<br>    <span class="hljs-keyword">let</span> m = s.length,<br>        n = t.length,<br>        res = []<br>    <span class="hljs-keyword">while</span> (m &lt; n) &#123;<br>        s = <span class="hljs-string">&#x27;0&#x27;</span> + s<br>        m = s.length<br>    &#125;<br>    <span class="hljs-keyword">while</span> (m &gt; n) &#123;<br>        t = <span class="hljs-string">&#x27;0&#x27;</span> + t<br>        n = t.length<br>    &#125;<br>    <span class="hljs-keyword">let</span> carry = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-built_in">Math</span>.max(m, n) - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>        <span class="hljs-keyword">let</span> temp = <span class="hljs-built_in">parseInt</span>(s[i]) + <span class="hljs-built_in">parseInt</span>(t[i]) + carry<br>        carry = <span class="hljs-built_in">Math</span>.floor(temp / <span class="hljs-number">10</span>) &gt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span><br>        res.unshift(temp % <span class="hljs-number">10</span>)<br>    &#125;<br>    <span class="hljs-keyword">if</span> (carry == <span class="hljs-number">1</span>) &#123;<br>        res.unshift(<span class="hljs-number">1</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> res.join(<span class="hljs-string">&#x27;&#x27;</span>)<br>&#125;<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">solve</span>: solve<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨äºŒå‰æ ‘ä¸­æ‰¾åˆ°ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</title>
    <link href="/2021/11/03/algorithm-test-1103/"/>
    <url>/2021/11/03/algorithm-test-1103/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç»™å®šä¸€æ£µäºŒå‰æ ‘(ä¿è¯éç©º)ä»¥åŠè¿™æ£µæ ‘ä¸Šçš„ä¸¤ä¸ªèŠ‚ç‚¹å¯¹åº”çš„valå€¼ o1 å’Œ o2ï¼Œè¯·æ‰¾åˆ° o1 å’Œ o2 çš„æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹ã€‚</p><p>æ³¨ï¼šæœ¬é¢˜ä¿è¯äºŒå‰æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„valå€¼å‡ä¸ç›¸åŒã€‚</p><p>å¦‚å½“è¾“å…¥[3,5,1,6,2,0,8,#,#,7,4],5,1æ—¶ï¼ŒäºŒå‰æ ‘{3,5,1,6,2,0,8,#,#,7,4}å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://uploadfiles.nowcoder.com/images/20211014/423483716_1634206667843/D2B5CA33BD970F64A6301FA75AE2EB22" alt="äºŒå‰æ ‘"></p><p>æ‰€ä»¥èŠ‚ç‚¹å€¼ä¸º5å’ŒèŠ‚ç‚¹å€¼ä¸º1çš„èŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹çš„èŠ‚ç‚¹å€¼ä¸º3ï¼Œæ‰€ä»¥å¯¹åº”çš„è¾“å‡ºä¸º3ã€‚</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs clean">è¾“å…¥ï¼š<br>[<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">6</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">8</span>,#,#,<span class="hljs-number">7</span>,<span class="hljs-number">4</span>],<span class="hljs-number">5</span>,<span class="hljs-number">1</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>ä»å¤´å¾€ä¸‹æ‰¾ï¼Œå½“ root ä¸ºç©ºï¼Œæˆ–è€… root.val ç­‰äº o1 æˆ–è€… o2 æ—¶ï¼Œè¿”å› root</li><li>å½“ left ä¸ºç©ºæ—¶ï¼Œåˆ™è¿™ä¸¤ä¸ªèŠ‚ç‚¹åœ¨ root èŠ‚ç‚¹çš„å³å­æ ‘ä¸Šï¼Œç›´æ¥ä»å³å­æ ‘æŸ¥æ‰¾</li><li>å½“ right ä¸ºç©ºæ—¶ï¼Œåˆ™è¿™ä¸¤ä¸ªèŠ‚ç‚¹åœ¨ root èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸Šï¼Œç›´æ¥ä»å·¦å­æ ‘æŸ¥æ‰¾</li><li>å½“éƒ½ä¸ä¸ºç©ºæ—¶ï¼Œåˆ™ä¸€ä¸ªåœ¨å·¦å­æ ‘ï¼Œä¸€ä¸ªåœ¨å³å­æ ‘ä¸Šï¼Œè¿”å› root èŠ‚ç‚¹å³å¯</li></ol><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * function TreeNode(x) &#123;</span><br><span class="hljs-comment"> *   this.val = x;</span><br><span class="hljs-comment"> *   this.left = null;</span><br><span class="hljs-comment"> *   this.right = null;</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>root TreeNodeç±» </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>o1 intæ•´å‹ </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>o2 intæ•´å‹ </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return </span>intæ•´å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lowestCommonAncestor</span>(<span class="hljs-params">root, o1, o2</span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> helper(root, o1, o2).val<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">helper</span>(<span class="hljs-params">root, o1, o2</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span> || root.val === o1 || root.val === o2) &#123;<br>        <span class="hljs-keyword">return</span> root<br>    &#125;<br>    <span class="hljs-keyword">let</span> left = helper(root.left, o1, o2)<br>    <span class="hljs-keyword">let</span> right = helper(root.right, o1, o2)<br>    <span class="hljs-keyword">if</span> (left == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> right<br>    &#125;<br>    <span class="hljs-keyword">if</span> (right == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> left<br>    &#125;<br>    <span class="hljs-keyword">return</span> root<br>&#125;<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">lowestCommonAncestor</span>: lowestCommonAncestor<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ</title>
    <link href="/2021/11/02/algorithm-test-11021/"/>
    <url>/2021/11/02/algorithm-test-11021/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•´å‹æ•°ç»„aï¼Œæ•°ç»„ä¸­çš„ä¸€ä¸ªæˆ–è¿ç»­å¤šä¸ªæ•´æ•°ç»„æˆä¸€ä¸ªå­æ•°ç»„ã€‚æ±‚æ‰€æœ‰å­æ•°ç»„çš„å’Œçš„æœ€å¤§å€¼ã€‚è¦æ±‚æ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼š<br>[1,<span class="hljs-string">-2</span>,3,10,<span class="hljs-string">-4</span>,7,2,<span class="hljs-string">-5</span>]<br>è¿”å›å€¼ï¼š<br>18<br>è¯´æ˜ï¼š<br>ç»åˆ†æå¯çŸ¥ï¼Œè¾“å…¥æ•°ç»„çš„å­æ•°ç»„[3,10,<span class="hljs-string">-4</span>,7,2]å¯ä»¥æ±‚å¾—æœ€å¤§å’Œä¸º18<br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹ 2"></a>ç¤ºä¾‹ 2</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">è¾“å…¥ï¼š<br><span class="hljs-string">[2]</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹ 3"></a>ç¤ºä¾‹ 3</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼š<br>[<span class="hljs-string">-10</span>]<br>è¿”å›å€¼ï¼š<br><span class="hljs-string">-10</span><br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>åŠ¨æ€è§„åˆ’ï¼ŒåŠ¨æ€è§„åˆ’æ–¹ç¨‹ï¼šdp[i] = max(dp[i-1]+array[i], array[i])</li></ol><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FindGreatestSumOfSubArray</span>(<span class="hljs-params">array</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (array.length === <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    <span class="hljs-keyword">let</span> max = array[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">let</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(array.length).fill(<span class="hljs-number">0</span>)<br>    dp[<span class="hljs-number">0</span>] = max<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; array.length; i++) &#123;<br>        dp[i] = <span class="hljs-built_in">Math</span>.max(dp[i - <span class="hljs-number">1</span>] + array[i], array[i])<br>        max = <span class="hljs-built_in">Math</span>.max(dp[i], max)<br>    &#125;<br>    <span class="hljs-keyword">return</span> max<br>&#125;<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">FindGreatestSumOfSubArray</span>: FindGreatestSumOfSubArray<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>äºŒåˆ†æŸ¥æ‰¾-II</title>
    <link href="/2021/11/02/algorithm-test-1102/"/>
    <url>/2021/11/02/algorithm-test-1102/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>è¯·å®ç°æœ‰é‡å¤æ•°å­—çš„å‡åºæ•°ç»„çš„äºŒåˆ†æŸ¥æ‰¾<br>ç»™å®šä¸€ä¸ª å…ƒç´ æœ‰åºçš„ï¼ˆå‡åºï¼‰é•¿åº¦ä¸ºnçš„æ•´å‹æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ target  ï¼Œå†™ä¸€ä¸ªå‡½æ•°æœç´¢ nums ä¸­çš„ç¬¬ä¸€ä¸ªå‡ºç°çš„targetï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼š<br><span class="hljs-string">[1,2,4,4,5]</span>,<span class="hljs-number">4</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">2</span><br>è¯´æ˜ï¼š<br>ä»å·¦åˆ°å³ï¼ŒæŸ¥æ‰¾åˆ°ç¬¬<span class="hljs-number">1</span>ä¸ªä¸º<span class="hljs-number">4</span>çš„ï¼Œä¸‹æ ‡ä¸º<span class="hljs-number">2</span>ï¼Œè¿”å›<span class="hljs-number">2</span> <br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹ 2"></a>ç¤ºä¾‹ 2</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼š<br><span class="hljs-string">[1,2,4,4,5]</span>,<span class="hljs-number">3</span><br>è¿”å›å€¼ï¼š<br>-<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹ 3"></a>ç¤ºä¾‹ 3</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼š<br><span class="hljs-string">[1,1,1,1,1]</span>,<span class="hljs-number">1</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>äºŒåˆ†æ³•æŸ¥æ‰¾</li><li>å½“ä¸­é—´æ•°æ˜¯ target æ—¶ï¼Œres å…ˆç­‰äº midï¼Œä½†å¯èƒ½å·¦è¾¹çš„æ•°æ‰æ˜¯ç¬¬ä¸€ä¸ªï¼Œæ‰€ä»¥è¦ right = mid - 1ã€‚</li><li>å½“ä¸­é—´æ•°å°äº target æ—¶ï¼Œres è‚¯å®šåœ¨ä¸­é—´æ•°çš„å³ä¾§ï¼Œæ‰€ä»¥ left = mid + 1ã€‚</li><li>å½“ä¸­é—´æ•°å¤§äº target æ—¶ï¼Œres è‚¯å®šåœ¨ä¸­é—´æ•°çš„å³ä¾§ï¼Œæ‰€ä»¥ right = mid - 1</li></ol><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * å¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>nums intæ•´å‹ä¸€ç»´æ•°ç»„ </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>target intæ•´å‹ </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return </span>intæ•´å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">search</span>(<span class="hljs-params">nums, target</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (nums.length === <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>    &#125;<br>    <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>,<br>        right = nums.length - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">let</span> mid;<br>    <span class="hljs-keyword">let</span> res = -<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (left &lt;= right) &#123;<br>        mid = <span class="hljs-built_in">Math</span>.floor((right + left) / <span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">if</span> (nums[mid] === target) &#123;<br>            right = mid - <span class="hljs-number">1</span><br>            res = mid<br>        &#125;<br>        <span class="hljs-keyword">if</span> (nums[mid] &lt; target) &#123;<br>            left = mid + <span class="hljs-number">1</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (nums[mid] &gt; target) &#123;<br>            right = mid - <span class="hljs-number">1</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">search</span>: search<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¿«åº”ç”¨å¦‚ä½•å¢å¼ºè¯­æ³•æ£€æŸ¥èƒ½åŠ›</title>
    <link href="/2021/10/28/language-check/"/>
    <url>/2021/10/28/language-check/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è™½ç„¶åœ¨å¿«åº”ç”¨å¼€å‘å·¥å…·é‡Œï¼Œå·²ç»é›†æˆäº†è¯­æ³•æç¤ºã€è‡ªåŠ¨è¡¥å…¨ç­‰èƒ½åŠ›ï¼Œä½†å¦‚æœæ‚¨æƒ³å¯¹é¡¹ç›®çš„ä»£ç è¿›è¡Œè¿›ä¸€æ­¥æ ¡éªŒï¼Œç»™ä»£ç å®šä¹‰ä¸€ä¸ªè§„èŒƒï¼Œå¿…é¡»æŒ‰ç…§è¿™ä¸ªè§„èŒƒè¿›è¡Œä»£ç çš„ç¼–å†™ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ eslintï¼Œå¹¶ç»“åˆ huskyã€lint-staged æ’ä»¶æ¥å¢å¼ºè¯­æ³•æ£€æŸ¥ã€‚</p><h2 id="ä½¿ç”¨-eslint"><a href="#ä½¿ç”¨-eslint" class="headerlink" title="ä½¿ç”¨ eslint"></a>ä½¿ç”¨ eslint</h2><h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h3><p>éœ€è¦å…¨å±€å®‰è£… eslint æˆ–è€…åªåœ¨å½“å‰é¡¹ç›®ä¸‹å®‰è£… eslint</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm i eslint -g<br></code></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm i eslint --save-dev<br></code></pre></td></tr></table></figure><p>ç”±äºä¼šç”¨åˆ° <code>eslint-plugin-vue</code> çš„èƒ½åŠ›ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¦åœ¨é¡¹ç›®ä¸‹å®‰è£… <code>eslint-plugin-vue</code> ä¾èµ–ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm i eslint-plugin-vue --save-dev<br></code></pre></td></tr></table></figure><h3 id="æ–°å»º-eslint-é…ç½®æ–‡ä»¶"><a href="#æ–°å»º-eslint-é…ç½®æ–‡ä»¶" class="headerlink" title="æ–°å»º eslint é…ç½®æ–‡ä»¶"></a>æ–°å»º eslint é…ç½®æ–‡ä»¶</h3><p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»º .eslintrc æ–‡ä»¶ï¼Œå¹¶ç¼–å†™é…ç½®ï¼Œä¸‹é¢ä¸ºç®€å•çš„é…ç½®é¡¹ï¼Œè‹¥é¡¹ç›®ä¸­æœ‰é¢å¤–çš„è¦æ±‚ï¼Œå¯æ ¹æ® vue çš„è§„åˆ™è‡ªå·±é¢å¤–é…ç½®ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;env&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;commonjs&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;node&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;es6&quot;</span>: <span class="hljs-literal">true</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;extends&quot;</span>: [<br>    <span class="hljs-string">&quot;eslint:recommended&quot;</span>,<br>    <span class="hljs-string">&quot;plugin:vue/base&quot;</span><br>  ],<br>  <span class="hljs-attr">&quot;globals&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;loadData&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;saveData&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;history&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;console&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;setTimeout&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;clearTimeout&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;setInterval&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;clearInterval&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;TextDecoder&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;$utils&quot;</span>: <span class="hljs-literal">true</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;rules&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;vue/html-end-tags&quot;</span>: <span class="hljs-string">&quot;warn&quot;</span>,<br>    <span class="hljs-attr">&quot;vue/html-quotes&quot;</span>: <span class="hljs-string">&quot;warn&quot;</span>,<br>    <span class="hljs-attr">&quot;vue/comment-directive&quot;</span>: <span class="hljs-string">&quot;off&quot;</span>,<br>    <span class="hljs-attr">&quot;no-unused-vars&quot;</span>: [<br>      <span class="hljs-string">&quot;warn&quot;</span>,<br>      &#123;<br>        <span class="hljs-attr">&quot;varsIgnorePattern&quot;</span>: <span class="hljs-string">&quot;prompt&quot;</span><br>      &#125;<br>    ],<br>    <span class="hljs-attr">&quot;quotes&quot;</span>: [<br>      <span class="hljs-string">&quot;warn&quot;</span>,<br>      <span class="hljs-string">&quot;single&quot;</span>,<br>      &#123;<br>        <span class="hljs-attr">&quot;avoidEscape&quot;</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">&quot;allowTemplateLiterals&quot;</span>: <span class="hljs-literal">true</span><br>      &#125;<br>    ],<br>    <span class="hljs-attr">&quot;linebreak-style&quot;</span>: [<span class="hljs-string">&quot;warn&quot;</span>, <span class="hljs-string">&quot;unix&quot;</span>],<br>    <span class="hljs-attr">&quot;semi&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-string">&quot;never&quot;</span>]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼š é…ç½®ä¸­éœ€è¦å…³é—­ <code>vue/commet/directive</code>ã€‚</p><h3 id="å¢åŠ -script-è„šæœ¬å‘½ä»¤"><a href="#å¢åŠ -script-è„šæœ¬å‘½ä»¤" class="headerlink" title="å¢åŠ  script è„šæœ¬å‘½ä»¤"></a>å¢åŠ  script è„šæœ¬å‘½ä»¤</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;lint&quot;</span>: <span class="hljs-string">&quot;eslint &#x27;src/**/*.ux&#x27;&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ç»ˆç«¯è¿è¡Œ <code>npm run lint</code>ï¼Œå³å¯ç”¨ eslint å¯¹ src ä¸‹æ‰€æœ‰çš„ ux æ–‡ä»¶è¿›è¡Œè¯­æ³•æ£€æŸ¥ã€‚</p><h2 id="ä½¿ç”¨-huskyã€lint-staged-æ’ä»¶"><a href="#ä½¿ç”¨-huskyã€lint-staged-æ’ä»¶" class="headerlink" title="ä½¿ç”¨ huskyã€lint-staged æ’ä»¶"></a>ä½¿ç”¨ huskyã€lint-staged æ’ä»¶</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm i husky lint-staged --save-dev<br></code></pre></td></tr></table></figure><h3 id="husky"><a href="#husky" class="headerlink" title="husky"></a>husky</h3><p>åœ¨æˆåŠŸå®‰è£…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ git commit çš„æ—¶å€™è§¦å‘ pre-commit é’©å­ä»è€Œè§¦å‘åˆ° huskyï¼Œæˆ‘ä»¬åœ¨ package.json æ–‡ä»¶ä¸­é…ç½® husky çš„é’©å­éœ€è¦æ‰§è¡Œçš„å‘½ä»¤æˆ–æ“ä½œã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;husky&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;hooks&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;pre-commit&quot;</span>: <span class="hljs-string">&quot;yarn run precommit-msg &amp;&amp; lint-staged&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨ git commit çš„æ—¶å€™å°±ä¼šçœ‹åˆ° pre-commit æ‰§è¡Œäº†ã€‚</p><p><img src="https://zhanstatic.vivo.com.cn/wukong/img/23945cdb-8c01-46d6-a14d-956eeebf1747.jpg" alt="pre-commit"></p><p><strong>æ³¨æ„ï¼š</strong>æ–°ç‰ˆæœ¬çš„ husky å¯èƒ½æ— æ³•ç”Ÿæ•ˆï¼Œé™ä½ husky ç‰ˆæœ¬å³å¯ï¼Œæœ¬æ–‡é‡‡ç”¨çš„æ˜¯ <a href="mailto:&#104;&#117;&#115;&#107;&#121;&#64;&#52;&#46;&#51;&#46;&#56;">&#104;&#117;&#115;&#107;&#121;&#64;&#52;&#46;&#51;&#46;&#56;</a> ç‰ˆæœ¬</p><h3 id="lint-staged"><a href="#lint-staged" class="headerlink" title="lint-staged"></a>lint-staged</h3><p>lint-staged æ˜¯ä¸€ä¸ªåœ¨ git æš‚å­˜æ–‡ä»¶ä¸Šï¼ˆä¹Ÿå°±æ˜¯è¢« git add çš„æ–‡ä»¶ï¼‰è¿è¡Œå·²é…ç½®çš„ linterï¼ˆæˆ–å…¶ä»–ï¼‰ä»»åŠ¡ã€‚lint-staged æ€»æ˜¯å°†æ‰€æœ‰æš‚å­˜æ–‡ä»¶çš„åˆ—è¡¨ä¼ é€’ç»™ä»»åŠ¡ã€‚</p><p>æˆ‘ä»¬åœ¨ package.json æ–‡ä»¶ä¸­é…ç½®</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;lint-staged&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;**/**.&#123;ux,js,json,less,scss,css,pcss,md,vue&#125;&quot;</span>: [<br>      <span class="hljs-string">&quot;prettier --write&quot;</span>,<br>      <span class="hljs-string">&quot;eslint &#x27;src/**/*.ux&#x27;&quot;</span>,<br>      <span class="hljs-string">&quot;git add&quot;</span><br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œ lint-staged çš„é…ç½®æ˜¯ï¼šåœ¨ git çš„å¾…æäº¤çš„æ–‡ä»¶ä¸­ï¼Œæ‰€æœ‰ ux,js,json,less,scss,css,pcss,md,vue æ–‡ä»¶éƒ½è¦æ‰§è¡Œä¸¤æ¡å‘½ä»¤åœ¨ commit ä¹‹å‰ï¼Œå°†æš‚å­˜åŒºçš„å†…å®¹åšä¸€æ¬¡ä»£ç ç¾åŒ–å’Œ eslint æ ¼å¼æ£€æŸ¥ï¼Œç„¶åå†æ·»åŠ åˆ°æš‚å­˜åŒºã€‚</p><p>ç»“åˆæˆ‘ä»¬å‰é¢ä»‹ç»çš„ huskyï¼Œé…åˆ husky çš„ pre-commit é’©å­ï¼Œå°†ä¼šå½¢æˆä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·é“¾ã€‚</p><h2 id="ä½¿ç”¨-hap-eslint-æ’ä»¶"><a href="#ä½¿ç”¨-hap-eslint-æ’ä»¶" class="headerlink" title="ä½¿ç”¨ hap-eslint æ’ä»¶"></a>ä½¿ç”¨ hap-eslint æ’ä»¶</h2><h3 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h3><p>åœ¨å•†åº—æœç´¢ hap-eslintï¼Œç‚¹å‡»ã€Œå®‰è£…ã€ï¼Œå³å¯å®‰è£…å¿«åº”ç”¨çš„ eslint æ’ä»¶ï¼Œè¯¥æ’ä»¶ä¼šæ£€æµ‹é¡¹ç›®ä¸‹æ˜¯å¦é…ç½®äº† eslintï¼Œä»è€Œæ¥å¯¹ ux æ–‡ä»¶ä»¥åŠ js æ–‡ä»¶è¿›è¡Œé™æ€è¯­æ³•æ£€æŸ¥ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>å»ºè®®å®‰è£… 7.x ç‰ˆæœ¬çš„ eslintã€‚</p><h3 id="å¯ç”¨-eslint"><a href="#å¯ç”¨-eslint" class="headerlink" title="å¯ç”¨ eslint"></a>å¯ç”¨ eslint</h3><p>ç‚¹å‡»åº•éƒ¨çŠ¶æ€æ çš„ eslint çŠ¶æ€ï¼Œæ ¹æ®æç¤ºé€‰æ‹© eslint çš„ä½œç”¨èŒƒå›´ã€‚è‡³æ­¤ï¼Œæ‚¨å·²ç»å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ eslint äº†ã€‚</p><p><img src="https://zhanstatic.vivo.com.cn/wukong/img/34e85452-792a-4663-ab4e-cc87bfa568a0.jpg" alt="å¯ç”¨ eslint"></p><h3 id="å¯ç”¨ä¿å­˜æ—¶è‡ªåŠ¨-Fix"><a href="#å¯ç”¨ä¿å­˜æ—¶è‡ªåŠ¨-Fix" class="headerlink" title="å¯ç”¨ä¿å­˜æ—¶è‡ªåŠ¨ Fix"></a>å¯ç”¨ä¿å­˜æ—¶è‡ªåŠ¨ Fix</h3><p>åœ¨è®¾ç½®ä¸­æœç´¢: <code>eslint: auto fix on save</code>ï¼Œå‹¾é€‰è¿™ä¸ªé€‰é¡¹ï¼Œåˆ™å¯ä»¥åœ¨ä¿å­˜æ–‡ä»¶æ—¶ï¼Œè‡ªåŠ¨æ ¹æ®é…ç½®æ ¼å¼åŒ–ä»£ç ã€‚</p><p><img src="https://zhanstatic.vivo.com.cn/wukong/img/49a7ed12-1949-4ead-8546-341016074272.jpg" alt="å¯ç”¨ä¿å­˜æ—¶è‡ªåŠ¨fix"></p><h3 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p><img src="https://zhanstatic.vivo.com.cn/wukong/img/c58e0341-255b-47a6-9285-1bfa09b2cdda.gif" alt="æ•ˆæœ"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä»‹ç»äº†åœ¨å¿«åº”ç”¨ä¸­å¦‚ä½•è¿ç”¨ eslint ç»“åˆ husky å’Œ lint-staged æ¥å¯¹ä»£ç è¿›è¡ŒåŠ å¼ºè¯­æ³•æ£€æŸ¥å¹¶è§„å®šæ•´ä¸ªé¡¹ç›®çš„ä»£ç é£æ ¼ï¼Œååˆ†æ–¹ä¾¿ï¼Œè€Œä¸”èƒ½ä½¿é¡¹ç›®çš„ä»£ç æ›´åŠ è§„èŒƒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å¿«åº”ç”¨</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯</title>
    <link href="/2021/10/28/algorithm-test-1027/"/>
    <url>/2021/10/28/algorithm-test-1027/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>åˆ¤æ–­ç»™å®šçš„é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚å¦‚æœæœ‰ç¯åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼š<br>&#123;3,2,0,<span class="hljs-string">-4</span>&#125;,1<br>è¿”å›å€¼ï¼š<br>true<br>è¯´æ˜ï¼š<br>ç¬¬ä¸€éƒ¨åˆ†&#123;3,2,0,<span class="hljs-string">-4</span>&#125;ä»£è¡¨ä¸€ä¸ªé“¾è¡¨ï¼Œç¬¬äºŒéƒ¨åˆ†çš„1è¡¨ç¤ºï¼Œ<span class="hljs-string">-4</span>åˆ°ä½ç½®1ï¼Œå³<span class="hljs-string">-4</span>-&gt;2å­˜åœ¨ä¸€ä¸ªé“¾æ¥ï¼Œç»„æˆä¼ å…¥çš„headä¸ºä¸€ä¸ªå¸¦ç¯çš„é“¾è¡¨ ,è¿”å›true     <br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹ 2"></a>ç¤ºä¾‹ 2</h3><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xquery">è¾“å…¥ï¼š<br>&#123;<span class="hljs-number">1</span>&#125;,-<span class="hljs-number">1</span><br>è¿”å›å€¼ï¼š<span class="hljs-built_in"></span><br><span class="hljs-built_in">false</span><br>è¯´æ˜ï¼š<br>ç¬¬ä¸€éƒ¨åˆ†&#123;<span class="hljs-number">1</span>&#125;ä»£è¡¨ä¸€ä¸ªé“¾è¡¨ï¼Œ-<span class="hljs-number">1</span>ä»£è¡¨æ— ç¯ï¼Œç»„æˆä¼ <span class="hljs-built_in">å…¥head</span>ä¸ºä¸€ä¸ªæ— ç¯çš„å•é“¾è¡¨ï¼Œè¿”<span class="hljs-built_in">å›false</span><br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹ 3"></a>ç¤ºä¾‹ 3</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼š<br>&#123;<span class="hljs-string">-1</span>,<span class="hljs-string">-7</span>,7,<span class="hljs-string">-4</span>,19,6,<span class="hljs-string">-9</span>,<span class="hljs-string">-5</span>,<span class="hljs-string">-2</span>,<span class="hljs-string">-5</span>&#125;,6<br>è¿”å›å€¼ï¼š<br>true<br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>è¿ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œå½“ä¸¤ä¸ªæŒ‡é’ˆç›¸é‡æ—¶ï¼Œå°±æ˜¯æœ‰ç¯ï¼Œå¦åˆ™æ˜¯æ— ç¯</p><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * function ListNode(x)&#123;</span><br><span class="hljs-comment"> *   this.val = x;</span><br><span class="hljs-comment"> *   this.next = null;</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>head ListNodeç±» </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return </span>boolå¸ƒå°”å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasCycle</span>(<span class="hljs-params">head</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (!head) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br>    <span class="hljs-keyword">let</span> faster = head,<br>        slower = head<br>    <span class="hljs-keyword">while</span> (faster &amp;&amp; faster.next) &#123;<br>        faster = faster.next.next<br>        slower = slower.next<br>        <span class="hljs-keyword">if</span> (faster = slower) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">hasCycle</span>: hasCycle<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æœ€é•¿æ— é‡å¤å­æ•°ç»„</title>
    <link href="/2021/10/26/algorithm-test-1026/"/>
    <url>/2021/10/26/algorithm-test-1026/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç»™å®šä¸€ä¸ªæ•°ç»„arrï¼Œè¿”å›arrçš„æœ€é•¿æ— é‡å¤å…ƒç´ å­æ•°ç»„çš„é•¿åº¦ï¼Œæ— é‡å¤æŒ‡çš„æ˜¯æ‰€æœ‰æ•°å­—éƒ½ä¸ç›¸åŒã€‚<br>å­æ•°ç»„æ˜¯è¿ç»­çš„ï¼Œæ¯”å¦‚[1,3,5,7,9]çš„å­æ•°ç»„æœ‰[1,3]ï¼Œ[3,5,7]ç­‰ç­‰ï¼Œä½†æ˜¯[1,3,7]ä¸æ˜¯å­æ•°ç»„</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">è¾“å…¥ï¼š<br><span class="hljs-string">[2,3,4,5]</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">4</span><br>è¯´æ˜ï¼š<br><span class="hljs-string">[2,3,4,5]</span>æ˜¯æœ€é•¿å­æ•°ç»„  <br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹ 2"></a>ç¤ºä¾‹ 2</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">è¾“å…¥ï¼š<br><span class="hljs-string">[2,2,3,4,3]</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">3</span><br>è¯´æ˜ï¼š<br><span class="hljs-string">[2,3,4]</span>æ˜¯æœ€é•¿å­æ•°ç»„ <br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹ 3"></a>ç¤ºä¾‹ 3</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">è¾“å…¥ï¼š<br><span class="hljs-string">[9]</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-4"><a href="#ç¤ºä¾‹-4" class="headerlink" title="ç¤ºä¾‹ 4"></a>ç¤ºä¾‹ 4</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css">è¾“å…¥ï¼š<br><span class="hljs-selector-attr">[1,2,3,1,2,3,2,2]</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">3</span><br>è¯´æ˜ï¼š<br>æœ€é•¿å­æ•°ç»„ä¸º<span class="hljs-selector-attr">[1,2,3]</span>  <br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-5"><a href="#ç¤ºä¾‹-5" class="headerlink" title="ç¤ºä¾‹ 5"></a>ç¤ºä¾‹ 5</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼š<br><span class="hljs-string">[2,2,3,4,8,99,3]</span><br>è¿”å›å€¼ï¼š<br><span class="hljs-number">5</span><br>è¯´æ˜ï¼š<br>æœ€é•¿å­æ•°ç»„ä¸º<span class="hljs-string">[2,3,4,8,99]</span><br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>ç”¨åŒæŒ‡é’ˆ + å“ˆå¸Œæ¥åš</li><li>å½“æ•°ç»„å¤§å°å°äºç­‰äº 1 æ—¶è¿”å›æ•°ç»„å¤§å°</li><li>ç”¨ map æ¥å­˜å‚¨æ•°ç»„å€¼å¯¹åº”çš„ä¸‹æ ‡</li><li>å½“æ•°ç»„ä¸­çš„å€¼åœ¨ map ä¸­æœ‰æ—¶ï¼ŒæŠŠ start æŒ‡é’ˆæŒ‡å‘ end æ‰€åœ¨çš„ä½ç½®ï¼Œå¹¶ end + 1</li><li>å½“æ•°ç»„ä¸­çš„å€¼åœ¨ map ä¸­æ²¡æœ‰æ—¶ï¼Œåªéœ€è¦æŠŠ end æŒ‡é’ˆå‘åç§»åŠ¨</li><li>å½“ end çš„å€¼åˆ°æœ«å°¾æ—¶é€€å‡ºå¾ªç¯</li></ol><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>arr intæ•´å‹ä¸€ç»´æ•°ç»„ the array</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return </span>intæ•´å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxLength</span>(<span class="hljs-params">arr</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (arr.length &lt;= <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">return</span> arr.length<br>    &#125;<br>    <span class="hljs-keyword">let</span> start = <span class="hljs-number">0</span>,<br>        end = <span class="hljs-number">0</span>,<br>        max = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">const</span> cacheMap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()<br>    <span class="hljs-keyword">while</span> (end &lt; arr.length) &#123;<br>        cacheMap.set(arr[end], end)<br>        <span class="hljs-keyword">if</span> (cacheMap.has(arr[end])) &#123;<br>            max = <span class="hljs-built_in">Math</span>.max(end - start, max)<br>            start = cacheMap.get(arr[end])<br>            end = start + <span class="hljs-number">1</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            end++<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(end - start, max)<br>&#125;<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">maxLength</span>: maxLength<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</title>
    <link href="/2021/10/25/algorithm-test-1025/"/>
    <url>/2021/10/25/algorithm-test-1025/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç”¨ä¸¤ä¸ªæ ˆæ¥å®ç°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä½¿ç”¨nä¸ªå…ƒç´ æ¥å®Œæˆ n æ¬¡åœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥æ•´æ•°(push)å’Œnæ¬¡åœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤æ•´æ•°(pop)çš„åŠŸèƒ½ã€‚ é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ºintç±»å‹ã€‚ä¿è¯æ“ä½œåˆæ³•ï¼Œå³ä¿è¯popæ“ä½œæ—¶é˜Ÿåˆ—å†…å·²æœ‰å…ƒç´ ã€‚</p><p>æ•°æ®èŒƒå›´ï¼š nâ‰¤1000<br>è¦æ±‚ï¼šå­˜å‚¨nä¸ªå…ƒç´ çš„ç©ºé—´å¤æ‚åº¦ä¸º O(n)O(n) ï¼Œæ’å…¥ä¸åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)O(1)</p><h3 id="ç¤ºä¾‹1"><a href="#ç¤ºä¾‹1" class="headerlink" title="ç¤ºä¾‹1"></a>ç¤ºä¾‹1</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs 1c">è¾“å…¥ï¼š<br>[<span class="hljs-string">&quot;PSH1&quot;</span>,<span class="hljs-string">&quot;PSH2&quot;</span>,<span class="hljs-string">&quot;POP&quot;</span>,<span class="hljs-string">&quot;POP&quot;</span>]<br>è¿”å›å€¼ï¼š<br><span class="hljs-number">1</span>,<span class="hljs-number">2</span><br>è¯´æ˜ï¼š<br><span class="hljs-string">&quot;PSH1&quot;</span>:ä»£è¡¨å°†<span class="hljs-number">1</span>æ’å…¥é˜Ÿåˆ—å°¾éƒ¨<br><span class="hljs-string">&quot;PSH2&quot;</span>:ä»£è¡¨å°†<span class="hljs-number">2</span>æ’å…¥é˜Ÿåˆ—å°¾éƒ¨<br><span class="hljs-string">&quot;POPâ€œ:ä»£è¡¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œå…ˆè¿›å…ˆå‡º=&gt;è¿”å›1</span><br><span class="hljs-string">&quot;POPâ€œ:ä»£è¡¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œå…ˆè¿›å…ˆå‡º=&gt;è¿”å›2   </span><br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹2"><a href="#ç¤ºä¾‹2" class="headerlink" title="ç¤ºä¾‹2"></a>ç¤ºä¾‹2</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs csharp">è¾“å…¥ï¼š<br>[<span class="hljs-meta"><span class="hljs-meta-string">&quot;PSH2&quot;</span>,<span class="hljs-meta-string">&quot;POP&quot;</span>,<span class="hljs-meta-string">&quot;PSH1&quot;</span>,<span class="hljs-meta-string">&quot;POP&quot;</span></span>]<br>è¿”å›å€¼ï¼š<br><span class="hljs-number">2</span>,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>ä¸¤ä¸ªæ ˆç”¨æ•°ç»„æ¥è¡¨ç¤º</li><li>push æ–¹æ³•ï¼šç›´æ¥å¾€ stack1 ä¸­ push å…ƒç´ </li><li>pop æ–¹æ³•ï¼šæŠŠ stack2 å½“åšä¸­è½¬ç«™ï¼Œå½“ stack2 ä¸­æœ‰å…ƒç´ çš„æ—¶å€™ï¼Œå°±ç›´æ¥ pop å‡ºæ¥ï¼Œå½“ stack2 ä¸­æ²¡æœ‰å…ƒç´ çš„æ—¶å€™ï¼Œè¦æŠŠ stack1 çš„å…ƒç´ ä»å°¾åˆ°å¤´æ”¾å…¥åˆ° stack2 ä¸­ï¼Œç„¶åå† pop æœ€åçš„ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›ã€‚</li></ol><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> stack1 = []<br><span class="hljs-keyword">const</span> stack2 = []<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">push</span>(<span class="hljs-params">node</span>)</span><br><span class="hljs-function"></span>&#123;<br>    stack1.push(node)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pop</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(stack2.length === <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">while</span>(stack1.length !== <span class="hljs-number">0</span>) &#123;<br>            stack2.push(stack1.pop())<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> stack2.pop()<br>&#125;<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">push</span> : push,<br>    <span class="hljs-attr">pop</span> : pop<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡LRUç¼“å­˜ç»“æ„</title>
    <link href="/2021/10/24/algorithm-test-1024/"/>
    <url>/2021/10/24/algorithm-test-1024/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>è®¾è®¡LRU(æœ€è¿‘æœ€å°‘ä½¿ç”¨)ç¼“å­˜ç»“æ„ï¼Œè¯¥ç»“æ„åœ¨æ„é€ æ—¶ç¡®å®šå¤§å°ï¼Œå‡è®¾å¤§å°ä¸º k ï¼Œå¹¶æœ‰å¦‚ä¸‹ä¸¤ä¸ªåŠŸèƒ½</p><ol><li>set(key, value)ï¼šå°†è®°å½•(key, value)æ’å…¥è¯¥ç»“æ„</li><li>get(key)ï¼šè¿”å›keyå¯¹åº”çš„valueå€¼</li></ol><p>æç¤º:<br>1.æŸä¸ªkeyçš„setæˆ–getæ“ä½œä¸€æ—¦å‘ç”Ÿï¼Œè®¤ä¸ºè¿™ä¸ªkeyçš„è®°å½•æˆäº†æœ€å¸¸ä½¿ç”¨çš„ï¼Œç„¶åéƒ½ä¼šåˆ·æ–°ç¼“å­˜ã€‚<br>2.å½“ç¼“å­˜çš„å¤§å°è¶…è¿‡kæ—¶ï¼Œç§»é™¤æœ€ä¸ç»å¸¸ä½¿ç”¨çš„è®°å½•ã€‚<br>3.è¾“å…¥ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸kï¼ŒäºŒç»´æ•°ç»„æ¯ä¸€ç»´æœ‰2ä¸ªæˆ–è€…3ä¸ªæ•°å­—ï¼Œç¬¬1ä¸ªæ•°å­—ä¸ºoptï¼Œç¬¬2ï¼Œ3ä¸ªæ•°å­—ä¸ºkeyï¼Œvalue<br>è‹¥opt=1ï¼Œæ¥ä¸‹æ¥ä¸¤ä¸ªæ•´æ•°key, valueï¼Œè¡¨ç¤ºset(key, value)<br>è‹¥opt=2ï¼Œæ¥ä¸‹æ¥ä¸€ä¸ªæ•´æ•°keyï¼Œè¡¨ç¤ºget(key)ï¼Œè‹¥keyæœªå‡ºç°è¿‡æˆ–å·²è¢«ç§»é™¤ï¼Œåˆ™è¿”å›-1<br>å¯¹äºæ¯ä¸ªopt=2ï¼Œè¾“å‡ºä¸€ä¸ªç­”æ¡ˆ<br>4.ä¸ºäº†æ–¹ä¾¿åŒºåˆ†ç¼“å­˜é‡Œkeyä¸valueï¼Œä¸‹é¢è¯´æ˜çš„ç¼“å­˜é‡Œkeyç”¨â€â€å·åŒ…è£¹</p><p>è¦æ±‚ï¼šsetå’Œgetæ“ä½œå¤æ‚åº¦å‡ä¸º O(1)O(1)</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1"></a>ç¤ºä¾‹ 1</h3><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼š<br>[[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]],<span class="hljs-number">3</span><br>è¿”å›å€¼ï¼š<br>[<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>]<br>è¯´æ˜ï¼š<br>[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]ï¼Œç¬¬ä¸€ä¸ª<span class="hljs-number">1</span>è¡¨ç¤ºopt=<span class="hljs-number">1</span>ï¼Œè¦set(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)ï¼Œå³å°†(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)æ’å…¥ç¼“å­˜ï¼Œç¼“å­˜æ˜¯&#123;<span class="hljs-string">&quot;1&quot;</span>=<span class="hljs-number">1</span>&#125;<br>[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]ï¼Œç¬¬ä¸€ä¸ª<span class="hljs-number">1</span>è¡¨ç¤ºopt=<span class="hljs-number">1</span>ï¼Œè¦set(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)ï¼Œå³å°†(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)æ’å…¥ç¼“å­˜ï¼Œç¼“å­˜æ˜¯&#123;<span class="hljs-string">&quot;1&quot;</span>=<span class="hljs-number">1</span>,<span class="hljs-string">&quot;2&quot;</span>=<span class="hljs-number">2</span>&#125;<br>[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>]ï¼Œç¬¬ä¸€ä¸ª<span class="hljs-number">1</span>è¡¨ç¤ºopt=<span class="hljs-number">1</span>ï¼Œè¦set(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>)ï¼Œå³å°†(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>)æ’å…¥ç¼“å­˜ï¼Œç¼“å­˜æ˜¯&#123;<span class="hljs-string">&quot;1&quot;</span>=<span class="hljs-number">1</span>,<span class="hljs-string">&quot;2&quot;</span>=<span class="hljs-number">2</span>,<span class="hljs-string">&quot;3&quot;</span>=<span class="hljs-number">2</span>&#125;<br>[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]ï¼Œç¬¬ä¸€ä¸ª<span class="hljs-number">2</span>è¡¨ç¤ºopt=<span class="hljs-number">2</span>ï¼Œè¦get(<span class="hljs-number">1</span>)ï¼Œè¿”å›æ˜¯[<span class="hljs-number">1</span>]ï¼Œå› ä¸ºget(<span class="hljs-number">1</span>)æ“ä½œï¼Œç¼“å­˜æ›´æ–°ï¼Œç¼“å­˜æ˜¯&#123;<span class="hljs-string">&quot;2&quot;</span>=<span class="hljs-number">2</span>,<span class="hljs-string">&quot;3&quot;</span>=<span class="hljs-number">2</span>,<span class="hljs-string">&quot;1&quot;</span>=<span class="hljs-number">1</span>&#125;<br>[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>]ï¼Œç¬¬ä¸€ä¸ª<span class="hljs-number">1</span>è¡¨ç¤ºopt=<span class="hljs-number">1</span>ï¼Œè¦set(<span class="hljs-number">4</span>,<span class="hljs-number">4</span>)ï¼Œå³å°†(<span class="hljs-number">4</span>,<span class="hljs-number">4</span>)æ’å…¥ç¼“å­˜ï¼Œä½†æ˜¯ç¼“å­˜å·²ç»è¾¾åˆ°æœ€å¤§å®¹é‡<span class="hljs-number">3</span>ï¼Œç§»é™¤æœ€ä¸ç»å¸¸ä½¿ç”¨çš„&#123;<span class="hljs-string">&quot;2&quot;</span>=<span class="hljs-number">2</span>&#125;ï¼Œæ’å…¥&#123;<span class="hljs-string">&quot;4&quot;</span>=<span class="hljs-number">4</span>&#125;ï¼Œç¼“å­˜æ˜¯&#123;<span class="hljs-string">&quot;3&quot;</span>=<span class="hljs-number">2</span>,<span class="hljs-string">&quot;1&quot;</span>=<span class="hljs-number">1</span>,<span class="hljs-string">&quot;4&quot;</span>=<span class="hljs-number">4</span>&#125;<br>[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]ï¼Œç¬¬ä¸€ä¸ª<span class="hljs-number">2</span>è¡¨ç¤ºopt=<span class="hljs-number">2</span>ï¼Œè¦get(<span class="hljs-number">2</span>)ï¼ŒæŸ¥æ‰¾ä¸åˆ°ï¼Œè¿”å›æ˜¯[<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>]     <br></code></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹ 2"></a>ç¤ºä¾‹ 2</h3><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼š<br><span class="hljs-comment">[<span class="hljs-comment">[1,1,1]</span>,<span class="hljs-comment">[1,2,2]</span>,<span class="hljs-comment">[2,1]</span>,<span class="hljs-comment">[1,3,3]</span>,<span class="hljs-comment">[2,2]</span>,<span class="hljs-comment">[1,4,4]</span>,<span class="hljs-comment">[2,1]</span>,<span class="hljs-comment">[2,3]</span>,<span class="hljs-comment">[2,4]</span>]</span>,2<br>è¿”å›å€¼ï¼š<br><span class="hljs-comment">[1,-1,-1,3,4]</span><br></code></pre></td></tr></table></figure><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>ç”¨ä¸€ä¸ª map æ¥å­˜å‚¨ cache å€¼ï¼Œresult å­˜å‚¨è¿”å›å€¼</li><li>éå†æ‰€æœ‰çš„ operatorsï¼Œåˆ† set å’Œ get æ“ä½œ</li><li>set: å½“ cache çš„ size å°äº k æ—¶ï¼Œå¦‚æœ cache ä¸­æœ‰è¿™ä¸ªå€¼ï¼Œåˆ™åˆ é™¤è¿™ä¸ªå€¼ï¼Œå¹¶é‡æ–°æ·»åŠ åˆ° map çš„æœ«å°¾<br>å½“ cache çš„ size å¤§äºç­‰äº k æ—¶ï¼Œå¦‚æœ cache ä¸­æœ‰è¿™ä¸ªå€¼ï¼Œåˆ™åˆ é™¤è¿™ä¸ªå€¼ï¼Œå¹¶é‡æ–°æ·»åŠ åˆ° map çš„æœ«å°¾ï¼›å½“ä¸å­˜åœ¨<br>è¿™ä¸ªå€¼æ—¶ï¼Œéœ€è¦åˆ é™¤ map ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå†æ·»åŠ åˆ° map çš„æœ«å°¾ã€‚</li><li>get: å½“ cache ä¸­æœ‰è¿™ä¸ªå€¼æ—¶ï¼Œæ·»åŠ åˆ° result æ•°ç»„ä¸­ï¼Œå¹¶æŠŠ cache ä¸­è¿™ä¸ª key çš„å€¼åˆ é™¤ï¼Œé‡æ–°æ·»åŠ åˆ°æœ«å°¾ï¼ˆå·²è¢«ä½¿ç”¨ï¼‰ã€‚</li></ol><h2 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * lru design</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>operators intæ•´å‹äºŒç»´æ•°ç»„ the ops</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>k intæ•´å‹ the k</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return </span>intæ•´å‹ä¸€ç»´æ•°ç»„</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LRU</span>(<span class="hljs-params">operators, k</span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()<br>    <span class="hljs-keyword">const</span> result = []<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, n = operators.length; i &lt; n; i++) &#123;<br>        <span class="hljs-keyword">const</span> item = operators[i]<br>        <span class="hljs-comment">// set</span><br>        <span class="hljs-keyword">if</span> (item[<span class="hljs-number">0</span>] === <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">if</span> (cache.size &lt; k) &#123;<br>                <span class="hljs-comment">// map ç»“æ„é‡Œæœ‰è¿™ä¸ªå€¼,åˆ é™¤ï¼Œæ·»åŠ æ–°å€¼åˆ°æœ€å</span><br>                <span class="hljs-keyword">if</span> (cache.has(item[<span class="hljs-number">1</span>])) &#123;<br>                    cache.delete(item[<span class="hljs-number">1</span>])<br>                    cache.set(item[<span class="hljs-number">1</span>], item[<span class="hljs-number">2</span>])<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    cache.set(item[<span class="hljs-number">1</span>], item[<span class="hljs-number">2</span>])<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span> (cache.has(item[<span class="hljs-number">1</span>])) &#123;<br>                    cache.delete(item[<span class="hljs-number">1</span>])<br>                    cache.set(item[<span class="hljs-number">1</span>], item[<span class="hljs-number">2</span>])<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// åˆ é™¤ç¬¬ä¸€ä¸ªæ•°ï¼Œç„¶åæ·»åŠ åˆ°æœ«å°¾</span><br>                    <span class="hljs-keyword">const</span> firstKey = cache.entries().next().value[<span class="hljs-number">0</span>]<br>                    cache.delete(firstKey)<br>                    cache.set(item[<span class="hljs-number">1</span>], item[<span class="hljs-number">2</span>])<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item[<span class="hljs-number">0</span>] === <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">if</span> (cache.has(item[<span class="hljs-number">1</span>])) &#123;<br>                <span class="hljs-keyword">const</span> value = cache.get(item[<span class="hljs-number">1</span>])<br>                result.push(value)<br>                <span class="hljs-comment">// æŠŠå€¼æ”¾åˆ°æœ€å</span><br>                cache.delete(item[<span class="hljs-number">1</span>])<br>                cache.set(item[<span class="hljs-number">1</span>], value)<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                result.push(-<span class="hljs-number">1</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> result<br>&#125;<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">LRU</span>: LRU<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•ç”¨ vue3 å¼€å‘ IDE æ’ä»¶</title>
    <link href="/2021/07/25/vue3-extension-template/"/>
    <url>/2021/07/25/vue3-extension-template/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>å½“ä½ æƒ³å†™ IDE æ’ä»¶çš„æ—¶å€™ï¼Œæ˜¯å¦è§‰å¾—åŸç”Ÿçš„å†™æ³•å¤ªè¿‡éº»çƒ¦ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ç”¨æ¡†æ¶æ¥å†™ï¼Ÿå½“ webview é‡Œçš„é¡µé¢æœ‰ååˆ†å¤æ‚çš„äº¤äº’çš„æ—¶å€™ï¼Œå†™æ’ä»¶é‡Œçš„é¡µé¢å°±å˜æˆäº†ä¸€ä»¶ååˆ†å¤´ç–¼çš„äº‹ï¼Œä»»å‡­å¤–é¢çš„æ¡†æ¶å¦‚ä½•èŠ±é‡Œèƒ¡å“¨ï¼Œä½ ä¹Ÿåªèƒ½ä½¿ç”¨åŸç”Ÿçš„å†™æ³•æ¥å®ç°ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•æŠŠ Vue3 è¿ç”¨åˆ°æ’ä»¶é‡Œæ¥å¼€å‘ã€‚</p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><h2 id="åˆ›å»ºæ’ä»¶"><a href="#åˆ›å»ºæ’ä»¶" class="headerlink" title="åˆ›å»ºæ’ä»¶"></a>åˆ›å»ºæ’ä»¶</h2><p>å…¨å±€å®‰è£… yo å’Œ generator-code:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install -g yo generator-code<br></code></pre></td></tr></table></figure><p>æŒ‰ç…§æ­¥éª¤ï¼Œæ–°å»ºæ’ä»¶ï¼Œé€‰æ‹© Typescript æ¥å¼€å‘æ’ä»¶:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell">yo code<br><br> _-----_     â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®<br>|       |    â”‚   Welcome to the Visual  â”‚<br>|--(o)--|    â”‚   Studio Code Extension  â”‚<br>`---------Â´   â”‚        generator!        â”‚<br>( _Â´U`_ )    â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯<br>/___A___\   /<br> |  ~  |<br>__&#x27;.___.&#x27;__<br>Â´   `  |Â° Â´ Y `<br><br> ? What type of extension do you want to create? New Extension (TypeScript)<br> ? What&#x27;s the name of your extension? helloWorld<br> ? What&#x27;s the identifier of your extension? helloworld<br> ? What&#x27;s the description of your extension?<br> ? Initialize a git repository? No<br> ? Bundle the source code with webpack? Yes<br> ? Which package manager to use?<br> npm<br> â¯ yarn<br></code></pre></td></tr></table></figure><h2 id="æ–°å»º-vue-é¡¹ç›®"><a href="#æ–°å»º-vue-é¡¹ç›®" class="headerlink" title="æ–°å»º vue é¡¹ç›®"></a>æ–°å»º vue é¡¹ç›®</h2><p>è¿›å…¥æ’ä»¶ç›®å½•ï¼Œæ–°å»ºä¸€ä¸ªåä¸º frontend çš„ vue é¡¹ç›®ï¼Œéœ€è¦å…ˆå®‰è£… vue cliã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vue create frontend<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™é‡Œçš„ vue é¡¹ç›®è¿˜æ˜¯ js çš„ï¼Œæˆ‘ä»¬æŠŠå®ƒæ¢æˆ ts çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vue add typescript<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼š å…¶ä¸­çš„ Convert all .js files to .ts é€‰é¡¹é€‰ Yã€‚</p><h1 id="æ–°å»ºæ’ä»¶è¦æ‰“å¼€çš„-panel"><a href="#æ–°å»ºæ’ä»¶è¦æ‰“å¼€çš„-panel" class="headerlink" title="æ–°å»ºæ’ä»¶è¦æ‰“å¼€çš„ panel"></a>æ–°å»ºæ’ä»¶è¦æ‰“å¼€çš„ panel</h1><p>æ–°å»º TemplatePanel ç±»</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// TemplatePanel.ts</span><br><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TemplatePanel</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> currentPanel: TemplatePanel | <span class="hljs-literal">undefined</span>;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> _panel: vscode.WebviewPanel;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> _context: vscode.ExtensionContext;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> _extensionPath: <span class="hljs-built_in">string</span>;<br>  <span class="hljs-keyword">private</span> _disposables: vscode.Disposable[] = [];<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">    panel: vscode.WebviewPanel,</span></span><br><span class="hljs-params"><span class="hljs-function">    context: vscode.ExtensionContext</span></span><br><span class="hljs-params"><span class="hljs-function">  </span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>._panel = panel;<br>    <span class="hljs-built_in">this</span>._context = context;<br>    <span class="hljs-built_in">this</span>._extensionPath = context.extensionPath;<br>    <span class="hljs-built_in">this</span>.initialize();<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-title">initialize</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>._panel.onDidDispose(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">this</span>.dispose(), <span class="hljs-literal">null</span>, <span class="hljs-built_in">this</span>._disposables);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">show</span>(<span class="hljs-params">context: vscode.ExtensionContext</span>)</span> &#123;<br>    <span class="hljs-comment">// å¦‚æœæ‰“å¼€äº†é¡µé¢ï¼Œä¸é‡å¤æ‰“å¼€</span><br>    <span class="hljs-keyword">if</span> (TemplatePanel.currentPanel) &#123;<br>      <span class="hljs-keyword">const</span> column = vscode.window.activeTextEditor<br>        ? vscode.window.activeTextEditor.viewColumn<br>        : <span class="hljs-literal">undefined</span>;<br>      TemplatePanel.currentPanel._panel.reveal(column);<br>      <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> panel = vscode.window.createWebviewPanel(<br>      <span class="hljs-string">&quot;Template&quot;</span>,<br>      localize(<span class="hljs-string">&quot;template&quot;</span>),<br>      vscode.ViewColumn.Active,<br>      &#123;<br>        <span class="hljs-attr">enableScripts</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">retainContextWhenHidden</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-comment">// ç”¨äº IDE è‡ªå¸¦çš„æ–‡ä»¶åè®®çš„å¯è¯»è·¯å¾„</span><br>        <span class="hljs-attr">localResourceRoots</span>: [<br>          vscode.Uri.file(path.join(context.extensionPath, <span class="hljs-string">&quot;media&quot;</span>)),<br>          vscode.Uri.file(path.join(context.extensionPath, <span class="hljs-string">&quot;frontend&quot;</span>, <span class="hljs-string">&quot;dist&quot;</span>)),<br>        ],<br>      &#125;<br>    );<br><br>    TemplatePanel.currentPanel = <span class="hljs-keyword">new</span> TemplatePanel(panel, context);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-title">dispose</span>(<span class="hljs-params"></span>)</span> &#123;<br>    TemplatePanel.currentPanel = <span class="hljs-literal">undefined</span>;<br>    <span class="hljs-built_in">this</span>._panel.dispose();<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">this</span>._disposables.length) &#123;<br>      <span class="hljs-keyword">const</span> x = <span class="hljs-built_in">this</span>._disposables.pop();<br>      <span class="hljs-keyword">if</span> (x) &#123;<br>        x.dispose();<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å¦‚ä½•è·å–-vue-çš„å‰ç«¯é¡µé¢"><a href="#å¦‚ä½•è·å–-vue-çš„å‰ç«¯é¡µé¢" class="headerlink" title="å¦‚ä½•è·å– vue çš„å‰ç«¯é¡µé¢"></a>å¦‚ä½•è·å– vue çš„å‰ç«¯é¡µé¢</h2><p>è¯»å– vue é¡¹ç›®æ‰“åŒ…åçš„æ–‡ä»¶ï¼Œå¹¶æŠŠå¼•ç”¨çš„æ–‡ä»¶è·¯å¾„æ›¿æ¢æˆ IDE èƒ½å¤Ÿè¯†åˆ«çš„æ–‡ä»¶åè®®æ ¼å¼ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getWebviewContent</span>(<span class="hljs-params">extensionPath: <span class="hljs-built_in">string</span></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> distPath = vscode.Uri.file(<br>    path.join(extensionPath, <span class="hljs-string">&quot;frontend&quot;</span>, <span class="hljs-string">&quot;dist&quot;</span>)<br>  ).with(&#123; <span class="hljs-attr">scheme</span>: <span class="hljs-string">&quot;vscode-resource&quot;</span> &#125;);<br>  <span class="hljs-comment">// è¯»å– dits ä¸‹çš„ index.html</span><br>  <span class="hljs-keyword">let</span> html = <span class="hljs-keyword">await</span> fse.readFile(<br>    path.join(__dirname, <span class="hljs-string">&quot;../frontend/dist/index.html&quot;</span>)<br>  );<br>  <span class="hljs-keyword">const</span> hrefReg = <span class="hljs-regexp">/href=([&quot;&#x27;]&#123;1&#125;)\/&#123;1&#125;([^\/])/gi</span>;<br>  <span class="hljs-keyword">const</span> srcReg = <span class="hljs-regexp">/src=([&quot;&#x27;]&#123;1&#125;)\/&#123;1&#125;([^\/])/gi</span>;<br>  <span class="hljs-comment">// æŠŠæ–‡ä»¶è·¯å¾„æ›¿æ¢æˆ IDE èƒ½å¤Ÿè¯†åˆ«çš„æ–‡ä»¶åè®®æ ¼å¼</span><br>  <span class="hljs-keyword">let</span> str = html<br>    .toString()<br>    .replace(hrefReg, <span class="hljs-string">`href=$1<span class="hljs-subst">$&#123;distPath&#125;</span>/$2`</span>)<br>    .replace(srcReg, <span class="hljs-string">`src=$1<span class="hljs-subst">$&#123;distPath&#125;</span>/$2`</span>);<br>  <span class="hljs-keyword">return</span> str;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ initialize æ–¹æ³•ä¸­èµ‹å€¼ webview çš„ htmlï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// TemplatePanel.ts ä¸­çš„ initialize æ–¹æ³•</span><br><span class="hljs-built_in">this</span>._panel.webview.html = <span class="hljs-keyword">await</span> getWebviewContent(<span class="hljs-built_in">this</span>._extensionPath);<br></code></pre></td></tr></table></figure><h2 id="å»ºç«‹æ’ä»¶ç«¯å’Œå‰ç«¯é¡µé¢ï¼ˆVueï¼‰çš„é€šä¿¡"><a href="#å»ºç«‹æ’ä»¶ç«¯å’Œå‰ç«¯é¡µé¢ï¼ˆVueï¼‰çš„é€šä¿¡" class="headerlink" title="å»ºç«‹æ’ä»¶ç«¯å’Œå‰ç«¯é¡µé¢ï¼ˆVueï¼‰çš„é€šä¿¡"></a>å»ºç«‹æ’ä»¶ç«¯å’Œå‰ç«¯é¡µé¢ï¼ˆVueï¼‰çš„é€šä¿¡</h2><p>vue ç¼–å†™çš„é¡µé¢ç›¸å½“äºæ˜¯å‰ç«¯ï¼ˆæµè§ˆå™¨ç«¯ï¼‰ï¼Œè€Œæ’ä»¶ç«¯çš„é€»è¾‘ç›¸å½“äºæ˜¯åç«¯ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰ï¼Œä¸¤è€…éœ€è¦é€šä¿¡ï¼Œé‚£æ€ä¹ˆæ‰èƒ½åœ¨ä¸å¯åŠ¨æœåŠ¡çš„æƒ…å†µä¸‹è¿›è¡Œé€šä¿¡å‘¢ï¼Œè¿™å°±è¦ç”¨åˆ° postMessage äº†ã€‚</p><p>åœ¨å‰ç«¯é¡µé¢ä¸­ï¼Œå¢åŠ  message çš„ç›‘å¬ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// main.ts</span><br><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> message = event.data;<br>  <span class="hljs-keyword">switch</span> (message.command) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;setMessage&quot;</span>: &#123;<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>åœ¨æ’ä»¶ç«¯ï¼Œä¹Ÿè¦å¢åŠ  message çš„ç›‘å¬ï¼Œæˆ‘ä»¬å†™åœ¨ initialize æ–¹æ³•é‡Œï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-built_in">this</span>._panel.webview.onDidReceiveMessage(<br>  <span class="hljs-keyword">async</span> (message) =&gt; &#123;<br>    <span class="hljs-keyword">switch</span> (message.command) &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;getMessage&quot;</span>:<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-literal">null</span>,<br>  <span class="hljs-built_in">this</span>._disposables<br>);<br></code></pre></td></tr></table></figure><p>å‰ç«¯å‘åç«¯å‘é€æ¶ˆæ¯ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// main.ts</span><br><span class="hljs-comment">// å¼•å…¥ acquireVsCodeApi çš„æ–¹æ³•</span><br><span class="hljs-keyword">const</span> ide = acquireVsCodeApi();<br><span class="hljs-comment">// å‘é€æ¶ˆæ¯</span><br>ide.postMessage(&#123;<br>  <span class="hljs-attr">command</span>: <span class="hljs-string">&quot;getMessage&quot;</span>,<br>&#125;);<br></code></pre></td></tr></table></figure><p>åç«¯å‘å‰ç«¯å‘é€æ¶ˆæ¯ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// templatePanel.ts</span><br><span class="hljs-built_in">this</span>._panel.webview.postMessage(&#123;<br>  <span class="hljs-attr">command</span>: <span class="hljs-string">&quot;setMessage&quot;</span>,<br>  <span class="hljs-attr">data</span>: &#123;<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;hello&quot;</span>,<br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><h1 id="æ–°å¢-Vuex"><a href="#æ–°å¢-Vuex" class="headerlink" title="æ–°å¢ Vuex"></a>æ–°å¢ Vuex</h1><p>å®‰è£… vuexï¼Œç”±äºæˆ‘ä»¬ç”¨çš„æ˜¯ vue3ï¼Œæ‰€ä»¥è¦å®‰è£… vuex@next</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yarn add vuex@next --save<br></code></pre></td></tr></table></figure><p>åœ¨ store.ts ä¸­åˆå§‹åŒ– vuex</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// store.ts</span><br><span class="hljs-keyword">import</span> &#123; createStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vuex&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> store = createStore(&#123;<br>  <span class="hljs-attr">state</span>: &#123;&#125;,<br>  <span class="hljs-attr">modules</span>: &#123;&#125;,<br>&#125;);<br>åœ¨ mian.ts ä¸­å¼•å…¥ vuex<br><span class="hljs-comment">// main.ts</span><br><span class="hljs-keyword">import</span> &#123; store &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./store&quot;</span>;<br><span class="hljs-keyword">const</span> app = createApp(App);<br>app.use(store);<br>app.mount(<span class="hljs-string">&quot;#app&quot;</span>);<br></code></pre></td></tr></table></figure><h1 id="æ–°å¢å¤šè¯­è¨€ï¼ˆvue-i18nï¼‰"><a href="#æ–°å¢å¤šè¯­è¨€ï¼ˆvue-i18nï¼‰" class="headerlink" title="æ–°å¢å¤šè¯­è¨€ï¼ˆvue-i18nï¼‰"></a>æ–°å¢å¤šè¯­è¨€ï¼ˆvue-i18nï¼‰</h1><p>å®‰è£… vue-i18nï¼Œç”±äºæˆ‘ä»¬ç”¨çš„æ˜¯ vue3ï¼Œæ‰€ä»¥è¦å®‰è£… vue-i18n@next</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yarn add vue-i18n@next --save<br></code></pre></td></tr></table></figure><p>åœ¨ i18n.ts ä¸­åˆå§‹åŒ–</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// i18n.ts</span><br><span class="hljs-keyword">import</span> &#123; createI18n &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue-i18n&quot;</span>;<br><br><span class="hljs-keyword">const</span> en = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./locale/en.json&quot;</span>);<br><span class="hljs-keyword">const</span> zhCN = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./locale/zh-CN.json&quot;</span>);<br><br><span class="hljs-comment">// è¯­è¨€åŒ…æ ¹æ®è¯­è¨€ç¯å¢ƒåˆ†ç±»</span><br><span class="hljs-keyword">const</span> messages = &#123;<br>  en,<br>  <span class="hljs-string">&quot;zh-CN&quot;</span>: zhCN,<br>&#125;;<br><br><span class="hljs-keyword">const</span> i18n = createI18n(&#123;<br>  <span class="hljs-attr">locale</span>: <span class="hljs-string">&quot;zh-CN&quot;</span>, <span class="hljs-comment">// è®¾ç½®å½“å‰è¯­è¨€ç¯å¢ƒï¼Œé»˜è®¤ä¸­æ–‡ç®€ä½“</span><br>  messages, <span class="hljs-comment">// è®¾ç½®è¯­è¨€ç¯å¢ƒå¯¹åº”ä¿¡æ¯</span><br>&#125;);<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> i18n;<br></code></pre></td></tr></table></figure><p>åœ¨ mian.ts ä¸­å¼•å…¥ vue-i18n</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// main.ts</span><br><span class="hljs-keyword">import</span> i18n <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./i18n/index&quot;</span>;<br><span class="hljs-keyword">const</span> app = createApp(App);<br>app.use(i18n);<br>app.mount(<span class="hljs-string">&quot;#app&quot;</span>);<br>å¯ä»¥åœ¨ä»£ç ä¸­åˆ‡æ¢è¯­è¨€ï¼š<br><span class="hljs-built_in">this</span>.$i18n.locale = <span class="hljs-built_in">this</span>.language;<br></code></pre></td></tr></table></figure><h1 id="å¦‚ä½•åœ¨-vue-é¡¹ç›®ä¸­ä½¿ç”¨é™æ€æ–‡ä»¶"><a href="#å¦‚ä½•åœ¨-vue-é¡¹ç›®ä¸­ä½¿ç”¨é™æ€æ–‡ä»¶" class="headerlink" title="å¦‚ä½•åœ¨ vue é¡¹ç›®ä¸­ä½¿ç”¨é™æ€æ–‡ä»¶"></a>å¦‚ä½•åœ¨ vue é¡¹ç›®ä¸­ä½¿ç”¨é™æ€æ–‡ä»¶</h1><p>ç”±äºåœ¨ IDE çš„ webview ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ IDE çš„æ–‡ä»¶åè®®ï¼Œè€Œä¸æ˜¯æ­£å¸¸çš„ file:// åè®®ã€‚å½“ä½ ç›´æ¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–è€…ç»å¯¹è·¯å¾„æ—¶ï¼Œæ˜¯æ‰¾ä¸åˆ°é™æ€èµ„æºçš„ï¼Œé‚£ä¹ˆï¼Œè¦å¦‚ä½•æ‰èƒ½åœ¨ vue é‡Œç”¨ä¸Šé™æ€èµ„æºå‘¢ï¼Œæ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ vue é¡¹ç›®ç”¨ä¸Š IDE çš„æ–‡ä»¶åè®®å¤´å³å¯ï¼Œæˆ‘ä»¬è¿™é‡ŒæŠŠé™æ€èµ„æºæ”¾åœ¨ media ç›®å½•ä¸‹ã€‚</p><p>è·å–æ–‡ä»¶åè®®çš„ uri</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// è·å–æ–‡ä»¶åè®®çš„ uri</span><br><span class="hljs-built_in">this</span>._panel.webview.asWebviewUri(<br>                  vscode.Uri.file(path.join(<span class="hljs-built_in">this</span>._extensionPath, <span class="hljs-string">&quot;media&quot;</span>))<br>é€šè¿‡ä¹‹å‰çš„é€šä¿¡æ–¹å¼ï¼ŒæŠŠ uri ä¼ åˆ°å‰ç«¯é¡µé¢ã€‚<br><span class="hljs-built_in">this</span>._panel.webview.postMessage(&#123;<br>              <span class="hljs-attr">command</span>: <span class="hljs-string">&quot;setSetting&quot;</span>,<br>              <span class="hljs-attr">data</span>: &#123;<br>                <span class="hljs-attr">resource</span>: <span class="hljs-built_in">this</span>._panel.webview.asWebviewUri(<br>                  vscode.Uri.file(path.join(<span class="hljs-built_in">this</span>._extensionPath, <span class="hljs-string">&quot;media&quot;</span>))<br>                ),<br>              &#125;,<br></code></pre></td></tr></table></figure><p>å‰ç«¯æ¥æ”¶ä¹‹åæŠŠ uri æ‹¼æ¥æˆæ–‡ä»¶åè®®å¤´ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> resource =<br>  message.data.resource.scheme +<br>  <span class="hljs-string">&quot;://&quot;</span> +<br>  message.data.resource.authority +<br>  message.data.resource.path;<br></code></pre></td></tr></table></figure><p>åœ¨é¡µé¢ä¸­ä½¿ç”¨ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">&quot;`$&#123;resource&#125;/images/logo.png`&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥åœ¨å‰ç«¯é¡µé¢ä¸­ä½¿ç”¨é™æ€èµ„æºäº†ã€‚</p><h1 id="å¦‚ä½•è°ƒè¯•"><a href="#å¦‚ä½•è°ƒè¯•" class="headerlink" title="å¦‚ä½•è°ƒè¯•"></a>å¦‚ä½•è°ƒè¯•</h1><p>watch vue é¡¹ç›®å†…å®¹<br>åœ¨ frontend ç›®å½•ä¸‹çš„ package.json ä¸­é…ç½®å‘½ä»¤ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;watch&quot;</span>: <span class="hljs-string">&quot;vue-cli-service build --watch&quot;</span><br>  &#125;<br></code></pre></td></tr></table></figure><p>é…ç½®å®Œæˆä¹‹åï¼Œè¿è¡Œ yarn watchï¼Œå³å¯å®æ—¶ç›‘å¬ä»£ç å˜åŒ–ï¼Œæ— éœ€é‡æ–° buildã€‚</p><h2 id="watch-æ’ä»¶ä¸­å†…å®¹"><a href="#watch-æ’ä»¶ä¸­å†…å®¹" class="headerlink" title="watch æ’ä»¶ä¸­å†…å®¹"></a>watch æ’ä»¶ä¸­å†…å®¹</h2><p>ç”±äºåœ¨åˆ›å»ºæ’ä»¶æ¨¡æ¿çš„æ—¶å€™ï¼Œå·²ç»è‡ªè¡Œåˆ›å»ºäº† watch å‘½ä»¤ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨é¡¹ç›®çš„æ ¹ç›®å½•è¿è¡Œ yarn watch å³å¯ã€‚</p><h2 id="è¿ç”¨-vscode-è°ƒè¯•"><a href="#è¿ç”¨-vscode-è°ƒè¯•" class="headerlink" title="è¿ç”¨ vscode è°ƒè¯•"></a>è¿ç”¨ vscode è°ƒè¯•</h2><p>ç‚¹å‡»ä¾§è¾¹æ çš„ã€Œè¿è¡Œå’Œè°ƒè¯•ã€ï¼Œè¿è¡Œ Run Extension ä»»åŠ¡ã€‚</p><p>è¿è¡Œä¹‹åï¼Œä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„çª—å£ï¼Œä½¿ç”¨å¿«æ·é”® macï¼šcmd + shift + p winï¼šctrl + shift + pï¼Œè¾“å…¥ show panelï¼Œå³å¯æ‰“å¼€ä¹‹å‰å†™çš„é¡µé¢ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ç”¨ vue3 æ¥å¼€å‘ IDE æ’ä»¶ï¼Œèåˆäº† vuexã€typescriptã€vue-i18n ç­‰ï¼Œèƒ½å¤Ÿæ»¡è¶³æ—¥å¸¸çš„å¼€å‘ï¼Œå¦‚éœ€æŸ¥çœ‹æ›´å¤šçš„æ’ä»¶å¼€å‘å†…å®¹ï¼Œå¯æŸ¥çœ‹ æ–‡æ¡£ï¼Œæœ‰ä¸°å¯Œçš„ api èƒ½å¤Ÿä½¿ç”¨ã€‚</p><h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h1><p>é¡¹ç›®åœ°å€: <a href="">https://github.com/Jerome77777/vue3-ide-extension-template</a></p>]]></content>
    
    
    <categories>
      
      <category>vscode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>koa-middleware</title>
    <link href="/2021/07/18/koa-middleware/"/>
    <url>/2021/07/18/koa-middleware/</url>
    
    <content type="html"><![CDATA[<h1 id="Koa-çš„æ ¸å¿ƒæ‰©å±•æœºåˆ¶ï¼šä¸­é—´ä»¶"><a href="#Koa-çš„æ ¸å¿ƒæ‰©å±•æœºåˆ¶ï¼šä¸­é—´ä»¶" class="headerlink" title="Koa çš„æ ¸å¿ƒæ‰©å±•æœºåˆ¶ï¼šä¸­é—´ä»¶"></a>Koa çš„æ ¸å¿ƒæ‰©å±•æœºåˆ¶ï¼šä¸­é—´ä»¶</h1><h2 id="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"><a href="#ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"></a>ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶</h2><p>ä¸­é—´ä»¶æ˜¯æ¡†æ¶çš„æ‰©å±•æœºåˆ¶ï¼Œä¸»è¦ç”¨äºæŠ½è±¡ HTTP è¯·æ±‚è¿‡ç¨‹ã€‚åœ¨å•ä¸€è¯·æ±‚å“åº”è¿‡ç¨‹ä¸­åŠ å…¥ä¸­é—´ä»¶ï¼Œå¯ä»¥æ›´å¥½åœ°åº”å¯¹å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>å¦‚æœæŠŠ HTTTP å¤„ç†è¿‡ç¨‹æ¯”ä½œæ±¡æ°´å¤„ç†ï¼Œé‚£ä¹ˆä¸­é—´ä»¶å°±åƒä¸€å±‚å±‚çš„è¿‡æ»¤ç½‘ã€‚æ¯ä¸ªä¸­é—´ä»¶åœ¨ HTTP å¤„ç†è¿‡ç¨‹ä¸­é€šè¿‡æ”¹å†™è¯·æ±‚å’Œå“åº”æ•°æ®ã€çŠ¶æ€ï¼Œå®ç°ç‰¹å®šåŠŸèƒ½ã€‚å¤§å®¶éƒ½çŸ¥é“ HTTP æ˜¯æ— çŠ¶æ€åè®®ï¼Œæ‰€ä»¥ HTTP è¯·æ±‚çš„è¿‡ç¨‹å¯ä»¥è¿™æ ·ç†è§£ï¼šè¯·æ±‚è¢«å‘é€è¿‡æ¥ï¼Œç»è¿‡æ— æ•°ä¸­é—´ä»¶æ‹¦æˆªç›´è‡³è¢«å“åº”ä¸ºæ­¢ã€‚</p><p><a href="https://imgtu.com/i/W8n5Y8"><img src="https://z3.ax1x.com/2021/07/18/W8n5Y8.jpg" alt="W8n5Y8.jpg"></a></p><p>è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨åï¼Œä¾æ¬¡ç»è¿‡å„ä¸ªä¸­é—´ä»¶ï¼Œç›´è‡³è¢«å“åº”ï¼Œæ‰€ä»¥æ•´ä¸ªæµç¨‹ä¼šæµç» log ä¸­é—´ä»¶ï¼Œç”±è¯·æ±‚å“åº”ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰ä¸­é—´ä»¶ç»™ä¸å“åº”ï¼Œå…·ä½“æè¿°å¦‚ä¸‹ï¼š</p><ul><li>è¯·æ±‚åˆ°è¾¾ log ä¸­é—´ä»¶ï¼Œè®°å½•æ­¤æ—¶çš„æ—¶é—´ã€‚</li><li>æ”¾è¿‡ï¼Œæ‰§è¡Œ nextï¼Œæ­¤æ—¶ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚</li><li>æ‰§è¡Œåˆ°è¯·æ±‚å“åº”ä¸­é—´ä»¶ï¼Œé€šè¿‡ ctx.body å‘æµè§ˆå™¨è¾“å‡ºå“åº”ç»“æœã€‚</li><li>å½“å“åº”å›åˆ° log ä¸­é—´ä»¶æ—¶ï¼Œæ ¹æ®å½“å‰æ—¶é—´å‡å»è¯·æ±‚åˆ°è¾¾æ—¶é—´ï¼Œæ‰“å°è¯·æ±‚è€—æ—¶ã€‚</li><li>æœ€åæŠŠå“åº”å†™åˆ°æµè§ˆå™¨é‡Œã€‚</li></ul><h2 id="Koa-v2"><a href="#Koa-v2" class="headerlink" title="Koa v2"></a>Koa v2</h2><p>åœ¨ç®€å•äº†è§£äº†ä¸­é—´ä»¶ä¹‹åï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç» Koa v2 çš„å†…å®¹ã€‚Koa v2 æ˜¯ä¸€ä¸ªæˆç†Ÿçš„ Web æ¡†æ¶ï¼Œæ˜¯ç”± Koa v1 æ¼”è¿›è€Œæˆçš„ã€‚Koa v2 æœ€é‡è¦çš„ç‰¹æ€§æ˜¯æ”¯æŒ async å‡½æ•°ï¼Œå¹¶ä¸”åŒæ—¶æ”¯æŒå¦‚ä¸‹ 3 ç§ä¸åŒç±»å‹å‡½æ•°çš„ä¸­é—´ä»¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Node</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>vscode ä¾èµ–æ³¨å…¥</title>
    <link href="/2021/07/11/vscode-ioc/"/>
    <url>/2021/07/11/vscode-ioc/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨ vscode çš„æºç ä¸­ï¼Œæœ‰è®¸å¤šæœåŠ¡ï¼ˆServiceï¼‰ï¼Œè¿™äº›æœåŠ¡æä¾›ä¸åŒæ¨¡å—çš„ API ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨ï¼Œåœ¨éœ€è¦ä¾èµ–è¯¥æœåŠ¡çš„ç±»æ„é€ å™¨ä¸­ç”¨è£…é¥°å™¨çš„å½¢å¼å£°æ˜å‚æ•°ï¼Œå¼€å‘è€…ä¸éœ€è¦å†æ˜¾å¼åœ° new è¿™ä¸ªæœåŠ¡å¯¹è±¡ï¼Œåœ¨è°ƒç”¨è€…è¢«åˆ›å»ºæ—¶ï¼Œè¿™äº›ä¾èµ–çš„æœåŠ¡ä¼šè¢«è‡ªåŠ¨åˆ›å»ºå¹¶ä¼ é€’ç»™è°ƒç”¨è€…ï¼ŒæœåŠ¡ä¹‹é—´è¿˜èƒ½å¤Ÿç›¸äº’ä¾èµ–ï¼Œè¿™æ ·åšå¤§å¹…åº¦åœ°é™ä½äº†ç¨‹åºçš„è€¦åˆæ€§ã€‚æœ¬æ–‡å°†å¸¦ä½ ç®€å•äº†è§£ vscode çš„ä¾èµ–æ³¨å…¥ã€‚</p><h1 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h1><h2 id="Typescript-è£…é¥°å™¨"><a href="#Typescript-è£…é¥°å™¨" class="headerlink" title="Typescript è£…é¥°å™¨"></a>Typescript è£…é¥°å™¨</h2><p>å¦‚æœæ‚¨ä¸å¤ªäº†è§£ typescript è£…é¥°å™¨ï¼Œè¯·å…ˆé˜…è¯»æˆ‘ä¹‹å‰çš„æ–‡ç« <a href="https://chenjiangfeng.xyz/2021/07/03/decorators/">ã€ŠTypeScript è£…é¥°å™¨ã€‹</a></p><h1 id="ä¾èµ–æ³¨å…¥è¯¦è§£"><a href="#ä¾èµ–æ³¨å…¥è¯¦è§£" class="headerlink" title="ä¾èµ–æ³¨å…¥è¯¦è§£"></a>ä¾èµ–æ³¨å…¥è¯¦è§£</h1><h2 id="åˆ›å»ºæœåŠ¡"><a href="#åˆ›å»ºæœåŠ¡" class="headerlink" title="åˆ›å»ºæœåŠ¡"></a>åˆ›å»ºæœåŠ¡</h2><p>å®šä¹‰ä¸€ä¸ªç±»å¹¶åœ¨å…¶æ„é€ å‡½æ•°ä¸­å£°æ˜ä¾èµ–çš„æœåŠ¡</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span> </span>&#123;<br><span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function"><span class="hljs-meta">@IMyService</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> myService: IMyService</span></span><br><span class="hljs-params"><span class="hljs-function"></span>)</span> &#123;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨ç±»ä¸­ä½¿ç”¨äº†ä¸€ä¸ªè£…é¥°å™¨ @IMyServiceï¼Œç›¸ä¿¡ä½ çœ‹äº†é¢„å¤‡çŸ¥è¯†ä¹‹åï¼Œèƒ½å¤Ÿæ¸…æ¥šåœ°çŸ¥é“è¿™æ˜¯ä¸€ä¸ªå‚æ•°è£…é¥°å™¨ï¼Œè¯¥è£…é¥°å™¨ä¼šåœ¨è¿è¡Œæ—¶è¢«è°ƒç”¨ï¼Œå¹¶ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š</p><ul><li>å¯¹äºé™æ€æˆå‘˜æ¥è¯´æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œå¯¹äºå®ä¾‹æˆå‘˜æ˜¯ç±»çš„åŸå‹å¯¹è±¡</li><li>æˆå‘˜çš„åå­—</li><li>å‚æ•°åœ¨å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­çš„ç´¢å¼•<br>é‚£ä¹ˆï¼Œè¿™ä¸ª IMyService è£…é¥°å™¨æ˜¯å¦‚ä½•å®šä¹‰çš„å‘¢ï¼Œè®©æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ï¼š</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> IMyService = createDecorator&lt;IMyService&gt;(<span class="hljs-string">&#x27;myService&#x27;</span>);<br><span class="hljs-keyword">interface</span> IMyService &#123;<br><span class="hljs-attr">_serviceBrand</span>: <span class="hljs-literal">undefined</span>;<br>myMethod(): <span class="hljs-built_in">any</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™ä¸ªæœåŠ¡æ¥å£éœ€è¦å…·ä½“çš„å®ç°ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyService</span> <span class="hljs-title">implements</span> <span class="hljs-title">IMyService</span> </span>&#123;<br><span class="hljs-attr">_serviceBrand</span>: <span class="hljs-literal">undefined</span>;<br><span class="hljs-function"><span class="hljs-title">myMethod</span>(<span class="hljs-params"></span>)</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°ï¼Œåœ¨å£°æ˜è¿™ä¸ªæ¥å£ä¹‹å‰ï¼Œæœ‰ä¸ª createDecorator å‡½æ•°å®šä¹‰äº†ä¸€ä¸ªæœåŠ¡çš„è£…é¥°å™¨ï¼Œç”¨äºåœ¨æ„é€ å‡½æ•°ä¸­å£°æ˜ä¾èµ–å…³ç³»ä»¥æ–¹ä¾¿æ³¨å…¥ä¾èµ–ã€‚createDecorator çš„ä¸»è¦ä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªè£…é¥°å™¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ˜¯æ€ä¹ˆå®ç°çš„ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createDecorator</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">serviceId: <span class="hljs-built_in">string</span></span>): <span class="hljs-title">ServiceIdentifier</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br><span class="hljs-comment">// å·²ç»ä¿å­˜è¿‡çš„æœåŠ¡ç›´æ¥è¿”å›å…¶è£…é¥°å™¨</span><br><span class="hljs-keyword">if</span> (_util.serviceIds.has(serviceId)) &#123;<br><span class="hljs-keyword">return</span> _util.serviceIds.get(serviceId)!;<br>&#125;<br><br><span class="hljs-comment">// å£°æ˜è£…é¥°å™¨ï¼Œåªèƒ½è¢«ç”¨äºå‚æ•°è£…é¥°å™¨</span><br><span class="hljs-keyword">const</span> id = &lt;<span class="hljs-built_in">any</span>&gt;<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target: <span class="hljs-built_in">Function</span>, key: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>): <span class="hljs-title">any</span> </span>&#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length !== <span class="hljs-number">3</span>) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;@IServiceName-decorator can only be used to decorate a parameter&#x27;</span>);<br>&#125;<br><span class="hljs-comment">// å°†æœåŠ¡ä½œä¸ºä¾èµ–ä¿å­˜åœ¨ç›®æ ‡ç±»çš„å±æ€§ä¸­</span><br>storeServiceDependency(id, target, index, <span class="hljs-literal">false</span>);<br>&#125;;<br><br>id.toString = <span class="hljs-function">() =&gt;</span> serviceId;<br><br><span class="hljs-comment">// åœ¨ serviceIds ä¿å­˜ä¾èµ–</span><br>_util.serviceIds.set(serviceId, id);<br><span class="hljs-keyword">return</span> id;<br>&#125;<br>storeServiceDependency å‡½æ•°ï¼š<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">storeServiceDependency</span>(<span class="hljs-params">id: <span class="hljs-built_in">Function</span>, target: <span class="hljs-built_in">Function</span>, index: <span class="hljs-built_in">number</span>, optional: <span class="hljs-built_in">boolean</span></span>): <span class="hljs-title">void</span> </span>&#123;<br><span class="hljs-keyword">if</span> ((target <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[_util.DI_TARGET] === target) &#123;<br>(target <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[_util.DI_DEPENDENCIES].push(&#123; id, index, optional &#125;);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>(target <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[_util.DI_DEPENDENCIES] = [&#123; id, index, optional &#125;];<br>(target <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[_util.DI_TARGET] = target;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>storeServiceDependency å‡½æ•°å°†ä¼ å…¥çš„æœåŠ¡ ID (å”¯ä¸€çš„å­—ç¬¦ä¸² myService )åŠç´¢å¼•ä¿å­˜åœ¨æ‰€è£…é¥°ç±»çš„ä¸€ä¸ªæˆå‘˜ $di$dependencies æ•°ç»„ä¸­ï¼Œ å¯¹äºä¾‹å­ä¸­çš„ MyClassï¼Œå…¶æ„é€ å‡½æ•°ä¸­çš„ä¸€ä¸ªå‚æ•°è£…é¥°å™¨ä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™è¢«æ‰§è¡Œï¼ŒæŠŠä¾èµ–è®°å…¥åˆ° $di$dependencies æ•°ç»„ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts">MyClass[<span class="hljs-string">&#x27;$di$dependencies&#x27;</span>] = [<br>&#123; <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;myService&#x27;</span>, <span class="hljs-attr">index</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">optional</span>: <span class="hljs-literal">false</span> &#125;<br>];<br></code></pre></td></tr></table></figure><h2 id="æœåŠ¡é›†å®¹å™¨"><a href="#æœåŠ¡é›†å®¹å™¨" class="headerlink" title="æœåŠ¡é›†å®¹å™¨"></a>æœåŠ¡é›†å®¹å™¨</h2><p>ä¸ŠèŠ‚è®²åˆ°åˆ›å»ºäº†ä¸€ä¸ªæœåŠ¡ï¼Œé‚£ä¹ˆæœ‰å¤šä¸ªæœåŠ¡æ—¶ï¼Œå°±éœ€è¦ä¸€ä¸ªæœåŠ¡é›†ï¼Œç”¨äºä¿å­˜ä¸€ç»„æœåŠ¡ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServiceCollection</span> </span>&#123;<br><span class="hljs-comment">// æœåŠ¡é›†çš„ map</span><br><span class="hljs-keyword">private</span> _entries = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>&lt;ServiceIdentifier&lt;<span class="hljs-built_in">any</span>&gt;, <span class="hljs-built_in">any</span>&gt;();<br><br><span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">...entries: [ServiceIdentifier&lt;<span class="hljs-built_in">any</span>&gt;, <span class="hljs-built_in">any</span>][]</span>)</span> &#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> [id, service] <span class="hljs-keyword">of</span> entries) &#123;<br><span class="hljs-built_in">this</span>.set(id, service);<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// æ·»åŠ æœåŠ¡</span><br>set&lt;T&gt;(id: ServiceIdentifier&lt;T&gt;, instanceOrDescriptor: T | SyncDescriptor&lt;T&gt;): T | SyncDescriptor&lt;T&gt; &#123;<br><span class="hljs-keyword">const</span> result = <span class="hljs-built_in">this</span>._entries.get(id);<br><span class="hljs-built_in">this</span>._entries.set(id, instanceOrDescriptor);<br><span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// æ˜¯å¦å«æœ‰è¯¥æœåŠ¡</span><br>has(id: ServiceIdentifier&lt;<span class="hljs-built_in">any</span>&gt;): <span class="hljs-built_in">boolean</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._entries.has(id);<br>&#125;<br><br><span class="hljs-comment">// è·å–æœåŠ¡</span><br>get&lt;T&gt;(id: ServiceIdentifier&lt;T&gt;): T | SyncDescriptor&lt;T&gt; &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._entries.get(id);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªæœåŠ¡é›†å®¹å™¨ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> services = <span class="hljs-keyword">new</span> ServiceCollection();<br><span class="hljs-comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæœåŠ¡çš„æ„é€ å™¨ï¼Œå³ idï¼Œå¦‚ä½¿ç”¨è£…é¥°å™¨ä¸­è¯´åˆ°çš„ myService</span><br><span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°ä¸ºæœåŠ¡çš„å®ä¾‹å¯¹è±¡</span><br>services.set(ILoggerService, <span class="hljs-keyword">new</span> LoggerService(logService, fileService));<br>services.set(ILifecycleMainService, <span class="hljs-keyword">new</span> SyncDescriptor(LifecycleMainService));<br></code></pre></td></tr></table></figure><p>åœ¨ vscode ä¸­ï¼Œæœ‰äº›æœåŠ¡æ˜¯ä¸ä¾èµ–å…¶ä»–æœåŠ¡ï¼Œä»…è¢«å…¶ä»–æœåŠ¡æ‰€ä¾èµ–ï¼Œå¦‚æ—¥å¿—æœåŠ¡ï¼ˆILoggerServiceï¼‰ï¼Œæ­¤ç±»æœåŠ¡åˆ›å»ºçš„æ—¶å€™å¯ç›´æ¥ new æœåŠ¡çš„å¯¹è±¡ã€‚æœ‰äº›æœåŠ¡è¿˜ä¼šä¾èµ–åˆ«çš„æœåŠ¡ï¼Œéœ€è¦ SyncDescriptor å°è£…ä¹‹åä¿å­˜åœ¨æœåŠ¡é›†ä¸­ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SyncDescriptor</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br><br><span class="hljs-keyword">readonly</span> ctor: <span class="hljs-built_in">any</span>;<br><span class="hljs-keyword">readonly</span> staticArguments: <span class="hljs-built_in">any</span>[];<br><span class="hljs-keyword">readonly</span> supportsDelayedInstantiation: <span class="hljs-built_in">boolean</span>;<br><br><span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">ctor: <span class="hljs-keyword">new</span> (...args: <span class="hljs-built_in">any</span>[]) =&gt; T, staticArguments: <span class="hljs-built_in">any</span>[] = [], supportsDelayedInstantiation: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span></span>)</span> &#123;<br><span class="hljs-built_in">this</span>.ctor = ctor;<span class="hljs-comment">//æœåŠ¡çš„æ„é€ å™¨</span><br><span class="hljs-built_in">this</span>.staticArguments = staticArguments;<span class="hljs-comment">// é™æ€å‚æ•°</span><br><span class="hljs-built_in">this</span>.supportsDelayedInstantiation = supportsDelayedInstantiation;<span class="hljs-comment">// æ˜¯å¦æ”¯æŒå»¶è¿Ÿå®ä¾‹åŒ–</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>SyncDescriptor æ˜¯ä¸€ä¸ªç”¨äºåŒ…è£…éœ€è¦è¢«å®¹å™¨å®ä¾‹åŒ–å®¹å™¨çš„æè¿°ç¬¦å¯¹è±¡ï¼Œå®ƒä¿å­˜äº†å¯¹è±¡çš„æ„é€ å™¨å’Œé™æ€å‚æ•°</p><h2 id="å®ä¾‹åŒ–å®¹å™¨"><a href="#å®ä¾‹åŒ–å®¹å™¨" class="headerlink" title="å®ä¾‹åŒ–å®¹å™¨"></a>å®ä¾‹åŒ–å®¹å™¨</h2><p>ä¸Šæ–‡è®²åˆ°ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæœåŠ¡é›†å®¹å™¨ï¼Œå¹¶æŠŠæœåŠ¡æ³¨å…¥åˆ°äº†å®¹å™¨ä¹‹ä¸­ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€ä¸ªç±»æ¥æ“ä½œè¿™ä¸ªå®¹å™¨ï¼Œ InstantiationService è¿™ä¸ªç±»å°±æ˜¯èµ·åˆ°è¿™ä¸ªä½œç”¨ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> IInstantiationService = createDecorator&lt;IInstantiationService&gt;(<span class="hljs-string">&#x27;instantiationService&#x27;</span>);<br>ä»æºç ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°ï¼ŒIInstantiationService ä¹Ÿæ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œä»–æœ€æ—©åœ¨ main.ts ä¸­çš„ startup å‡½æ•°ä¸­è¢«åˆå§‹åŒ–ã€‚<br><br><span class="hljs-keyword">const</span> instantiationService = <span class="hljs-keyword">new</span> InstantiationService(services, <span class="hljs-literal">true</span>);<br></code></pre></td></tr></table></figure><p>åœ¨åˆ›å»ºäº† instantiationService å®ä¾‹ä¹‹åï¼Œå¯è°ƒç”¨ invokeFunction æ–¹æ³•æ¥æ‰‹åŠ¨åœ°è·å–æœåŠ¡å®ä¾‹ï¼Œå®¹å™¨ä¼šè‡ªåŠ¨å»åˆ†æå®ƒæ‰€ä¾èµ–çš„æœåŠ¡å¹¶è‡ªåŠ¨å®ä¾‹åŒ–åè¿”å›ã€‚åœ¨å¯»æ‰¾å®¹å™¨ä¸­çš„æœåŠ¡æ—¶ï¼Œå½“åœ¨å½“å‰å®¹å™¨ä¸­æ‰¾ä¸åˆ°è¿™ä¸ªæœåŠ¡æ—¶ï¼Œä¼šå»æŸ¥æ‰¾çˆ¶å®¹å™¨ä¸­æ˜¯å¦æœ‰è¿™ä¸ªæœåŠ¡ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs ts">_getServiceInstanceOrDescriptor&lt;T&gt;(id: ServiceIdentifier&lt;T&gt;): T | SyncDescriptor&lt;T&gt; &#123;<br><span class="hljs-comment">// åœ¨å®¹å™¨ä¸­æ ¹æ® id è·å–æœåŠ¡å®ä¾‹æˆ–æè¿°ç¬¦</span><br><span class="hljs-keyword">let</span> instanceOrDesc = <span class="hljs-built_in">this</span>._services.get(id);<br><span class="hljs-keyword">if</span> (!instanceOrDesc &amp;&amp; <span class="hljs-built_in">this</span>._parent) &#123;<br><span class="hljs-comment">// æŸ¥æ‰¾çˆ¶å®¹å™¨çš„æœåŠ¡</span><br><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._parent._getServiceInstanceOrDescriptor(id);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">return</span> instanceOrDesc;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœæ‰¾åˆ°çš„æœåŠ¡æ˜¯ä¸ª SyncDescriptorï¼Œå³è¿™ä¸ªæœåŠ¡è¿˜ä¾èµ–å…¶ä»–æœåŠ¡ï¼Œåˆ™ä¼šé€šè¿‡å›¾çš„å…³ç³»æ¥å¤„ç†æœåŠ¡é—´çš„ä¾èµ–å…³ç³»ï¼Œè¿™é‡Œæ˜¯æ•´ä¸ªä¾èµ–æ³¨å…¥çš„æ ¸å¿ƒï¼Œæ”¾åˆ°ä¸‹é¢è¯¦ç»†è¯´æ˜ã€‚</p><h2 id="ä¾èµ–åˆ†æ"><a href="#ä¾èµ–åˆ†æ" class="headerlink" title="ä¾èµ–åˆ†æ"></a>ä¾èµ–åˆ†æ</h2><p>åœ¨ä¸Šæ–‡ä¸­è®²åˆ°ï¼Œåœ¨ä¸ä¾èµ–å…¶ä»–æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¾ˆç®€å•çš„ã€‚å½“æœåŠ¡ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œéšç€éœ€æ±‚çš„å¢åŠ å°±ä¼šå˜å¾—ååˆ†å¤æ‚ã€‚è€Œä¾èµ–æ³¨å…¥çš„æ ¸å¿ƒå°±æ˜¯è¿™äº›å…³ç³»çš„å¤„ç†ï¼Œä»¥åŠæŸ¥çœ‹å­˜åœ¨çš„ä¾èµ–å¾ªç¯ï¼Œé‚£ä¹ˆ vscode æ˜¯å¦‚ä½•å¤„ç†è¿™äº›ä¾èµ–å…³ç³»çš„å‘¢ï¼Œè®©æˆ‘ä»¬çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼Œå¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬æ…¢æ…¢åˆ†æã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs ts">_createAndCacheServiceInstance&lt;T&gt;(id: ServiceIdentifier&lt;T&gt;, desc: SyncDescriptor&lt;T&gt;, _trace: Trace): T &#123;<br><br><span class="hljs-keyword">type</span> Triple = &#123; <span class="hljs-attr">id</span>: ServiceIdentifier&lt;<span class="hljs-built_in">any</span>&gt;, desc: SyncDescriptor&lt;<span class="hljs-built_in">any</span>&gt;, _trace: Trace; &#125;;<br><span class="hljs-keyword">const</span> graph = <span class="hljs-keyword">new</span> Graph&lt;Triple&gt;(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> data.id.toString());<br><br><span class="hljs-keyword">let</span> cycleCount = <span class="hljs-number">0</span>;<br>  <span class="hljs-comment">// å°†å½“å‰ä¾èµ–æ¨å…¥æ ˆ</span><br><span class="hljs-keyword">const</span> stack = [&#123; id, desc, _trace &#125;];<br>  <span class="hljs-comment">// æ ¹æ®ä¾èµ–å…³ç³»æ„é€ æœ‰å‘å›¾</span><br><span class="hljs-keyword">while</span> (stack.length) &#123;<br><span class="hljs-keyword">const</span> item = stack.pop()!;<br>    <span class="hljs-comment">// æŸ¥æ‰¾æˆ–è€…æ’å…¥èŠ‚ç‚¹ graph: myService, (incoming)[], (outgoing)[]</span><br>graph.lookupOrInsertNode(item);<br><br><span class="hljs-comment">// a weak but working heuristic for cycle checks</span><br><span class="hljs-keyword">if</span> (cycleCount++ &gt; <span class="hljs-number">1000</span>) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> CyclicDependencyError(graph);<br>&#125;<br><br><span class="hljs-comment">// æ£€æŸ¥æ‰€æœ‰ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦éœ€è¦é¦–å…ˆåˆ›å»ºå®ƒä»¬ï¼Œ dependency æ˜¯æˆ‘ä»¬æœåŠ¡æ‰€ä¾èµ–çš„å…¶ä»–æœåŠ¡</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> dependency <span class="hljs-keyword">of</span> _util.getServiceDependencies(item.desc.ctor)) &#123;<br><br><span class="hljs-keyword">let</span> instanceOrDesc = <span class="hljs-built_in">this</span>._getServiceInstanceOrDescriptor(dependency.id);<br><span class="hljs-keyword">if</span> (!instanceOrDesc &amp;&amp; !dependency.optional) &#123;<br><span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`[createInstance] <span class="hljs-subst">$&#123;id&#125;</span> depends on <span class="hljs-subst">$&#123;dependency.id&#125;</span> which is NOT registered.`</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (instanceOrDesc <span class="hljs-keyword">instanceof</span> SyncDescriptor) &#123;<br><span class="hljs-keyword">const</span> d = &#123; <span class="hljs-attr">id</span>: dependency.id, <span class="hljs-attr">desc</span>: instanceOrDesc, <span class="hljs-attr">_trace</span>: item._trace.branch(dependency.id, <span class="hljs-literal">true</span>) &#125;;<br>graph.insertEdge(item, d);<br>stack.push(d);<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br><span class="hljs-keyword">const</span> roots = graph.roots();<br><br><span class="hljs-comment">// æ‰€æœ‰ outgoing ä¸ºç©ºä½†æ˜¯è¿˜æœ‰èŠ‚ç‚¹æ—¶ï¼Œè®¤ä¸ºæ˜¯æœ‰ä¾èµ–å¾ªç¯ï¼ŒæŠ¥é”™</span><br><span class="hljs-keyword">if</span> (roots.length === <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">if</span> (!graph.isEmpty()) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> CyclicDependencyError(graph);<br>&#125;<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> &#123; data &#125; <span class="hljs-keyword">of</span> roots) &#123;<br><span class="hljs-comment">// Repeat the check for this still being a service sync descriptor. That&#x27;s because</span><br><span class="hljs-comment">// instantiating a dependency might have side-effect and recursively trigger instantiation</span><br><span class="hljs-comment">// so that some dependencies are now fullfilled already.</span><br><span class="hljs-keyword">const</span> instanceOrDesc = <span class="hljs-built_in">this</span>._getServiceInstanceOrDescriptor(data.id);<br><span class="hljs-keyword">if</span> (instanceOrDesc <span class="hljs-keyword">instanceof</span> SyncDescriptor) &#123;<br><span class="hljs-comment">// åˆ›å»ºå®ä¾‹</span><br><span class="hljs-keyword">const</span> instance = <span class="hljs-built_in">this</span>._createServiceInstanceWithOwner(data.id, data.desc.ctor, data.desc.staticArguments, data.desc.supportsDelayedInstantiation, data._trace);<br><span class="hljs-built_in">this</span>._setServiceInstance(data.id, instance);<br>&#125;<br>graph.removeNode(data);<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> &lt;T&gt;<span class="hljs-built_in">this</span>._getServiceInstanceOrDescriptor(id);<br>&#125;<br></code></pre></td></tr></table></figure><p>vscode æ˜¯é€šè¿‡å›¾æ¥ä¿å­˜ä¾èµ–é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬çš„ä¾èµ–å…³ç³»å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªæœ‰å‘å›¾ï¼Œä¸åŒçš„ä¾èµ–å¯ä»¥çœ‹åšæ˜¯å›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€ŒèŠ‚ç‚¹é—´å®ä¾‹åŒ–çš„å…ˆåé¡ºåºå¯ä»¥çœ‹åšå›¾çš„è¾¹ï¼Œåœ¨ vscode ä¸­ï¼Œæ˜¯é‡‡ç”¨é‚»æ¥è¡¨è¿™ç§æ•°æ®ç»“æ„æ¥è¡¨ç¤ºå›¾ï¼Œå³Graph ä¸­ç”¨ä¸€ä¸ª _nodes æ¥ä¿å­˜æ¯ä¸ªé¡¶ç‚¹ï¼Œä¸”æ¯ä¸ªé¡¶ç‚¹çš„æ‰€æœ‰ç›¸é‚»ï¼ˆå‡ºåº¦åŠå…¥åº¦ï¼‰é¡¶ç‚¹ä¿å­˜åœ¨é¡¶ç‚¹å¯¹åº”çš„ä¸€å¼ é“¾è¡¨ä¸­ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts">insertEdge(<span class="hljs-keyword">from</span>: T, <span class="hljs-attr">to</span>: T): <span class="hljs-built_in">void</span> &#123;<br><span class="hljs-keyword">const</span> fromNode = <span class="hljs-built_in">this</span>.lookupOrInsertNode(<span class="hljs-keyword">from</span>);<br><span class="hljs-keyword">const</span> toNode = <span class="hljs-built_in">this</span>.lookupOrInsertNode(to);<br><br>fromNode.outgoing.set(<span class="hljs-built_in">this</span>._hashFn(to), toNode);<br>toNode.incoming.set(<span class="hljs-built_in">this</span>._hashFn(<span class="hljs-keyword">from</span>), fromNode);<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ‰å‘å›¾æ„é€ å®Œä¹‹åï¼Œä»å›¾ä¸­æ‹¿å‡ºæ‰€æœ‰å‡ºåº¦æ„æˆçš„ä¾èµ–æ•°ç»„ï¼Œå› ä¸ºä¾èµ–å…³ç³»æ˜¯é€å±‚å¾€ä¸Šçš„ï¼Œå³å°† A æœåŠ¡æ‰€ä¾èµ–çš„å…¶ä»–æœåŠ¡ä¾æ¬¡å®ä¾‹åŒ–ï¼Œæœ€åå†å®ä¾‹åŒ– A ï¼Œä¸€ç›´åˆ°å…¨éƒ¨å®ä¾‹åŒ–å®Œæˆä¸ºæ­¢ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>  <span class="hljs-comment">// å‡ºåº¦ï¼Œå³æœ¬æœåŠ¡ä¾èµ–çš„æœåŠ¡æ•°ç»„</span><br><span class="hljs-keyword">const</span> roots = graph.roots();<br><br><span class="hljs-comment">// æ ¹èŠ‚ç‚¹ä¸ºç©ºä½†æ˜¯å›¾ä¸­ä¸ä¸ºç©ºæ—¶ï¼ŒæŠ¥é”™</span><br><span class="hljs-keyword">if</span> (roots.length === <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-comment">// å¦‚æœæ‰€æœ‰ä¾èµ–éƒ½å·²ç»å®ä¾‹åŒ–å®Œæˆè€Œå›¾ä¸­è¿˜æœ‰èŠ‚ç‚¹åˆ™è®¤ä¸ºåŒ…å«å¾ªç¯ä¾èµ–</span><br><span class="hljs-keyword">if</span> (!graph.isEmpty()) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> CyclicDependencyError(graph);<br>&#125;<br><span class="hljs-keyword">break</span>;<br>&#125;<br>    <span class="hljs-comment">// éå†æ•°ç»„å¹¶ä»¥æ­¤å®ä¾‹åŒ–</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> &#123; data &#125; <span class="hljs-keyword">of</span> roots) &#123;<br><span class="hljs-comment">// Repeat the check for this still being a service sync descriptor. That&#x27;s because</span><br><span class="hljs-comment">// instantiating a dependency might have side-effect and recursively trigger instantiation</span><br><span class="hljs-comment">// so that some dependencies are now fullfilled already.</span><br><span class="hljs-keyword">const</span> instanceOrDesc = <span class="hljs-built_in">this</span>._getServiceInstanceOrDescriptor(data.id);<br><span class="hljs-keyword">if</span> (instanceOrDesc <span class="hljs-keyword">instanceof</span> SyncDescriptor) &#123;<br><span class="hljs-comment">// åˆ›å»ºå®ä¾‹</span><br><span class="hljs-keyword">const</span> instance = <span class="hljs-built_in">this</span>._createServiceInstanceWithOwner(data.id, data.desc.ctor, data.desc.staticArguments, data.desc.supportsDelayedInstantiation, data._trace);<br><span class="hljs-built_in">this</span>._setServiceInstance(data.id, instance);<br>&#125;<br>graph.removeNode(data);<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> &lt;T&gt;<span class="hljs-built_in">this</span>._getServiceInstanceOrDescriptor(id);<br></code></pre></td></tr></table></figure><p>å½“æ‰€æœ‰å®ä¾‹åŒ–å…¨éƒ¨å®Œæˆï¼Œè°ƒç”¨æ ˆå›åˆ° _createInstance æ–¹æ³•ï¼ŒserviceArags æ‹¿åˆ°äº†æ‰€æœ‰çš„ä¾èµ–åè°ƒç”¨ create æ–¹æ³•ä¼ å…¥æ„é€ å™¨ä»¥åŠå…¶å‚æ•°åˆ›å»ºå®ä¾‹ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">private</span> _createInstance&lt;T&gt;(ctor: <span class="hljs-built_in">any</span>, <span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[] = [], <span class="hljs-attr">_trace</span>: Trace): T &#123;<br><br><span class="hljs-comment">// ç”±æœåŠ¡è£…é¥°å™¨å®šä¹‰çš„å‚æ•°ï¼Œæ ¹æ® index æ’åº</span><br><span class="hljs-keyword">let</span> serviceDependencies = _util.getServiceDependencies(ctor).sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.index - b.index);<br><span class="hljs-keyword">let</span> serviceArgs: <span class="hljs-built_in">any</span>[] = [];<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> dependency <span class="hljs-keyword">of</span> serviceDependencies) &#123;<br><span class="hljs-comment">// è·å–æˆ–è€…åˆ›å»ºå®ä¾‹</span><br><span class="hljs-keyword">let</span> service = <span class="hljs-built_in">this</span>._getOrCreateServiceInstance(dependency.id, _trace);<br><span class="hljs-keyword">if</span> (!service &amp;&amp; <span class="hljs-built_in">this</span>._strict &amp;&amp; !dependency.optional) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`[createInstance] <span class="hljs-subst">$&#123;ctor.name&#125;</span> depends on UNKNOWN service <span class="hljs-subst">$&#123;dependency.id&#125;</span>.`</span>);<br>&#125;<br>serviceArgs.push(service);<br>&#125;<br><br><span class="hljs-keyword">let</span> firstServiceArgPos = serviceDependencies.length &gt; <span class="hljs-number">0</span> ? serviceDependencies[<span class="hljs-number">0</span>].index : args.length;<br><br><span class="hljs-comment">// check for argument mismatches, adjust static args if needed</span><br><span class="hljs-keyword">if</span> (args.length !== firstServiceArgPos) &#123;<br><span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`[createInstance] First service dependency of <span class="hljs-subst">$&#123;ctor.name&#125;</span> at position <span class="hljs-subst">$&#123;firstServiceArgPos + <span class="hljs-number">1</span>&#125;</span> conflicts with <span class="hljs-subst">$&#123;args.length&#125;</span> static arguments`</span>);<br><br><span class="hljs-keyword">let</span> delta = firstServiceArgPos - args.length;<br><span class="hljs-keyword">if</span> (delta &gt; <span class="hljs-number">0</span>) &#123;<br>args = args.concat(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(delta));<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>args = args.slice(<span class="hljs-number">0</span>, firstServiceArgPos);<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// åˆ›å»ºæœåŠ¡å®ä¾‹</span><br><span class="hljs-keyword">return</span> &lt;T&gt;<span class="hljs-keyword">new</span> ctor(...[...args, ...serviceArgs]);<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä» vscode æºç çš„è§’åº¦åˆ†æäº†å…¶ä¾èµ–æ³¨å…¥çš„åŸç†ï¼Œç®€è€Œè¨€ä¹‹ï¼Œä¾èµ–åˆ†æçš„è¿‡ç¨‹æ˜¯é€’å½’å‘ä¸‹è·å–æ‰€æœ‰çš„ä¾èµ–é¡¹ï¼Œå†é€’å½’å‘ä¸Šä¼˜å…ˆå®ä¾‹åŒ–æœ€åº•å±‚çš„ä¾èµ–ï¼Œåœ¨å®ä¾‹åŒ–ä¾èµ–çš„æ—¶å€™ï¼Œä¼šé€çº§å»æŸ¥æ‰¾ä¾èµ–å¹¶å®ä¾‹åŒ–ã€‚ç”¨æœåŠ¡é›†å®¹å™¨æ¥ç®¡ç†ä¾èµ–ï¼Œå¯ä»¥è®©æ¯ä¸ªæœåŠ¡é›†å®¹å™¨å…·æœ‰ä¸åŒçš„èƒ½åŠ›ï¼Œä¾‹å¦‚åœ¨ vscode ä¸­ï¼Œä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹å¹¶ä¸å…±äº«ä¸€å¥—æœåŠ¡ï¼Œå› ä¸ºä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹çš„èƒ½åŠ›å’ŒèŒè´£ä¸åŒï¼Œåˆ†å¼€ç®¡ç†æ¯”è¾ƒåˆç†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>vscode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é“¾è¡¨ä»‹ç»</title>
    <link href="/2021/07/05/link-introduction/"/>
    <url>/2021/07/05/link-introduction/</url>
    
    <content type="html"><![CDATA[<h2 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h2><h3 id="é“¾è¡¨ç»“æ„"><a href="#é“¾è¡¨ç»“æ„" class="headerlink" title="é“¾è¡¨ç»“æ„"></a>é“¾è¡¨ç»“æ„</h3><p>åº•å±‚çš„å­˜å‚¨ç»“æ„ï¼š</p><p>ä»å›¾ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œæ•°ç»„éœ€è¦ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´æ¥å­˜å‚¨ï¼Œå¯¹å†…å­˜çš„è¦æ±‚æ¯”è¾ƒé«˜ã€‚å¦‚æœæˆ‘ä»¬ç”³è¯·ä¸€ä¸ª 100MB å¤§å°çš„æ•°ç»„ï¼Œå½“å†…å­˜ä¸­æ²¡æœ‰è¿ç»­çš„ã€è¶³å¤Ÿå¤§çš„å­˜å‚¨ç©ºé—´æ—¶ï¼Œå³ä¾¿å†…å­˜çš„å‰©ä½™æ€»å¯ç”¨ç©ºé—´å¤§äº 100MBï¼Œä»ç„¶ä¼šç”³è¯·å¤±è´¥ã€‚</p><p>è€Œé“¾è¡¨æ°æ°ç›¸åï¼Œå®ƒå¹¶ä¸éœ€è¦ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå®ƒé€šè¿‡â€œæŒ‡é’ˆâ€å°†ä¸€ç»„é›¶æ•£çš„å†…å­˜å—ä¸²è”èµ·æ¥ä½¿ç”¨ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ç”³è¯·çš„æ˜¯ 100MB å¤§å°çš„é“¾è¡¨ï¼Œæ ¹æœ¬ä¸ä¼šæœ‰é—®é¢˜ã€‚</p><img src="https://static001.geekbang.org/resource/image/d5/cd/d5d5bee4be28326ba3c28373808a62cd.jpg"><h3 id="å•é“¾è¡¨"><a href="#å•é“¾è¡¨" class="headerlink" title="å•é“¾è¡¨"></a>å•é“¾è¡¨</h3><p>é“¾è¡¨é€šè¿‡æŒ‡é’ˆå°†ä¸€ç»„é›¶æ•£çš„å†…å­˜å—ä¸²è”åœ¨ä¸€èµ·ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬æŠŠå†…å­˜å—ç§°ä¸ºé“¾è¡¨çš„â€œç»“ç‚¹â€ã€‚ä¸ºäº†å°†æ‰€æœ‰çš„ç»“ç‚¹ä¸²èµ·æ¥ï¼Œæ¯ä¸ªé“¾è¡¨çš„ç»“ç‚¹é™¤äº†å­˜å‚¨æ•°æ®ä¹‹å¤–ï¼Œè¿˜éœ€è¦è®°å½•é“¾ä¸Šçš„ä¸‹ä¸€ä¸ªç»“ç‚¹çš„åœ°å€ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªè®°å½•ä¸‹ä¸ªç»“ç‚¹åœ°å€çš„æŒ‡é’ˆå«ä½œåç»§æŒ‡é’ˆ nextã€‚</p><img src="https://static001.geekbang.org/resource/image/b9/eb/b93e7ade9bb927baad1348d9a806ddeb.jpg"><p>ä»å•é“¾è¡¨å›¾ä¸­ï¼Œä½ åº”è¯¥å¯ä»¥å‘ç°ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªç»“ç‚¹æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ç¬¬ä¸€ä¸ªç»“ç‚¹å’Œæœ€åä¸€ä¸ªç»“ç‚¹ã€‚æˆ‘ä»¬ä¹ æƒ¯æ€§åœ°æŠŠç¬¬ä¸€ä¸ªç»“ç‚¹å«ä½œå¤´ç»“ç‚¹ï¼ŒæŠŠæœ€åä¸€ä¸ªç»“ç‚¹å«ä½œå°¾ç»“ç‚¹ã€‚å…¶ä¸­ï¼Œå¤´ç»“ç‚¹ç”¨æ¥è®°å½•é“¾è¡¨çš„åŸºåœ°å€ã€‚æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥éå†å¾—åˆ°æ•´æ¡é“¾è¡¨ã€‚è€Œå°¾ç»“ç‚¹ç‰¹æ®Šçš„åœ°æ–¹æ˜¯ï¼šæŒ‡é’ˆä¸æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œæ˜¯æŒ‡å‘ä¸€ä¸ªç©ºåœ°å€ NULLï¼Œè¡¨ç¤ºè¿™æ˜¯é“¾è¡¨ä¸Šæœ€åä¸€ä¸ªç»“ç‚¹ã€‚</p><p>ä¸æ•°ç»„ä¸€æ ·ï¼Œé“¾è¡¨ä¹Ÿæ”¯æŒæ•°æ®çš„æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨è¿›è¡Œæ•°ç»„çš„æ’å…¥ã€åˆ é™¤æ“ä½œæ—¶ï¼Œä¸ºäº†ä¿æŒå†…å­˜æ•°æ®çš„è¿ç»­æ€§ï¼Œéœ€è¦åšå¤§é‡çš„æ•°æ®æ¬ç§»ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚è€Œåœ¨é“¾è¡¨ä¸­æ’å…¥æˆ–è€…åˆ é™¤ä¸€ä¸ªæ•°æ®ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ä¸ºäº†ä¿æŒå†…å­˜çš„è¿ç»­æ€§è€Œæ¬ç§»ç»“ç‚¹ï¼Œå› ä¸ºé“¾è¡¨çš„å­˜å‚¨ç©ºé—´æœ¬èº«å°±ä¸æ˜¯è¿ç»­çš„ã€‚æ‰€ä»¥ï¼Œåœ¨é“¾è¡¨ä¸­æ’å…¥å’Œåˆ é™¤ä¸€ä¸ªæ•°æ®æ˜¯éå¸¸å¿«é€Ÿçš„ã€‚</p><img src="https://static001.geekbang.org/resource/image/45/17/452e943788bdeea462d364389bd08a17.jpg"><p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œé’ˆå¯¹é“¾è¡¨çš„æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘ç›¸é‚»ç»“ç‚¹çš„æŒ‡é’ˆæ”¹å˜ï¼Œæ‰€ä»¥å¯¹åº”çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ã€‚</p><p>ä½†æ˜¯ï¼Œæœ‰åˆ©å°±æœ‰å¼Šã€‚é“¾è¡¨è¦æƒ³éšæœºè®¿é—®ç¬¬ k ä¸ªå…ƒç´ ï¼Œå°±æ²¡æœ‰æ•°ç»„é‚£ä¹ˆé«˜æ•ˆäº†ã€‚å› ä¸ºé“¾è¡¨ä¸­çš„æ•°æ®å¹¶éè¿ç»­å­˜å‚¨çš„ï¼Œæ‰€ä»¥æ— æ³•åƒæ•°ç»„é‚£æ ·ï¼Œæ ¹æ®é¦–åœ°å€å’Œä¸‹æ ‡ï¼Œé€šè¿‡å¯»å€å…¬å¼å°±èƒ½ç›´æ¥è®¡ç®—å‡ºå¯¹åº”çš„å†…å­˜åœ°å€ï¼Œè€Œæ˜¯éœ€è¦æ ¹æ®æŒ‡é’ˆä¸€ä¸ªç»“ç‚¹ä¸€ä¸ªç»“ç‚¹åœ°ä¾æ¬¡éå†ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸åº”çš„ç»“ç‚¹ã€‚</p><h3 id="å¾ªç¯é“¾è¡¨"><a href="#å¾ªç¯é“¾è¡¨" class="headerlink" title="å¾ªç¯é“¾è¡¨"></a>å¾ªç¯é“¾è¡¨</h3><p>å¾ªç¯é“¾è¡¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„å•é“¾è¡¨ã€‚å®é™…ä¸Šï¼Œå¾ªç¯é“¾è¡¨ä¹Ÿå¾ˆç®€å•ã€‚å®ƒè·Ÿå•é“¾è¡¨å”¯ä¸€çš„åŒºåˆ«å°±åœ¨å°¾ç»“ç‚¹ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå•é“¾è¡¨çš„å°¾ç»“ç‚¹æŒ‡é’ˆæŒ‡å‘ç©ºåœ°å€ï¼Œè¡¨ç¤ºè¿™å°±æ˜¯æœ€åçš„ç»“ç‚¹äº†ã€‚è€Œå¾ªç¯é“¾è¡¨çš„å°¾ç»“ç‚¹æŒ‡é’ˆæ˜¯æŒ‡å‘é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚ä»æˆ‘ç”»çš„å¾ªç¯é“¾è¡¨å›¾ä¸­ï¼Œä½ åº”è¯¥å¯ä»¥çœ‹å‡ºæ¥ï¼Œå®ƒåƒä¸€ä¸ªç¯ä¸€æ ·é¦–å°¾ç›¸è¿ï¼Œæ‰€ä»¥å«ä½œâ€œå¾ªç¯â€é“¾è¡¨ã€‚</p><img src="https://static001.geekbang.org/resource/image/86/55/86cb7dc331ea958b0a108b911f38d155.jpg"><p>å’Œå•é“¾è¡¨ç›¸æ¯”ï¼Œå¾ªç¯é“¾è¡¨çš„ä¼˜ç‚¹æ˜¯ä»é“¾å°¾åˆ°é“¾å¤´æ¯”è¾ƒæ–¹ä¾¿ã€‚å½“è¦å¤„ç†çš„æ•°æ®å…·æœ‰ç¯å‹ç»“æ„ç‰¹ç‚¹æ—¶ï¼Œå°±ç‰¹åˆ«é€‚åˆé‡‡ç”¨å¾ªç¯é“¾è¡¨ã€‚æ¯”å¦‚è‘—åçš„çº¦ç‘Ÿå¤«é—®é¢˜ã€‚å°½ç®¡ç”¨å•é“¾è¡¨ä¹Ÿå¯ä»¥å®ç°ï¼Œä½†æ˜¯ç”¨å¾ªç¯é“¾è¡¨å®ç°çš„è¯ï¼Œä»£ç å°±ä¼šç®€æ´å¾ˆå¤šã€‚</p><h3 id="åŒå‘é“¾è¡¨"><a href="#åŒå‘é“¾è¡¨" class="headerlink" title="åŒå‘é“¾è¡¨"></a>åŒå‘é“¾è¡¨</h3><p>å•å‘é“¾è¡¨åªæœ‰ä¸€ä¸ªæ–¹å‘ï¼Œç»“ç‚¹åªæœ‰ä¸€ä¸ªåç»§æŒ‡é’ˆ next æŒ‡å‘åé¢çš„ç»“ç‚¹ã€‚è€ŒåŒå‘é“¾è¡¨ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ”¯æŒä¸¤ä¸ªæ–¹å‘ï¼Œæ¯ä¸ªç»“ç‚¹ä¸æ­¢æœ‰ä¸€ä¸ªåç»§æŒ‡é’ˆ next æŒ‡å‘åé¢çš„ç»“ç‚¹ï¼Œè¿˜æœ‰ä¸€ä¸ªå‰é©±æŒ‡é’ˆ prev æŒ‡å‘å‰é¢çš„ç»“ç‚¹ã€‚</p><img src="https://static001.geekbang.org/resource/image/cb/0b/cbc8ab20276e2f9312030c313a9ef70b.jpg"><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼ŒåŒå‘é“¾è¡¨éœ€è¦é¢å¤–çš„ä¸¤ä¸ªç©ºé—´æ¥å­˜å‚¨åç»§ç»“ç‚¹å’Œå‰é©±ç»“ç‚¹çš„åœ°å€ã€‚æ‰€ä»¥ï¼Œå¦‚æœå­˜å‚¨åŒæ ·å¤šçš„æ•°æ®ï¼ŒåŒå‘é“¾è¡¨è¦æ¯”å•é“¾è¡¨å ç”¨æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚è™½ç„¶ä¸¤ä¸ªæŒ‡é’ˆæ¯”è¾ƒæµªè´¹å­˜å‚¨ç©ºé—´ï¼Œä½†å¯ä»¥æ”¯æŒåŒå‘éå†ï¼Œè¿™æ ·ä¹Ÿå¸¦æ¥äº†åŒå‘é“¾è¡¨æ“ä½œçš„çµæ´»æ€§ã€‚é‚£ç›¸æ¯”å•é“¾è¡¨ï¼ŒåŒå‘é“¾è¡¨é€‚åˆè§£å†³å“ªç§é—®é¢˜å‘¢ï¼Ÿ</p><p>ä»ç»“æ„ä¸Šæ¥çœ‹ï¼ŒåŒå‘é“¾è¡¨å¯ä»¥æ”¯æŒ O(1) æ—¶é—´å¤æ‚åº¦çš„æƒ…å†µä¸‹æ‰¾åˆ°å‰é©±ç»“ç‚¹ï¼Œæ­£æ˜¯è¿™æ ·çš„ç‰¹ç‚¹ï¼Œä¹Ÿä½¿åŒå‘é“¾è¡¨åœ¨æŸäº›æƒ…å†µä¸‹çš„æ’å…¥ã€åˆ é™¤ç­‰æ“ä½œéƒ½è¦æ¯”å•é“¾è¡¨ç®€å•ã€é«˜æ•ˆã€‚</p><ul><li><p>åˆ é™¤æ“ä½œ</p><p>  åœ¨å®é™…çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œä»é“¾è¡¨ä¸­åˆ é™¤ä¸€ä¸ªæ•°æ®æ— å¤–ä¹è¿™ä¸¤ç§æƒ…å†µï¼š</p><ul><li>åˆ é™¤ç»“ç‚¹ä¸­â€œå€¼ç­‰äºæŸä¸ªç»™å®šå€¼â€çš„ç»“ç‚¹ï¼›</li><li>åˆ é™¤ç»™å®šæŒ‡é’ˆæŒ‡å‘çš„ç»“ç‚¹ã€‚</li></ul><p>  å¯¹äºç¬¬ä¸€ç§æƒ…å†µï¼Œä¸ç®¡æ˜¯å•é“¾è¡¨è¿˜æ˜¯åŒå‘é“¾è¡¨ï¼Œä¸ºäº†æŸ¥æ‰¾åˆ°å€¼ç­‰äºç»™å®šå€¼çš„ç»“ç‚¹ï¼Œéƒ½éœ€è¦ä»å¤´ç»“ç‚¹å¼€å§‹ä¸€ä¸ªä¸€ä¸ªä¾æ¬¡éå†å¯¹æ¯”ï¼Œç›´åˆ°æ‰¾åˆ°å€¼ç­‰äºç»™å®šå€¼çš„ç»“ç‚¹ï¼Œç„¶åå†é€šè¿‡æˆ‘å‰é¢è®²çš„æŒ‡é’ˆæ“ä½œå°†å…¶åˆ é™¤ã€‚</p><p>  å°½ç®¡å•çº¯çš„åˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ï¼Œä½†éå†æŸ¥æ‰¾çš„æ—¶é—´æ˜¯ä¸»è¦çš„è€—æ—¶ç‚¹ï¼Œå¯¹åº”çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚æ ¹æ®æ—¶é—´å¤æ‚åº¦åˆ†æä¸­çš„åŠ æ³•æ³•åˆ™ï¼Œåˆ é™¤å€¼ç­‰äºç»™å®šå€¼çš„ç»“ç‚¹å¯¹åº”çš„é“¾è¡¨æ“ä½œçš„æ€»æ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚</p><p>  å¯¹äºç¬¬äºŒç§æƒ…å†µï¼Œæˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†è¦åˆ é™¤çš„ç»“ç‚¹ï¼Œä½†æ˜¯åˆ é™¤æŸä¸ªç»“ç‚¹ q éœ€è¦çŸ¥é“å…¶å‰é©±ç»“ç‚¹ï¼Œè€Œå•é“¾è¡¨å¹¶ä¸æ”¯æŒç›´æ¥è·å–å‰é©±ç»“ç‚¹ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†æ‰¾åˆ°å‰é©±ç»“ç‚¹ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦ä»å¤´ç»“ç‚¹å¼€å§‹éå†é“¾è¡¨ï¼Œç›´åˆ° p-&gt;next=qï¼Œè¯´æ˜ p æ˜¯ q çš„å‰é©±ç»“ç‚¹ã€‚</p><p>  ä½†æ˜¯å¯¹äºåŒå‘é“¾è¡¨æ¥è¯´ï¼Œè¿™ç§æƒ…å†µå°±æ¯”è¾ƒæœ‰ä¼˜åŠ¿äº†ã€‚å› ä¸ºåŒå‘é“¾è¡¨ä¸­çš„ç»“ç‚¹å·²ç»ä¿å­˜äº†å‰é©±ç»“ç‚¹çš„æŒ‡é’ˆï¼Œä¸éœ€è¦åƒå•é“¾è¡¨é‚£æ ·éå†ã€‚æ‰€ä»¥ï¼Œé’ˆå¯¹ç¬¬äºŒç§æƒ…å†µï¼Œå•é“¾è¡¨åˆ é™¤æ“ä½œéœ€è¦ O(n) çš„æ—¶é—´å¤æ‚åº¦ï¼Œè€ŒåŒå‘é“¾è¡¨åªéœ€è¦åœ¨ O(1) çš„æ—¶é—´å¤æ‚åº¦å†…å°±æå®šäº†ï¼</p><p>  åŒç†ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨é“¾è¡¨çš„æŸä¸ªæŒ‡å®šç»“ç‚¹å‰é¢æ’å…¥ä¸€ä¸ªç»“ç‚¹ï¼ŒåŒå‘é“¾è¡¨æ¯”å•é“¾è¡¨æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ã€‚åŒå‘é“¾è¡¨å¯ä»¥åœ¨ O(1) æ—¶é—´å¤æ‚åº¦æå®šï¼Œè€Œå•å‘é“¾è¡¨éœ€è¦ O(n) çš„æ—¶é—´å¤æ‚åº¦ã€‚ä½ å¯ä»¥å‚ç…§æˆ‘åˆšåˆšè®²è¿‡çš„åˆ é™¤æ“ä½œè‡ªå·±åˆ†æä¸€ä¸‹ã€‚</p><p>  é™¤äº†æ’å…¥ã€åˆ é™¤æ“ä½œæœ‰ä¼˜åŠ¿ä¹‹å¤–ï¼Œå¯¹äºä¸€ä¸ªæœ‰åºé“¾è¡¨ï¼ŒåŒå‘é“¾è¡¨çš„æŒ‰å€¼æŸ¥è¯¢çš„æ•ˆç‡ä¹Ÿè¦æ¯”å•é“¾è¡¨é«˜ä¸€äº›ã€‚å› ä¸ºï¼Œæˆ‘ä»¬å¯ä»¥è®°å½•ä¸Šæ¬¡æŸ¥æ‰¾çš„ä½ç½® pï¼Œæ¯æ¬¡æŸ¥è¯¢æ—¶ï¼Œæ ¹æ®è¦æŸ¥æ‰¾çš„å€¼ä¸ p çš„å¤§å°å…³ç³»ï¼Œå†³å®šæ˜¯å¾€å‰è¿˜æ˜¯å¾€åæŸ¥æ‰¾ï¼Œæ‰€ä»¥å¹³å‡åªéœ€è¦æŸ¥æ‰¾ä¸€åŠçš„æ•°æ®ã€‚</p><p>  ç°åœ¨ï¼Œä½ æœ‰æ²¡æœ‰è§‰å¾—åŒå‘é“¾è¡¨è¦æ¯”å•é“¾è¡¨æ›´åŠ é«˜æ•ˆå‘¢ï¼Ÿè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨å®é™…çš„è½¯ä»¶å¼€å‘ä¸­ï¼ŒåŒå‘é“¾è¡¨å°½ç®¡æ¯”è¾ƒè´¹å†…å­˜ï¼Œä½†è¿˜æ˜¯æ¯”å•é“¾è¡¨çš„åº”ç”¨æ›´åŠ å¹¿æ³›çš„åŸå› ã€‚å¦‚æœä½ ç†Ÿæ‚‰ Java è¯­è¨€ï¼Œä½ è‚¯å®šç”¨è¿‡ LinkedHashMap è¿™ä¸ªå®¹å™¨ã€‚å¦‚æœä½ æ·±å…¥ç ”ç©¶ LinkedHashMap çš„å®ç°åŸç†ï¼Œå°±ä¼šå‘ç°å…¶ä¸­å°±ç”¨åˆ°äº†åŒå‘é“¾è¡¨è¿™ç§æ•°æ®ç»“æ„ã€‚</p><p>  å®é™…ä¸Šï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ›´åŠ é‡è¦çš„çŸ¥è¯†ç‚¹éœ€è¦ä½ æŒæ¡ï¼Œé‚£å°±æ˜¯<code>ç”¨ç©ºé—´æ¢æ—¶é—´</code>çš„è®¾è®¡æ€æƒ³ã€‚å½“å†…å­˜ç©ºé—´å……è¶³çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æ›´åŠ è¿½æ±‚ä»£ç çš„æ‰§è¡Œé€Ÿåº¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€‰æ‹©ç©ºé—´å¤æ‚åº¦ç›¸å¯¹è¾ƒé«˜ã€ä½†æ—¶é—´å¤æ‚åº¦ç›¸å¯¹å¾ˆä½çš„ç®—æ³•æˆ–è€…æ•°æ®ç»“æ„ã€‚ç›¸åï¼Œå¦‚æœå†…å­˜æ¯”è¾ƒç´§ç¼ºï¼Œæ¯”å¦‚ä»£ç è·‘åœ¨æ‰‹æœºæˆ–è€…å•ç‰‡æœºä¸Šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±è¦åè¿‡æ¥ç”¨æ—¶é—´æ¢ç©ºé—´çš„è®¾è®¡æ€è·¯ã€‚</p><p>  å¯¹äºæ‰§è¡Œè¾ƒæ…¢çš„ç¨‹åºï¼Œå¯ä»¥é€šè¿‡æ¶ˆè€—æ›´å¤šçš„å†…å­˜ï¼ˆç©ºé—´æ¢æ—¶é—´ï¼‰æ¥è¿›è¡Œä¼˜åŒ–ï¼›è€Œæ¶ˆè€—è¿‡å¤šå†…å­˜çš„ç¨‹åºï¼Œå¯ä»¥é€šè¿‡æ¶ˆè€—æ›´å¤šçš„æ—¶é—´ï¼ˆæ—¶é—´æ¢ç©ºé—´ï¼‰æ¥é™ä½å†…å­˜çš„æ¶ˆè€—ã€‚</p></li></ul><h3 id="åŒå‘å¾ªç¯é“¾è¡¨"><a href="#åŒå‘å¾ªç¯é“¾è¡¨" class="headerlink" title="åŒå‘å¾ªç¯é“¾è¡¨"></a>åŒå‘å¾ªç¯é“¾è¡¨</h3><img src="https://static001.geekbang.org/resource/image/d1/91/d1665043b283ecdf79b157cfc9e5ed91.jpg"><h3 id="é“¾è¡¨-VS-æ•°ç»„æ€§èƒ½å¤§æ¯”æ‹¼"><a href="#é“¾è¡¨-VS-æ•°ç»„æ€§èƒ½å¤§æ¯”æ‹¼" class="headerlink" title="é“¾è¡¨ VS æ•°ç»„æ€§èƒ½å¤§æ¯”æ‹¼"></a>é“¾è¡¨ VS æ•°ç»„æ€§èƒ½å¤§æ¯”æ‹¼</h3><img src="https://static001.geekbang.org/resource/image/4f/68/4f63e92598ec2551069a0eef69db7168.jpg"><p>æ•°ç»„ç®€å•æ˜“ç”¨ï¼Œåœ¨å®ç°ä¸Šä½¿ç”¨çš„æ˜¯è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥å€ŸåŠ© CPU çš„ç¼“å­˜æœºåˆ¶ï¼Œé¢„è¯»æ•°ç»„ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥è®¿é—®æ•ˆç‡æ›´é«˜ã€‚è€Œé“¾è¡¨åœ¨å†…å­˜ä¸­å¹¶ä¸æ˜¯è¿ç»­å­˜å‚¨ï¼Œæ‰€ä»¥å¯¹ CPU ç¼“å­˜ä¸å‹å¥½ï¼Œæ²¡åŠæ³•æœ‰æ•ˆé¢„è¯»ã€‚</p><p>æ•°ç»„çš„ç¼ºç‚¹æ˜¯å¤§å°å›ºå®šï¼Œä¸€ç»å£°æ˜å°±è¦å ç”¨æ•´å—è¿ç»­å†…å­˜ç©ºé—´ã€‚å¦‚æœå£°æ˜çš„æ•°ç»„è¿‡å¤§ï¼Œç³»ç»Ÿå¯èƒ½æ²¡æœ‰è¶³å¤Ÿçš„è¿ç»­å†…å­˜ç©ºé—´åˆ†é…ç»™å®ƒï¼Œå¯¼è‡´â€œå†…å­˜ä¸è¶³ï¼ˆout of memoryï¼‰â€ã€‚å¦‚æœå£°æ˜çš„æ•°ç»„è¿‡å°ï¼Œåˆ™å¯èƒ½å‡ºç°ä¸å¤Ÿç”¨çš„æƒ…å†µã€‚è¿™æ—¶åªèƒ½å†ç”³è¯·ä¸€ä¸ªæ›´å¤§çš„å†…å­˜ç©ºé—´ï¼ŒæŠŠåŸæ•°ç»„æ‹·è´è¿›å»ï¼Œéå¸¸è´¹æ—¶ã€‚é“¾è¡¨æœ¬èº«æ²¡æœ‰å¤§å°çš„é™åˆ¶ï¼Œå¤©ç„¶åœ°æ”¯æŒåŠ¨æ€æ‰©å®¹ï¼Œæˆ‘è§‰å¾—è¿™ä¹Ÿæ˜¯å®ƒä¸æ•°ç»„æœ€å¤§çš„åŒºåˆ«ã€‚</p><p>å¦‚æœä½ çš„ä»£ç å¯¹å†…å­˜çš„ä½¿ç”¨éå¸¸è‹›åˆ»ï¼Œé‚£æ•°ç»„å°±æ›´é€‚åˆä½ ã€‚å› ä¸ºé“¾è¡¨ä¸­çš„æ¯ä¸ªç»“ç‚¹éƒ½éœ€è¦æ¶ˆè€—é¢å¤–çš„å­˜å‚¨ç©ºé—´å»å­˜å‚¨ä¸€ä»½æŒ‡å‘ä¸‹ä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥å†…å­˜æ¶ˆè€—ä¼šç¿»å€ã€‚è€Œä¸”ï¼Œå¯¹é“¾è¡¨è¿›è¡Œé¢‘ç¹çš„æ’å…¥ã€åˆ é™¤æ“ä½œï¼Œè¿˜ä¼šå¯¼è‡´é¢‘ç¹çš„å†…å­˜ç”³è¯·å’Œé‡Šæ”¾ï¼Œå®¹æ˜“é€ æˆå†…å­˜ç¢ç‰‡ï¼Œå¦‚æœæ˜¯ Java è¯­è¨€ï¼Œå°±æœ‰å¯èƒ½ä¼šå¯¼è‡´é¢‘ç¹çš„ GCï¼ˆGarbage Collectionï¼Œåƒåœ¾å›æ”¶ï¼‰ã€‚</p><h3 id="å¦‚ä½•åŸºäºé“¾è¡¨å®ç°-LRU-ç¼“å­˜æ·˜æ±°ç®—æ³•"><a href="#å¦‚ä½•åŸºäºé“¾è¡¨å®ç°-LRU-ç¼“å­˜æ·˜æ±°ç®—æ³•" class="headerlink" title="å¦‚ä½•åŸºäºé“¾è¡¨å®ç° LRU ç¼“å­˜æ·˜æ±°ç®—æ³•"></a>å¦‚ä½•åŸºäºé“¾è¡¨å®ç° LRU ç¼“å­˜æ·˜æ±°ç®—æ³•</h3><p>æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªæœ‰åºå•é“¾è¡¨ï¼Œè¶Šé è¿‘é“¾è¡¨å°¾éƒ¨çš„ç»“ç‚¹æ˜¯è¶Šæ—©ä¹‹å‰è®¿é—®çš„ã€‚å½“æœ‰ä¸€ä¸ªæ–°çš„æ•°æ®è¢«è®¿é—®æ—¶ï¼Œæˆ‘ä»¬ä»é“¾è¡¨å¤´å¼€å§‹é¡ºåºéå†é“¾è¡¨ã€‚</p><ol><li><p>å¦‚æœæ­¤æ•°æ®ä¹‹å‰å·²ç»è¢«ç¼“å­˜åœ¨é“¾è¡¨ä¸­äº†ï¼Œæˆ‘ä»¬éå†å¾—åˆ°è¿™ä¸ªæ•°æ®å¯¹åº”çš„ç»“ç‚¹ï¼Œå¹¶å°†å…¶ä»åŸæ¥çš„ä½ç½®åˆ é™¤ï¼Œç„¶åå†æ’å…¥åˆ°é“¾è¡¨çš„å¤´éƒ¨ã€‚</p></li><li><p>å¦‚æœæ­¤æ•°æ®æ²¡æœ‰åœ¨ç¼“å­˜é“¾è¡¨ä¸­ï¼Œåˆå¯ä»¥åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š</p><ul><li>å¦‚æœæ­¤æ—¶ç¼“å­˜æœªæ»¡ï¼Œåˆ™å°†æ­¤ç»“ç‚¹ç›´æ¥æ’å…¥åˆ°é“¾è¡¨çš„å¤´éƒ¨ï¼›</li><li>å¦‚æœæ­¤æ—¶ç¼“å­˜å·²æ»¡ï¼Œåˆ™é“¾è¡¨å°¾ç»“ç‚¹åˆ é™¤ï¼Œå°†æ–°çš„æ•°æ®ç»“ç‚¹æ’å…¥é“¾è¡¨çš„å¤´éƒ¨ã€‚</li></ul></li></ol><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸‹ç¼“å­˜è®¿é—®çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ã€‚å› ä¸ºä¸ç®¡ç¼“å­˜æœ‰æ²¡æœ‰æ»¡ï¼Œæˆ‘ä»¬éƒ½éœ€è¦éå†ä¸€éé“¾è¡¨ï¼Œæ‰€ä»¥è¿™ç§åŸºäºé“¾è¡¨çš„å®ç°æ€è·¯ï¼Œç¼“å­˜è®¿é—®çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚</p><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä¼˜åŒ–è¿™ä¸ªå®ç°æ€è·¯ï¼Œæ¯”å¦‚å¼•å…¥æ•£åˆ—è¡¨ï¼ˆHash tableï¼‰æ¥è®°å½•æ¯ä¸ªæ•°æ®çš„ä½ç½®ï¼Œå°†ç¼“å­˜è®¿é—®çš„æ—¶é—´å¤æ‚åº¦é™åˆ° O(1)ã€‚</p><h3 id="å†™é“¾è¡¨ä»£ç æŠ€å·§"><a href="#å†™é“¾è¡¨ä»£ç æŠ€å·§" class="headerlink" title="å†™é“¾è¡¨ä»£ç æŠ€å·§"></a>å†™é“¾è¡¨ä»£ç æŠ€å·§</h3><h4 id="ç†è§£æŒ‡é’ˆæˆ–å¼•ç”¨çš„å«ä¹‰"><a href="#ç†è§£æŒ‡é’ˆæˆ–å¼•ç”¨çš„å«ä¹‰" class="headerlink" title="ç†è§£æŒ‡é’ˆæˆ–å¼•ç”¨çš„å«ä¹‰"></a>ç†è§£æŒ‡é’ˆæˆ–å¼•ç”¨çš„å«ä¹‰</h4><p>äº‹å®ä¸Šï¼Œçœ‹æ‡‚é“¾è¡¨çš„ç»“æ„å¹¶ä¸æ˜¯å¾ˆéš¾ï¼Œä½†æ˜¯ä¸€æ—¦æŠŠå®ƒå’ŒæŒ‡é’ˆæ··åœ¨ä¸€èµ·ï¼Œå°±å¾ˆå®¹æ˜“è®©äººæ‘¸ä¸ç€å¤´è„‘ã€‚æ‰€ä»¥ï¼Œè¦æƒ³å†™å¯¹é“¾è¡¨ä»£ç ï¼Œé¦–å…ˆå°±è¦ç†è§£å¥½æŒ‡é’ˆã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œæœ‰äº›è¯­è¨€æœ‰â€œæŒ‡é’ˆâ€çš„æ¦‚å¿µï¼Œæ¯”å¦‚ C è¯­è¨€ï¼›æœ‰äº›è¯­è¨€æ²¡æœ‰æŒ‡é’ˆï¼Œå–è€Œä»£ä¹‹çš„æ˜¯â€œå¼•ç”¨â€ï¼Œæ¯”å¦‚ Javaã€Pythonã€‚ä¸ç®¡æ˜¯â€œæŒ‡é’ˆâ€è¿˜æ˜¯â€œå¼•ç”¨â€ï¼Œå®é™…ä¸Šï¼Œå®ƒä»¬çš„æ„æ€éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å­˜å‚¨æ‰€æŒ‡å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œä»¥ä¸‹ä¸º C è¯­è¨€çš„æŒ‡é’ˆï¼Œå…¶ä»–è¯­è¨€è‡ªè¡Œè½¬æ¢ä¸ºå¼•ç”¨å³å¯ã€‚</p><p>å®é™…ä¸Šï¼Œå¯¹äºæŒ‡é’ˆçš„ç†è§£ï¼Œä½ åªéœ€è¦è®°ä½ä¸‹é¢è¿™å¥è¯å°±å¯ä»¥äº†ï¼š</p><p><strong>å°†æŸä¸ªå˜é‡èµ‹å€¼ç»™æŒ‡é’ˆï¼Œå®é™…ä¸Šå°±æ˜¯å°†è¿™ä¸ªå˜é‡çš„åœ°å€èµ‹å€¼ç»™æŒ‡é’ˆï¼Œæˆ–è€…åè¿‡æ¥è¯´ï¼ŒæŒ‡é’ˆä¸­å­˜å‚¨äº†è¿™ä¸ªå˜é‡çš„å†…å­˜åœ°å€ï¼ŒæŒ‡å‘äº†è¿™ä¸ªå˜é‡ï¼Œé€šè¿‡æŒ‡é’ˆå°±èƒ½æ‰¾åˆ°è¿™ä¸ªå˜é‡ã€‚</strong></p><p>åœ¨ç¼–å†™é“¾è¡¨ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæœ‰è¿™æ ·çš„ä»£ç ï¼šp-&gt;next=qã€‚è¿™è¡Œä»£ç æ˜¯è¯´ï¼Œp ç»“ç‚¹ä¸­çš„ next æŒ‡é’ˆå­˜å‚¨äº† q ç»“ç‚¹çš„å†…å­˜åœ°å€ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªæ›´å¤æ‚çš„ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å†™é“¾è¡¨ä»£ç ç»å¸¸ä¼šç”¨åˆ°çš„ï¼šp-&gt;next=p-&gt;next-&gt;nextã€‚è¿™è¡Œä»£ç è¡¨ç¤ºï¼Œp ç»“ç‚¹çš„ next æŒ‡é’ˆå­˜å‚¨äº† p ç»“ç‚¹çš„ä¸‹ä¸‹ä¸€ä¸ªç»“ç‚¹çš„å†…å­˜åœ°å€ã€‚</p><h4 id="è­¦æƒ•æŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„æ¼"><a href="#è­¦æƒ•æŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„æ¼" class="headerlink" title="è­¦æƒ•æŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„æ¼"></a>è­¦æƒ•æŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„æ¼</h4><img src="https://static001.geekbang.org/resource/image/05/6e/05a4a3b57502968930d517c934347c6e.jpg"><p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ç»“ç‚¹ a å’Œç›¸é‚»çš„ç»“ç‚¹ b ä¹‹é—´æ’å…¥ç»“ç‚¹ xï¼Œå‡è®¾å½“å‰æŒ‡é’ˆ p æŒ‡å‘ç»“ç‚¹ aã€‚å¦‚æœæˆ‘ä»¬å°†ä»£ç å®ç°å˜æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼Œå°±ä¼šå‘ç”ŸæŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„éœ²ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">p-&gt;next = x;  <span class="hljs-comment">// å°†pçš„nextæŒ‡é’ˆæŒ‡å‘xç»“ç‚¹ï¼›</span><br>x-&gt;next = p-&gt;next;  <span class="hljs-comment">// å°†xçš„ç»“ç‚¹çš„nextæŒ‡é’ˆæŒ‡å‘bç»“ç‚¹ï¼›</span><br></code></pre></td></tr></table></figure><p>p-&gt;next æŒ‡é’ˆåœ¨å®Œæˆç¬¬ä¸€æ­¥æ“ä½œä¹‹åï¼Œå·²ç»ä¸å†æŒ‡å‘ç»“ç‚¹ b äº†ï¼Œè€Œæ˜¯æŒ‡å‘ç»“ç‚¹ xã€‚ç¬¬ 2 è¡Œä»£ç ç›¸å½“äºå°† x èµ‹å€¼ç»™ x-&gt;nextï¼Œè‡ªå·±æŒ‡å‘è‡ªå·±ã€‚å› æ­¤ï¼Œæ•´ä¸ªé“¾è¡¨ä¹Ÿå°±æ–­æˆäº†ä¸¤åŠï¼Œä»ç»“ç‚¹ b å¾€åçš„æ‰€æœ‰ç»“ç‚¹éƒ½æ— æ³•è®¿é—®åˆ°äº†ã€‚</p><p>å¯¹äºæœ‰äº›è¯­è¨€æ¥è¯´ï¼Œæ¯”å¦‚ C è¯­è¨€ï¼Œå†…å­˜ç®¡ç†æ˜¯ç”±ç¨‹åºå‘˜è´Ÿè´£çš„ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨é‡Šæ”¾ç»“ç‚¹å¯¹åº”çš„å†…å­˜ç©ºé—´ï¼Œå°±ä¼šäº§ç”Ÿå†…å­˜æ³„éœ²ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æ’å…¥ç»“ç‚¹æ—¶ï¼Œä¸€å®šè¦æ³¨æ„æ“ä½œçš„é¡ºåºï¼Œè¦å…ˆå°†ç»“ç‚¹ x çš„ next æŒ‡é’ˆæŒ‡å‘ç»“ç‚¹ bï¼Œå†æŠŠç»“ç‚¹ a çš„ next æŒ‡é’ˆæŒ‡å‘ç»“ç‚¹ xï¼Œè¿™æ ·æ‰ä¸ä¼šä¸¢å¤±æŒ‡é’ˆï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚æ‰€ä»¥ï¼Œå¯¹äºåˆšåˆšçš„æ’å…¥ä»£ç ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠç¬¬ 1 è¡Œå’Œç¬¬ 2 è¡Œä»£ç çš„é¡ºåºé¢ å€’ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p><p>åŒç†ï¼Œåˆ é™¤é“¾è¡¨ç»“ç‚¹æ—¶ï¼Œä¹Ÿä¸€å®šè¦è®°å¾—æ‰‹åŠ¨é‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œå¦åˆ™ï¼Œä¹Ÿä¼šå‡ºç°å†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚å½“ç„¶ï¼Œå¯¹äºåƒ Java è¿™ç§è™šæ‹Ÿæœºè‡ªåŠ¨ç®¡ç†å†…å­˜çš„ç¼–ç¨‹è¯­è¨€æ¥è¯´ï¼Œå°±ä¸éœ€è¦è€ƒè™‘è¿™ä¹ˆå¤šäº†ã€‚</p><h4 id="åˆ©ç”¨å“¨å…µç®€åŒ–å®ç°éš¾åº¦"><a href="#åˆ©ç”¨å“¨å…µç®€åŒ–å®ç°éš¾åº¦" class="headerlink" title="åˆ©ç”¨å“¨å…µç®€åŒ–å®ç°éš¾åº¦"></a>åˆ©ç”¨å“¨å…µç®€åŒ–å®ç°éš¾åº¦</h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹å•é“¾è¡¨çš„æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚å¦‚æœæˆ‘ä»¬åœ¨ç»“ç‚¹ p åé¢æ’å…¥ä¸€ä¸ªæ–°çš„ç»“ç‚¹ï¼Œåªéœ€è¦ä¸‹é¢ä¸¤è¡Œä»£ç å°±å¯ä»¥æå®šã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">new_node-&gt;next = p-&gt;next;<br>p-&gt;next = new_node;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬è¦å‘ä¸€ä¸ªç©ºé“¾è¡¨ä¸­æ’å…¥ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œåˆšåˆšçš„é€»è¾‘å°±ä¸èƒ½ç”¨äº†ã€‚æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸‹é¢è¿™æ ·çš„ç‰¹æ®Šå¤„ç†ï¼Œå…¶ä¸­ head è¡¨ç¤ºé“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚æ‰€ä»¥ï¼Œä»è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹äºå•é“¾è¡¨çš„æ’å…¥æ“ä½œï¼Œç¬¬ä¸€ä¸ªç»“ç‚¹å’Œå…¶ä»–ç»“ç‚¹çš„æ’å…¥é€»è¾‘æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> (head == null) &#123;<br>  head = new_node;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å†æ¥çœ‹å•é“¾è¡¨ç»“ç‚¹åˆ é™¤æ“ä½œã€‚å¦‚æœè¦åˆ é™¤ç»“ç‚¹ p çš„åç»§ç»“ç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€è¡Œä»£ç å°±å¯ä»¥æå®šã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">p-&gt;next = p-&gt;next-&gt;next;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ é™¤é“¾è¡¨ä¸­çš„æœ€åä¸€ä¸ªç»“ç‚¹ï¼Œå‰é¢çš„åˆ é™¤ä»£ç å°±ä¸ work äº†ã€‚è·Ÿæ’å…¥ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹äºè¿™ç§æƒ…å†µç‰¹æ®Šå¤„ç†ã€‚å†™æˆä»£ç æ˜¯è¿™æ ·å­çš„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> (head-&gt;next == null) &#123;<br>   head = null;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»å‰é¢çš„ä¸€æ­¥ä¸€æ­¥åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œé’ˆå¯¹é“¾è¡¨çš„æ’å…¥ã€åˆ é™¤æ“ä½œï¼Œéœ€è¦å¯¹æ’å…¥ç¬¬ä¸€ä¸ªç»“ç‚¹å’Œåˆ é™¤æœ€åä¸€ä¸ªç»“ç‚¹çš„æƒ…å†µè¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚è¿™æ ·ä»£ç å®ç°èµ·æ¥å°±ä¼šå¾ˆç¹çï¼Œä¸ç®€æ´ï¼Œè€Œä¸”ä¹Ÿå®¹æ˜“å› ä¸ºè€ƒè™‘ä¸å…¨è€Œå‡ºé”™ã€‚å¦‚ä½•æ¥è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><p>æŠ€å·§ä¸‰ä¸­æåˆ°çš„å“¨å…µå°±è¦ç™»åœºäº†ã€‚å“¨å…µï¼Œè§£å†³çš„æ˜¯å›½å®¶ä¹‹é—´çš„è¾¹ç•Œé—®é¢˜ã€‚åŒç†ï¼Œè¿™é‡Œè¯´çš„å“¨å…µä¹Ÿæ˜¯è§£å†³â€œè¾¹ç•Œé—®é¢˜â€çš„ï¼Œä¸ç›´æ¥å‚ä¸ä¸šåŠ¡é€»è¾‘ã€‚</p><p>è¿˜è®°å¾—å¦‚ä½•è¡¨ç¤ºä¸€ä¸ªç©ºé“¾è¡¨å—ï¼Ÿhead=null è¡¨ç¤ºé“¾è¡¨ä¸­æ²¡æœ‰ç»“ç‚¹äº†ã€‚å…¶ä¸­ head è¡¨ç¤ºå¤´ç»“ç‚¹æŒ‡é’ˆï¼ŒæŒ‡å‘é“¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ã€‚</p><p>å¦‚æœæˆ‘ä»¬å¼•å…¥å“¨å…µç»“ç‚¹ï¼Œåœ¨ä»»ä½•æ—¶å€™ï¼Œä¸ç®¡é“¾è¡¨æ˜¯ä¸æ˜¯ç©ºï¼Œhead æŒ‡é’ˆéƒ½ä¼šä¸€ç›´æŒ‡å‘è¿™ä¸ªå“¨å…µç»“ç‚¹ã€‚æˆ‘ä»¬ä¹ŸæŠŠè¿™ç§æœ‰å“¨å…µç»“ç‚¹çš„é“¾è¡¨å«å¸¦å¤´é“¾è¡¨ã€‚ç›¸åï¼Œæ²¡æœ‰å“¨å…µç»“ç‚¹çš„é“¾è¡¨å°±å«ä½œä¸å¸¦å¤´é“¾è¡¨ã€‚</p><p>å¦‚å›¾ï¼Œä½ å¯ä»¥å‘ç°ï¼Œå“¨å…µç»“ç‚¹æ˜¯ä¸å­˜å‚¨æ•°æ®çš„ã€‚å› ä¸ºå“¨å…µç»“ç‚¹ä¸€ç›´å­˜åœ¨ï¼Œæ‰€ä»¥æ’å…¥ç¬¬ä¸€ä¸ªç»“ç‚¹å’Œæ’å…¥å…¶ä»–ç»“ç‚¹ï¼Œåˆ é™¤æœ€åä¸€ä¸ªç»“ç‚¹å’Œåˆ é™¤å…¶ä»–ç»“ç‚¹ï¼Œéƒ½å¯ä»¥ç»Ÿä¸€ä¸ºç›¸åŒçš„ä»£ç å®ç°é€»è¾‘äº†ã€‚</p><img src="https://static001.geekbang.org/resource/image/7d/c7/7d22d9428bdbba96bfe388fe1e3368c7.jpg"><p>å®é™…ä¸Šï¼Œè¿™ç§åˆ©ç”¨å“¨å…µç®€åŒ–ç¼–ç¨‹éš¾åº¦çš„æŠ€å·§ï¼Œåœ¨å¾ˆå¤šä»£ç å®ç°ä¸­éƒ½æœ‰ç”¨åˆ°ï¼Œæ¯”å¦‚æ’å…¥æ’åºã€å½’å¹¶æ’åºã€åŠ¨æ€è§„åˆ’ç­‰ã€‚ç°åœ¨ä¸ºäº†è®©ä½ æ„Ÿå—æ›´æ·±ï¼Œæˆ‘å†ä¸¾ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ã€‚ä»£ç æˆ‘æ˜¯ç”¨ C è¯­è¨€å®ç°çš„ï¼Œä¸æ¶‰åŠè¯­è¨€æ–¹é¢çš„é«˜çº§è¯­æ³•ï¼Œå¾ˆå®¹æ˜“çœ‹æ‡‚ï¼Œä½ å¯ä»¥ç±»æ¯”åˆ°ä½ ç†Ÿæ‚‰çš„è¯­è¨€ã€‚</p><p>ä»£ç ä¸€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// åœ¨æ•°ç»„aä¸­ï¼ŒæŸ¥æ‰¾keyï¼Œè¿”å›keyæ‰€åœ¨çš„ä½ç½®</span><br><span class="hljs-comment">// å…¶ä¸­ï¼Œnè¡¨ç¤ºæ•°ç»„açš„é•¿åº¦</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* a, <span class="hljs-keyword">int</span> n, <span class="hljs-keyword">char</span> key)</span> </span>&#123;<br>  <span class="hljs-comment">// è¾¹ç•Œæ¡ä»¶å¤„ç†ï¼Œå¦‚æœaä¸ºç©ºï¼Œæˆ–è€…n&lt;=0ï¼Œè¯´æ˜æ•°ç»„ä¸­æ²¡æœ‰æ•°æ®ï¼Œå°±ä¸ç”¨whileå¾ªç¯æ¯”è¾ƒäº†</span><br>  <span class="hljs-keyword">if</span>(a == null || n &lt;= <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br>  <br>  <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-comment">// è¿™é‡Œæœ‰ä¸¤ä¸ªæ¯”è¾ƒæ“ä½œï¼ši&lt;nå’Œa[i]==key.</span><br>  <span class="hljs-keyword">while</span> (i &lt; n) &#123;<br>    <span class="hljs-keyword">if</span> (a[i] == key) &#123;<br>      <span class="hljs-keyword">return</span> i;<br>    &#125;<br>    ++i;<br>  &#125;<br>  <br>  <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£ç äºŒï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// åœ¨æ•°ç»„aä¸­ï¼ŒæŸ¥æ‰¾keyï¼Œè¿”å›keyæ‰€åœ¨çš„ä½ç½®</span><br><span class="hljs-comment">// å…¶ä¸­ï¼Œnè¡¨ç¤ºæ•°ç»„açš„é•¿åº¦</span><br><span class="hljs-comment">// æˆ‘ä¸¾2ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥æ‹¿ä¾‹å­èµ°ä¸€ä¸‹ä»£ç </span><br><span class="hljs-comment">// a = &#123;4, 2, 3, 5, 9, 6&#125;  n=6 key = 7</span><br><span class="hljs-comment">// a = &#123;4, 2, 3, 5, 9, 6&#125;  n=6 key = 6</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* a, <span class="hljs-keyword">int</span> n, <span class="hljs-keyword">char</span> key)</span> </span>&#123;<br>  <span class="hljs-keyword">if</span>(a == null || n &lt;= <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br>  <br>  <span class="hljs-comment">// è¿™é‡Œå› ä¸ºè¦å°†a[n-1]çš„å€¼æ›¿æ¢æˆkeyï¼Œæ‰€ä»¥è¦ç‰¹æ®Šå¤„ç†è¿™ä¸ªå€¼</span><br>  <span class="hljs-keyword">if</span> (a[n<span class="hljs-number">-1</span>] == key) &#123;<br>    <span class="hljs-keyword">return</span> n<span class="hljs-number">-1</span>;<br>  &#125;<br>  <br>  <span class="hljs-comment">// æŠŠa[n-1]çš„å€¼ä¸´æ—¶ä¿å­˜åœ¨å˜é‡tmpä¸­ï¼Œä»¥ä¾¿ä¹‹åæ¢å¤ã€‚tmp=6ã€‚</span><br>  <span class="hljs-comment">// ä¹‹æ‰€ä»¥è¿™æ ·åšçš„ç›®çš„æ˜¯ï¼šå¸Œæœ›find()ä»£ç ä¸è¦æ”¹å˜aæ•°ç»„ä¸­çš„å†…å®¹</span><br>  <span class="hljs-keyword">char</span> tmp = a[n<span class="hljs-number">-1</span>];<br>  <span class="hljs-comment">// æŠŠkeyçš„å€¼æ”¾åˆ°a[n-1]ä¸­ï¼Œæ­¤æ—¶a = &#123;4, 2, 3, 5, 9, 7&#125;</span><br>  a[n<span class="hljs-number">-1</span>] = key;<br>  <br>  <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-comment">// while å¾ªç¯æ¯”èµ·ä»£ç ä¸€ï¼Œå°‘äº†i&lt;nè¿™ä¸ªæ¯”è¾ƒæ“ä½œ</span><br>  <span class="hljs-keyword">while</span> (a[i] != key) &#123;<br>    ++i;<br>  &#125;<br>  <br>  <span class="hljs-comment">// æ¢å¤a[n-1]åŸæ¥çš„å€¼,æ­¤æ—¶a= &#123;4, 2, 3, 5, 9, 6&#125;</span><br>  a[n<span class="hljs-number">-1</span>] = tmp;<br>  <br>  <span class="hljs-keyword">if</span> (i == n<span class="hljs-number">-1</span>) &#123;<br>    <span class="hljs-comment">// å¦‚æœi == n-1è¯´æ˜ï¼Œåœ¨0...n-2ä¹‹é—´éƒ½æ²¡æœ‰keyï¼Œæ‰€ä»¥è¿”å›-1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// å¦åˆ™ï¼Œè¿”å›iï¼Œå°±æ˜¯ç­‰äºkeyå€¼çš„å…ƒç´ çš„ä¸‹æ ‡</span><br>    <span class="hljs-keyword">return</span> i;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹æ¯”ä¸¤æ®µä»£ç ï¼Œåœ¨å­—ç¬¦ä¸² a å¾ˆé•¿çš„æ—¶å€™ï¼Œæ¯”å¦‚å‡ ä¸‡ã€å‡ åä¸‡ï¼Œä½ è§‰å¾—å“ªæ®µä»£ç è¿è¡Œå¾—æ›´å¿«ç‚¹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä»£ç äºŒï¼Œå› ä¸ºä¸¤æ®µä»£ç ä¸­æ‰§è¡Œæ¬¡æ•°æœ€å¤šå°±æ˜¯ while å¾ªç¯é‚£ä¸€éƒ¨åˆ†ã€‚ç¬¬äºŒæ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå“¨å…µ a[n-1] = keyï¼ŒæˆåŠŸçœæ‰äº†ä¸€ä¸ªæ¯”è¾ƒè¯­å¥ i</p><p>å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸ºäº†ä¸¾ä¾‹è¯´æ˜å“¨å…µçš„ä½œç”¨ï¼Œä½ å†™ä»£ç çš„æ—¶å€™åƒä¸‡ä¸è¦å†™ç¬¬äºŒæ®µé‚£æ ·çš„ä»£ç ï¼Œå› ä¸ºå¯è¯»æ€§å¤ªå·®äº†ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å¦‚æ­¤è¿½æ±‚æè‡´çš„æ€§èƒ½ã€‚</p><h4 id="é‡ç‚¹ç•™æ„è¾¹ç•Œæ¡ä»¶å¤„ç†"><a href="#é‡ç‚¹ç•™æ„è¾¹ç•Œæ¡ä»¶å¤„ç†" class="headerlink" title="é‡ç‚¹ç•™æ„è¾¹ç•Œæ¡ä»¶å¤„ç†"></a>é‡ç‚¹ç•™æ„è¾¹ç•Œæ¡ä»¶å¤„ç†</h4><p>è½¯ä»¶å¼€å‘ä¸­ï¼Œä»£ç åœ¨ä¸€äº›è¾¹ç•Œæˆ–è€…å¼‚å¸¸æƒ…å†µä¸‹ï¼Œæœ€å®¹æ˜“äº§ç”Ÿ Bugã€‚é“¾è¡¨ä»£ç ä¹Ÿä¸ä¾‹å¤–ã€‚è¦å®ç°æ²¡æœ‰ Bug çš„é“¾è¡¨ä»£ç ï¼Œä¸€å®šè¦åœ¨ç¼–å†™çš„è¿‡ç¨‹ä¸­ä»¥åŠç¼–å†™å®Œæˆä¹‹åï¼Œæ£€æŸ¥è¾¹ç•Œæ¡ä»¶æ˜¯å¦è€ƒè™‘å…¨é¢ï¼Œä»¥åŠä»£ç åœ¨è¾¹ç•Œæ¡ä»¶ä¸‹æ˜¯å¦èƒ½æ­£ç¡®è¿è¡Œã€‚</p><p>å¯å‚è€ƒä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ul><li>å¦‚æœé“¾è¡¨ä¸ºç©ºæ—¶ï¼Œä»£ç æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œï¼Ÿ</li><li>å¦‚æœé“¾è¡¨åªåŒ…å«ä¸€ä¸ªç»“ç‚¹æ—¶ï¼Œä»£ç æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œï¼Ÿ</li><li>å¦‚æœé“¾è¡¨åªåŒ…å«ä¸¤ä¸ªç»“ç‚¹æ—¶ï¼Œä»£ç æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œï¼Ÿ</li><li>ä»£ç é€»è¾‘åœ¨å¤„ç†å¤´ç»“ç‚¹å’Œå°¾ç»“ç‚¹çš„æ—¶å€™ï¼Œæ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œï¼Ÿ</li></ul><h4 id="ä¸¾ä¾‹ç”»å›¾ï¼Œè¾…åŠ©æ€è€ƒ"><a href="#ä¸¾ä¾‹ç”»å›¾ï¼Œè¾…åŠ©æ€è€ƒ" class="headerlink" title="ä¸¾ä¾‹ç”»å›¾ï¼Œè¾…åŠ©æ€è€ƒ"></a>ä¸¾ä¾‹ç”»å›¾ï¼Œè¾…åŠ©æ€è€ƒ</h4><p>å¯¹äºç¨å¾®å¤æ‚çš„é“¾è¡¨æ“ä½œï¼Œæ¯”å¦‚å‰é¢æˆ‘ä»¬æåˆ°çš„å•é“¾è¡¨åè½¬ï¼ŒæŒ‡é’ˆä¸€ä¼šå„¿æŒ‡è¿™ï¼Œä¸€ä¼šå„¿æŒ‡é‚£ï¼Œä¸€ä¼šå„¿å°±è¢«ç»•æ™•äº†ã€‚æ€»æ„Ÿè§‰è„‘å®¹é‡ä¸å¤Ÿï¼Œæƒ³ä¸æ¸…æ¥šã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±è¦ä½¿ç”¨å¤§æ‹›äº†ï¼Œä¸¾ä¾‹æ³•å’Œç”»å›¾æ³•ã€‚</p><p>ä½ å¯ä»¥æ‰¾ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼ŒæŠŠå®ƒç”»åœ¨çº¸ä¸Šï¼Œé‡Šæ”¾ä¸€äº›è„‘å®¹é‡ï¼Œç•™æ›´å¤šçš„ç»™é€»è¾‘æ€è€ƒï¼Œè¿™æ ·å°±ä¼šæ„Ÿè§‰åˆ°æ€è·¯æ¸…æ™°å¾ˆå¤šã€‚æ¯”å¦‚å¾€å•é“¾è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ•°æ®è¿™æ ·ä¸€ä¸ªæ“ä½œï¼Œæˆ‘ä¸€èˆ¬éƒ½æ˜¯æŠŠå„ç§æƒ…å†µéƒ½ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œç”»å‡ºæ’å…¥å‰å’Œæ’å…¥åçš„é“¾è¡¨å˜åŒ–ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><img src="https://static001.geekbang.org/resource/image/4a/f8/4a701dd79b59427be654261805b349f8.jpg"><p>è½¬è‡ª ã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ•°ç»„ä»‹ç»</title>
    <link href="/2021/07/05/array-introduction/"/>
    <url>/2021/07/05/array-introduction/</url>
    
    <content type="html"><![CDATA[<h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><p>æ•°ç»„ï¼ˆArrayï¼‰æ˜¯ä¸€ç§çº¿æ€§è¡¨æ•°æ®ç»“æ„ã€‚å®ƒç”¨ä¸€ç»„è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œæ¥å­˜å‚¨ä¸€ç»„å…·æœ‰ç›¸åŒç±»å‹çš„æ•°æ®ã€‚</p><ul><li><p>çº¿æ€§è¡¨ï¼ˆLinear Listï¼‰ã€‚é¡¾åæ€ä¹‰ï¼Œçº¿æ€§è¡¨å°±æ˜¯æ•°æ®æ’æˆåƒä¸€æ¡çº¿ä¸€æ ·çš„ç»“æ„ã€‚æ¯ä¸ªçº¿æ€§è¡¨ä¸Šçš„æ•°æ®æœ€å¤šåªæœ‰å‰å’Œåä¸¤ä¸ªæ–¹å‘ã€‚å…¶å®é™¤äº†æ•°ç»„ï¼Œé“¾è¡¨ã€é˜Ÿåˆ—ã€æ ˆç­‰ä¹Ÿæ˜¯çº¿æ€§è¡¨ç»“æ„ã€‚</p>  <img src="https://static001.geekbang.org/resource/image/b6/77/b6b71ec46935130dff5c4b62cf273477.jpg"/><p>  ä¸å®ƒç›¸å¯¹ç«‹çš„æ¦‚å¿µæ˜¯éçº¿æ€§è¡¨ï¼Œæ¯”å¦‚äºŒå‰æ ‘ã€å †ã€å›¾ç­‰ã€‚ä¹‹æ‰€ä»¥å«éçº¿æ€§ï¼Œæ˜¯å› ä¸ºï¼Œåœ¨éçº¿æ€§è¡¨ä¸­ï¼Œæ•°æ®ä¹‹é—´å¹¶ä¸æ˜¯ç®€å•çš„å‰åå…³ç³»ã€‚</p>  <img src="https://static001.geekbang.org/resource/image/6e/69/6ebf42641b5f98f912d36f6bf86f6569.jpg"/></li><li><p>è¿ç»­çš„å†…å­˜ç©ºé—´å’Œç›¸åŒç±»å‹çš„æ•°æ®ã€‚æ­£æ˜¯å› ä¸ºè¿™ä¸¤ä¸ªé™åˆ¶ï¼Œå®ƒæ‰æœ‰äº†ä¸€ä¸ªå ªç§°â€œæ€æ‰‹é”â€çš„ç‰¹æ€§ï¼šâ€œéšæœºè®¿é—®â€ã€‚ä½†æœ‰åˆ©å°±æœ‰å¼Šï¼Œè¿™ä¸¤ä¸ªé™åˆ¶ä¹Ÿè®©æ•°ç»„çš„å¾ˆå¤šæ“ä½œå˜å¾—éå¸¸ä½æ•ˆï¼Œæ¯”å¦‚è¦æƒ³åœ¨æ•°ç»„ä¸­åˆ é™¤ã€æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œä¸ºäº†ä¿è¯è¿ç»­æ€§ï¼Œå°±éœ€è¦åšå¤§é‡çš„æ•°æ®æ¬ç§»å·¥ä½œã€‚</p></li></ul><h3 id="æ•°ç»„æ˜¯å¦‚ä½•å®ç°æ ¹æ®ä¸‹æ ‡éšæœºè®¿é—®æ•°ç»„å…ƒç´ çš„"><a href="#æ•°ç»„æ˜¯å¦‚ä½•å®ç°æ ¹æ®ä¸‹æ ‡éšæœºè®¿é—®æ•°ç»„å…ƒç´ çš„" class="headerlink" title="æ•°ç»„æ˜¯å¦‚ä½•å®ç°æ ¹æ®ä¸‹æ ‡éšæœºè®¿é—®æ•°ç»„å…ƒç´ çš„"></a>æ•°ç»„æ˜¯å¦‚ä½•å®ç°æ ¹æ®ä¸‹æ ‡éšæœºè®¿é—®æ•°ç»„å…ƒç´ çš„</h3><p>æ‹¿ä¸€ä¸ªé•¿åº¦ä¸º 10 çš„ int ç±»å‹çš„æ•°ç»„ int[] a = new int[10]æ¥ä¸¾ä¾‹ã€‚åœ¨æˆ‘ç”»çš„è¿™ä¸ªå›¾ä¸­ï¼Œè®¡ç®—æœºç»™æ•°ç»„ a[10]ï¼Œåˆ†é…äº†ä¸€å—è¿ç»­å†…å­˜ç©ºé—´ 1000ï½1039ï¼Œå…¶ä¸­ï¼Œå†…å­˜å—çš„é¦–åœ°å€ä¸º base_address = 1000ã€‚</p><img src="https://static001.geekbang.org/resource/image/98/c4/98df8e702b14096e7ee4a5141260cdc4.jpg"><p>æˆ‘ä»¬çŸ¥é“ï¼Œè®¡ç®—æœºä¼šç»™æ¯ä¸ªå†…å­˜å•å…ƒåˆ†é…ä¸€ä¸ªåœ°å€ï¼Œè®¡ç®—æœºé€šè¿‡åœ°å€æ¥è®¿é—®å†…å­˜ä¸­çš„æ•°æ®ã€‚å½“è®¡ç®—æœºéœ€è¦éšæœºè®¿é—®æ•°ç»„ä¸­çš„æŸä¸ªå…ƒç´ æ—¶ï¼Œå®ƒä¼šé¦–å…ˆé€šè¿‡ä¸‹é¢çš„å¯»å€å…¬å¼ï¼Œè®¡ç®—å‡ºè¯¥å…ƒç´ å­˜å‚¨çš„å†…å­˜åœ°å€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">a[i]_address = base_address + i * data_type_size<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ data_type_size è¡¨ç¤ºæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„å¤§å°ã€‚æˆ‘ä»¬ä¸¾çš„è¿™ä¸ªä¾‹å­é‡Œï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯ int ç±»å‹æ•°æ®ï¼Œæ‰€ä»¥ data_type_size å°±ä¸º 4 ä¸ªå­—èŠ‚ã€‚</p><p>æ•°ç»„æ”¯æŒéšæœºè®¿é—®ï¼Œæ ¹æ®ä¸‹æ ‡éšæœºè®¿é—®çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚</p><h3 id="ä½æ•ˆçš„â€œæ’å…¥â€å’Œâ€œåˆ é™¤â€"><a href="#ä½æ•ˆçš„â€œæ’å…¥â€å’Œâ€œåˆ é™¤â€" class="headerlink" title="ä½æ•ˆçš„â€œæ’å…¥â€å’Œâ€œåˆ é™¤â€"></a>ä½æ•ˆçš„â€œæ’å…¥â€å’Œâ€œåˆ é™¤â€</h3><ul><li>æ’å…¥æ“ä½œ</li></ul><p>å‡è®¾æ•°ç»„çš„é•¿åº¦ä¸º nï¼Œç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å°†ä¸€ä¸ªæ•°æ®æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ k ä¸ªä½ç½®ã€‚ä¸ºäº†æŠŠç¬¬ k ä¸ªä½ç½®è…¾å‡ºæ¥ï¼Œç»™æ–°æ¥çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å°†ç¬¬ kï½n è¿™éƒ¨åˆ†çš„å…ƒç´ éƒ½é¡ºåºåœ°å¾€åæŒªä¸€ä½ã€‚é‚£æ’å…¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿ</p><p>å¦‚æœåœ¨æ•°ç»„çš„æœ«å°¾æ’å…¥å…ƒç´ ï¼Œé‚£å°±ä¸éœ€è¦ç§»åŠ¨æ•°æ®äº†ï¼Œè¿™æ—¶çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚ä½†å¦‚æœåœ¨æ•°ç»„çš„å¼€å¤´æ’å…¥å…ƒç´ ï¼Œé‚£æ‰€æœ‰çš„æ•°æ®éƒ½éœ€è¦ä¾æ¬¡å¾€åç§»åŠ¨ä¸€ä½ï¼Œæ‰€ä»¥æœ€åæ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚ å› ä¸ºæˆ‘ä»¬åœ¨æ¯ä¸ªä½ç½®æ’å…¥å…ƒç´ çš„æ¦‚ç‡æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦ä¸º (1+2+â€¦n)/n=O(n)ã€‚</p><p>å¦‚æœæ•°ç»„ä¸­çš„æ•°æ®æ˜¯æœ‰åºçš„ï¼Œæˆ‘ä»¬åœ¨æŸä¸ªä½ç½®æ’å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ æ—¶ï¼Œå°±å¿…é¡»æŒ‰ç…§åˆšæ‰çš„æ–¹æ³•æ¬ç§» k ä¹‹åçš„æ•°æ®ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ•°ç»„ä¸­å­˜å‚¨çš„æ•°æ®å¹¶æ²¡æœ‰ä»»ä½•è§„å¾‹ï¼Œæ•°ç»„åªæ˜¯è¢«å½“ä½œä¸€ä¸ªå­˜å‚¨æ•°æ®çš„é›†åˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœè¦å°†æŸä¸ªæ•°æ®æ’å…¥åˆ°ç¬¬ k ä¸ªä½ç½®ï¼Œä¸ºäº†é¿å…å¤§è§„æ¨¡çš„æ•°æ®æ¬ç§»ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªç®€å•çš„åŠæ³•å°±æ˜¯ï¼Œç›´æ¥å°†ç¬¬ k ä½çš„æ•°æ®æ¬ç§»åˆ°æ•°ç»„å…ƒç´ çš„æœ€åï¼ŒæŠŠæ–°çš„å…ƒç´ ç›´æ¥æ”¾å…¥ç¬¬ k ä¸ªä½ç½®ã€‚</p><p>ä¸¾ä¸€ä¸ªä¾‹å­ã€‚å‡è®¾æ•°ç»„ a[10]ä¸­å­˜å‚¨äº†å¦‚ä¸‹ 5 ä¸ªå…ƒç´ ï¼šaï¼Œbï¼Œcï¼Œdï¼Œeã€‚</p><p>æˆ‘ä»¬ç°åœ¨éœ€è¦å°†å…ƒç´  x æ’å…¥åˆ°ç¬¬ 3 ä¸ªä½ç½®ã€‚æˆ‘ä»¬åªéœ€è¦å°† c æ”¾å…¥åˆ° a[5]ï¼Œå°† a[2]èµ‹å€¼ä¸º x å³å¯ã€‚æœ€åï¼Œæ•°ç»„ä¸­çš„å…ƒç´ å¦‚ä¸‹ï¼š aï¼Œbï¼Œxï¼Œdï¼Œeï¼Œcã€‚</p><img src="https://static001.geekbang.org/resource/image/3f/dc/3f70b4ad9069ec568a2caaddc231b7dc.jpg"><p>åˆ©ç”¨è¿™ç§å¤„ç†æŠ€å·§ï¼Œåœ¨ç‰¹å®šåœºæ™¯ä¸‹ï¼Œåœ¨ç¬¬ k ä¸ªä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ çš„æ—¶é—´å¤æ‚åº¦å°±ä¼šé™ä¸º O(1)ã€‚</p><ul><li>åˆ é™¤æ“ä½œ</li></ul><p>è·Ÿæ’å…¥æ•°æ®ç±»ä¼¼ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ é™¤ç¬¬ k ä¸ªä½ç½®çš„æ•°æ®ï¼Œä¸ºäº†å†…å­˜çš„è¿ç»­æ€§ï¼Œä¹Ÿéœ€è¦æ¬ç§»æ•°æ®ï¼Œä¸ç„¶ä¸­é—´å°±ä¼šå‡ºç°ç©ºæ´ï¼Œå†…å­˜å°±ä¸è¿ç»­äº†ã€‚</p><p>å’Œæ’å…¥ç±»ä¼¼ï¼Œå¦‚æœåˆ é™¤æ•°ç»„æœ«å°¾çš„æ•°æ®ï¼Œåˆ™æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼›å¦‚æœåˆ é™¤å¼€å¤´çš„æ•°æ®ï¼Œåˆ™æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼›å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦ä¹Ÿä¸º O(n)ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ•°ç»„ a[10]ä¸­å­˜å‚¨äº† 8 ä¸ªå…ƒç´ ï¼šaï¼Œbï¼Œcï¼Œdï¼Œeï¼Œfï¼Œgï¼Œhã€‚ç°åœ¨ï¼Œæˆ‘ä»¬è¦ä¾æ¬¡åˆ é™¤ aï¼Œbï¼Œc ä¸‰ä¸ªå…ƒç´ ã€‚</p><img src="https://static001.geekbang.org/resource/image/b6/e5/b69b8c5dbf6248649ddab7d3e7cfd7e5.jpg"><p>ä¸ºäº†é¿å… dï¼Œeï¼Œfï¼Œgï¼Œh è¿™å‡ ä¸ªæ•°æ®ä¼šè¢«æ¬ç§»ä¸‰æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè®°å½•ä¸‹å·²ç»åˆ é™¤çš„æ•°æ®ã€‚æ¯æ¬¡çš„åˆ é™¤æ“ä½œå¹¶ä¸æ˜¯çœŸæ­£åœ°æ¬ç§»æ•°æ®ï¼Œåªæ˜¯è®°å½•æ•°æ®å·²ç»è¢«åˆ é™¤ã€‚å½“æ•°ç»„æ²¡æœ‰æ›´å¤šç©ºé—´å­˜å‚¨æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å†è§¦å‘æ‰§è¡Œä¸€æ¬¡çœŸæ­£çš„åˆ é™¤æ“ä½œï¼Œè¿™æ ·å°±å¤§å¤§å‡å°‘äº†åˆ é™¤æ“ä½œå¯¼è‡´çš„æ•°æ®æ¬ç§»ã€‚</p><h3 id="è­¦æƒ•æ•°ç»„çš„è®¿é—®è¶Šç•Œé—®é¢˜"><a href="#è­¦æƒ•æ•°ç»„çš„è®¿é—®è¶Šç•Œé—®é¢˜" class="headerlink" title="è­¦æƒ•æ•°ç»„çš„è®¿é—®è¶Šç•Œé—®é¢˜"></a>è­¦æƒ•æ•°ç»„çš„è®¿é—®è¶Šç•Œé—®é¢˜</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span>&#123;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> arr[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-keyword">for</span>(; i&lt;=<span class="hljs-number">3</span>; i++)&#123;<br>        arr[i] = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„è¿è¡Œç»“æœå¹¶éæ˜¯æ‰“å°ä¸‰è¡Œâ€œhello wordâ€ï¼Œè€Œæ˜¯ä¼šæ— é™æ‰“å°â€œhello worldâ€ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å› ä¸ºï¼Œæ•°ç»„å¤§å°ä¸º 3ï¼Œa[0]ï¼Œa[1]ï¼Œa[2]ï¼Œè€Œæˆ‘ä»¬çš„ä»£ç å› ä¸ºä¹¦å†™é”™è¯¯ï¼Œå¯¼è‡´ for å¾ªç¯çš„ç»“æŸæ¡ä»¶é”™å†™ä¸ºäº† i&lt;=3 è€Œé i&lt;3ï¼Œæ‰€ä»¥å½“ i=3 æ—¶ï¼Œæ•°ç»„ a[3]è®¿é—®è¶Šç•Œã€‚</p><p>åœ¨ C è¯­è¨€ä¸­ï¼Œåªè¦ä¸æ˜¯è®¿é—®å—é™çš„å†…å­˜ï¼Œæ‰€æœ‰çš„å†…å­˜ç©ºé—´éƒ½æ˜¯å¯ä»¥è‡ªç”±è®¿é—®çš„ã€‚æ ¹æ®æˆ‘ä»¬å‰é¢è®²çš„æ•°ç»„å¯»å€å…¬å¼ï¼Œa[3]ä¹Ÿä¼šè¢«å®šä½åˆ°æŸå—ä¸å±äºæ•°ç»„çš„å†…å­˜åœ°å€ä¸Šï¼Œè€Œè¿™ä¸ªåœ°å€æ­£å¥½æ˜¯å­˜å‚¨å˜é‡ i çš„å†…å­˜åœ°å€ï¼Œé‚£ä¹ˆ a[3]=0 å°±ç›¸å½“äº i=0ï¼Œæ‰€ä»¥å°±ä¼šå¯¼è‡´ä»£ç æ— é™å¾ªç¯ã€‚</p><h3 id="å®¹å™¨èƒ½å¦å®Œå…¨æ›¿ä»£æ•°ç»„ï¼Ÿ"><a href="#å®¹å™¨èƒ½å¦å®Œå…¨æ›¿ä»£æ•°ç»„ï¼Ÿ" class="headerlink" title="å®¹å™¨èƒ½å¦å®Œå…¨æ›¿ä»£æ•°ç»„ï¼Ÿ"></a>å®¹å™¨èƒ½å¦å®Œå…¨æ›¿ä»£æ•°ç»„ï¼Ÿ</h3><p>æ•°ç»„æœ¬èº«åœ¨å®šä¹‰çš„æ—¶å€™éœ€è¦é¢„å…ˆæŒ‡å®šå¤§å°ï¼Œå› ä¸ºéœ€è¦åˆ†é…è¿ç»­çš„å†…å­˜ç©ºé—´ã€‚å¦‚æœæˆ‘ä»¬ç”³è¯·äº†å¤§å°ä¸º 10 çš„æ•°ç»„ï¼Œå½“ç¬¬ 11 ä¸ªæ•°æ®éœ€è¦å­˜å‚¨åˆ°æ•°ç»„ä¸­æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦é‡æ–°åˆ†é…ä¸€å—æ›´å¤§çš„ç©ºé—´ï¼Œå°†åŸæ¥çš„æ•°æ®å¤åˆ¶è¿‡å»ï¼Œç„¶åå†å°†æ–°çš„æ•°æ®æ’å…¥ã€‚</p><p>å¦‚æœä½¿ç”¨ ArrayListï¼Œæˆ‘ä»¬å°±å®Œå…¨ä¸éœ€è¦å…³å¿ƒåº•å±‚çš„æ‰©å®¹é€»è¾‘ï¼ŒArrayList å·²ç»å¸®æˆ‘ä»¬å®ç°å¥½äº†ã€‚æ¯æ¬¡å­˜å‚¨ç©ºé—´ä¸å¤Ÿçš„æ—¶å€™ï¼Œå®ƒéƒ½ä¼šå°†ç©ºé—´è‡ªåŠ¨æ‰©å®¹ä¸º 1.5 å€å¤§å°ã€‚</p><p>ä¸è¿‡ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œå› ä¸ºæ‰©å®¹æ“ä½œæ¶‰åŠå†…å­˜ç”³è¯·å’Œæ•°æ®æ¬ç§»ï¼Œæ˜¯æ¯”è¾ƒè€—æ—¶çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœäº‹å…ˆèƒ½ç¡®å®šéœ€è¦å­˜å‚¨çš„æ•°æ®å¤§å°ï¼Œæœ€å¥½åœ¨åˆ›å»º ArrayList çš„æ—¶å€™äº‹å…ˆæŒ‡å®šæ•°æ®å¤§å°ã€‚</p><h3 id="æ•°ç»„çš„ä½¿ç”¨"><a href="#æ•°ç»„çš„ä½¿ç”¨" class="headerlink" title="æ•°ç»„çš„ä½¿ç”¨"></a>æ•°ç»„çš„ä½¿ç”¨</h3><ul><li><p>Java ArrayList æ— æ³•å­˜å‚¨åŸºæœ¬ç±»å‹ï¼Œæ¯”å¦‚ intã€longï¼Œéœ€è¦å°è£…ä¸º Integerã€Long ç±»ï¼Œè€Œ Autoboxingã€Unboxing åˆ™æœ‰ä¸€å®šçš„æ€§èƒ½æ¶ˆè€—ï¼Œæ‰€ä»¥å¦‚æœç‰¹åˆ«å…³æ³¨æ€§èƒ½ï¼Œæˆ–è€…å¸Œæœ›ä½¿ç”¨åŸºæœ¬ç±»å‹ï¼Œå°±å¯ä»¥é€‰ç”¨æ•°ç»„ã€‚</p></li><li><p>å¦‚æœæ•°æ®å¤§å°äº‹å…ˆå·²çŸ¥ï¼Œå¹¶ä¸”å¯¹æ•°æ®çš„æ“ä½œéå¸¸ç®€å•ï¼Œç”¨ä¸åˆ° ArrayList æä¾›çš„å¤§éƒ¨åˆ†æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æ•°ç»„ã€‚</p></li><li><p>è¿˜æœ‰ä¸€ä¸ªæ˜¯æˆ‘ä¸ªäººçš„å–œå¥½ï¼Œå½“è¦è¡¨ç¤ºå¤šç»´æ•°ç»„æ—¶ï¼Œç”¨æ•°ç»„å¾€å¾€ä¼šæ›´åŠ ç›´è§‚ã€‚æ¯”å¦‚ Object[][] arrayï¼›è€Œç”¨å®¹å™¨çš„è¯åˆ™éœ€è¦è¿™æ ·å®šä¹‰ï¼šArrayList &gt; arrayã€‚</p></li></ul><h3 id="ä¸ºä»€ä¹ˆæ•°ç»„è¦ä»-0-å¼€å§‹ç¼–å·è€Œä¸æ˜¯-1-ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæ•°ç»„è¦ä»-0-å¼€å§‹ç¼–å·è€Œä¸æ˜¯-1-ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæ•°ç»„è¦ä» 0 å¼€å§‹ç¼–å·è€Œä¸æ˜¯ 1 ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæ•°ç»„è¦ä» 0 å¼€å§‹ç¼–å·è€Œä¸æ˜¯ 1 ï¼Ÿ</h3><p>ä»æ•°ç»„å­˜å‚¨çš„å†…å­˜æ¨¡å‹ä¸Šæ¥çœ‹ï¼Œâ€œä¸‹æ ‡â€æœ€ç¡®åˆ‡çš„å®šä¹‰åº”è¯¥æ˜¯â€œåç§»ï¼ˆoffsetï¼‰â€ã€‚å‰é¢ä¹Ÿè®²åˆ°ï¼Œå¦‚æœç”¨ a æ¥è¡¨ç¤ºæ•°ç»„çš„é¦–åœ°å€ï¼Œa[0]å°±æ˜¯åç§»ä¸º 0 çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯é¦–åœ°å€ï¼Œa[k]å°±è¡¨ç¤ºåç§» k ä¸ª type_size çš„ä½ç½®ï¼Œæ‰€ä»¥è®¡ç®— a[k]çš„å†…å­˜åœ°å€åªéœ€è¦ç”¨è¿™ä¸ªå…¬å¼ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">a[k]_address = base_address + k * type_size<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå¦‚æœæ•°ç»„ä» 1 å¼€å§‹è®¡æ•°ï¼Œé‚£æˆ‘ä»¬è®¡ç®—æ•°ç»„å…ƒç´  a[k]çš„å†…å­˜åœ°å€å°±ä¼šå˜ä¸ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">a[k]_address = base_address + (k<span class="hljs-number">-1</span>)*type_size<br></code></pre></td></tr></table></figure><p>å¯¹æ¯”ä¸¤ä¸ªå…¬å¼ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œä» 1 å¼€å§‹ç¼–å·ï¼Œæ¯æ¬¡éšæœºè®¿é—®æ•°ç»„å…ƒç´ éƒ½å¤šäº†ä¸€æ¬¡å‡æ³•è¿ç®—ï¼Œå¯¹äº CPU æ¥è¯´ï¼Œå°±æ˜¯å¤šäº†ä¸€æ¬¡å‡æ³•æŒ‡ä»¤ã€‚</p><p>æ•°ç»„ä½œä¸ºéå¸¸åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡ä¸‹æ ‡éšæœºè®¿é—®æ•°ç»„å…ƒç´ åˆæ˜¯å…¶éå¸¸åŸºç¡€çš„ç¼–ç¨‹æ“ä½œï¼Œæ•ˆç‡çš„ä¼˜åŒ–å°±è¦å°½å¯èƒ½åšåˆ°æè‡´ã€‚æ‰€ä»¥ä¸ºäº†å‡å°‘ä¸€æ¬¡å‡æ³•æ“ä½œï¼Œæ•°ç»„é€‰æ‹©äº†ä» 0 å¼€å§‹ç¼–å·ï¼Œè€Œä¸æ˜¯ä» 1 å¼€å§‹ã€‚</p><p>ä¸Šé¢è§£é‡Šå¾—å†å¤šå…¶å®éƒ½ç®—ä¸ä¸Šå‹å€’æ€§çš„è¯æ˜ï¼Œè¯´æ•°ç»„èµ·å§‹ç¼–å·é 0 å¼€å§‹ä¸å¯ã€‚æ‰€ä»¥æˆ‘è§‰å¾—æœ€ä¸»è¦çš„åŸå› å¯èƒ½æ˜¯å†å²åŸå› ã€‚</p><p>C è¯­è¨€è®¾è®¡è€…ç”¨ 0 å¼€å§‹è®¡æ•°æ•°ç»„ä¸‹æ ‡ï¼Œä¹‹åçš„ Javaã€JavaScript ç­‰é«˜çº§è¯­è¨€éƒ½æ•ˆä»¿äº† C è¯­è¨€ï¼Œæˆ–è€…è¯´ï¼Œä¸ºäº†åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘ C è¯­è¨€ç¨‹åºå‘˜å­¦ä¹  Java çš„å­¦ä¹ æˆæœ¬ï¼Œå› æ­¤ç»§ç»­æ²¿ç”¨äº†ä» 0 å¼€å§‹è®¡æ•°çš„ä¹ æƒ¯ã€‚å®é™…ä¸Šï¼Œå¾ˆå¤šè¯­è¨€ä¸­æ•°ç»„ä¹Ÿå¹¶ä¸æ˜¯ä» 0 å¼€å§‹è®¡æ•°çš„ï¼Œæ¯”å¦‚ Matlabã€‚ç”šè‡³è¿˜æœ‰ä¸€äº›è¯­è¨€æ”¯æŒè´Ÿæ•°ä¸‹æ ‡ï¼Œæ¯”å¦‚ Pythonã€‚</p><p>è½¬è‡ªã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‡æ‘Šæ—¶é—´å¤æ‚åº¦</title>
    <link href="/2021/07/05/amortized-time-complexity/"/>
    <url>/2021/07/05/amortized-time-complexity/</url>
    
    <content type="html"><![CDATA[<h2 id="å‡æ‘Šæ—¶é—´å¤æ‚åº¦"><a href="#å‡æ‘Šæ—¶é—´å¤æ‚åº¦" class="headerlink" title="å‡æ‘Šæ—¶é—´å¤æ‚åº¦"></a>å‡æ‘Šæ—¶é—´å¤æ‚åº¦</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// arrayè¡¨ç¤ºä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„</span><br><span class="hljs-comment">// ä»£ç ä¸­çš„array.lengthå°±ç­‰äºn</span><br><span class="hljs-keyword">int</span>[] <span class="hljs-built_in">array</span> = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n];<br><span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;<br>   <span class="hljs-keyword">if</span> (count == <span class="hljs-built_in">array</span>.length) &#123;<br>      <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">array</span>.length; ++i) &#123;<br>         sum = sum + <span class="hljs-built_in">array</span>[i];<br>      &#125;<br>      <span class="hljs-built_in">array</span>[<span class="hljs-number">0</span>] = sum;<br>      count = <span class="hljs-number">1</span>;<br>   &#125;<br><br>   <span class="hljs-built_in">array</span>[count] = val;<br>   ++count;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªå¾€æ•°ç»„ä¸­æ’å…¥æ•°æ®çš„åŠŸèƒ½ã€‚å½“æ•°ç»„æ»¡äº†ä¹‹åï¼Œä¹Ÿå°±æ˜¯ä»£ç ä¸­çš„ count == array.length æ—¶ï¼Œæˆ‘ä»¬ç”¨ for å¾ªç¯éå†æ•°ç»„æ±‚å’Œï¼Œå¹¶æ¸…ç©ºæ•°ç»„ï¼Œå°†æ±‚å’Œä¹‹åçš„ sum å€¼æ”¾åˆ°æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œç„¶åå†å°†æ–°çš„æ•°æ®æ’å…¥ã€‚ä½†å¦‚æœæ•°ç»„ä¸€å¼€å§‹å°±æœ‰ç©ºé—²ç©ºé—´ï¼Œåˆ™ç›´æ¥å°†æ•°æ®æ’å…¥æ•°ç»„ã€‚</p><p>æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæ•°ç»„ä¸­æœ‰ç©ºé—²ç©ºé—´ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ•°æ®æ’å…¥åˆ°æ•°ç»„ä¸‹æ ‡ä¸º count çš„ä½ç½®å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚æœ€åçš„æƒ…å†µä¸‹ï¼Œæ•°ç»„ä¸­æ²¡æœ‰ç©ºé—²ç©ºé—´äº†ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåšä¸€æ¬¡æ•°ç»„çš„éå†æ±‚å’Œï¼Œç„¶åå†å°†æ•°æ®æ’å…¥ï¼Œæ‰€ä»¥æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚</p><p>é‚£å¹³å‡æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ O(1)ã€‚æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡å‰é¢è®²çš„æ¦‚ç‡è®ºçš„æ–¹æ³•æ¥åˆ†æã€‚</p><p>å‡è®¾æ•°ç»„çš„é•¿åº¦æ˜¯ nï¼Œæ ¹æ®æ•°æ®æ’å…¥çš„ä½ç½®çš„ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ä¸º n ç§æƒ…å†µï¼Œæ¯ç§æƒ…å†µçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§â€œé¢å¤–â€çš„æƒ…å†µï¼Œå°±æ˜¯åœ¨æ•°ç»„æ²¡æœ‰ç©ºé—²ç©ºé—´æ—¶æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚è€Œä¸”ï¼Œè¿™ n+1 ç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡ä¸€æ ·ï¼Œéƒ½æ˜¯ 1/(n+1)ã€‚æ‰€ä»¥ï¼Œæ ¹æ®åŠ æƒå¹³å‡çš„è®¡ç®—æ–¹æ³•ï¼Œæˆ‘ä»¬æ±‚å¾—çš„å¹³å‡æ—¶é—´å¤æ‚åº¦å°±æ˜¯ï¼š</p><img src="https://static001.geekbang.org/resource/image/6d/ed/6df62366a60336d9de3bc34f488d8bed.jpg"/><h3 id="æ‘Šè¿˜åˆ†ææ³•"><a href="#æ‘Šè¿˜åˆ†ææ³•" class="headerlink" title="æ‘Šè¿˜åˆ†ææ³•"></a>æ‘Šè¿˜åˆ†ææ³•</h3><p>find() å‡½æ•°åœ¨æç«¯æƒ…å†µä¸‹ï¼Œå¤æ‚åº¦æ‰ä¸º O(1)ã€‚ä½† insert() åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½ä¸º O(1)ã€‚åªæœ‰ä¸ªåˆ«æƒ…å†µä¸‹ï¼Œå¤æ‚åº¦æ‰æ¯”è¾ƒé«˜ï¼Œä¸º O(n)ã€‚è¿™æ˜¯ insert()ç¬¬ä¸€ä¸ªåŒºåˆ«äº find() çš„åœ°æ–¹ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹ç¬¬äºŒä¸ªä¸åŒçš„åœ°æ–¹ã€‚å¯¹äº insert() å‡½æ•°æ¥è¯´ï¼ŒO(1) æ—¶é—´å¤æ‚åº¦çš„æ’å…¥å’Œ O(n) æ—¶é—´å¤æ‚åº¦çš„æ’å…¥ï¼Œå‡ºç°çš„é¢‘ç‡æ˜¯éå¸¸æœ‰è§„å¾‹çš„ï¼Œè€Œä¸”æœ‰ä¸€å®šçš„å‰åæ—¶åºå…³ç³»ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ª O(n) æ’å…¥ä¹‹åï¼Œç´§è·Ÿç€ n-1 ä¸ª O(1) çš„æ’å…¥æ“ä½œï¼Œå¾ªç¯å¾€å¤ã€‚</p><p>æ‰€ä»¥ï¼Œé’ˆå¯¹è¿™æ ·ä¸€ç§ç‰¹æ®Šåœºæ™¯çš„å¤æ‚åº¦åˆ†æï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦åƒä¹‹å‰è®²å¹³å‡å¤æ‚åº¦åˆ†ææ–¹æ³•é‚£æ ·ï¼Œæ‰¾å‡ºæ‰€æœ‰çš„è¾“å…¥æƒ…å†µåŠç›¸åº”çš„å‘ç”Ÿæ¦‚ç‡ï¼Œç„¶åå†è®¡ç®—åŠ æƒå¹³å‡å€¼ã€‚</p><p>é’ˆå¯¹è¿™ç§ç‰¹æ®Šçš„åœºæ™¯ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§æ›´åŠ ç®€å•çš„åˆ†ææ–¹æ³•ï¼šæ‘Šè¿˜åˆ†ææ³•ï¼Œé€šè¿‡æ‘Šè¿˜åˆ†æå¾—åˆ°çš„æ—¶é—´å¤æ‚åº¦æˆ‘ä»¬èµ·äº†ä¸€ä¸ªåå­—ï¼Œå«å‡æ‘Šæ—¶é—´å¤æ‚åº¦ã€‚</p><p>é‚£ç©¶ç«Ÿå¦‚ä½•ä½¿ç”¨æ‘Šè¿˜åˆ†ææ³•æ¥åˆ†æç®—æ³•çš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬è¿˜æ˜¯ç»§ç»­çœ‹åœ¨æ•°ç»„ä¸­æ’å…¥æ•°æ®çš„è¿™ä¸ªä¾‹å­ã€‚æ¯ä¸€æ¬¡ O(n) çš„æ’å…¥æ“ä½œï¼Œéƒ½ä¼šè·Ÿç€ n-1 æ¬¡ O(1) çš„æ’å…¥æ“ä½œï¼Œæ‰€ä»¥æŠŠè€—æ—¶å¤šçš„é‚£æ¬¡æ“ä½œå‡æ‘Šåˆ°æ¥ä¸‹æ¥çš„ n-1 æ¬¡è€—æ—¶å°‘çš„æ“ä½œä¸Šï¼Œå‡æ‘Šä¸‹æ¥ï¼Œè¿™ä¸€ç»„è¿ç»­çš„æ“ä½œçš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(1)ã€‚è¿™å°±æ˜¯å‡æ‘Šåˆ†æçš„å¤§è‡´æ€è·¯ã€‚</p><p>å‡æ‘Šæ—¶é—´å¤æ‚åº¦å’Œæ‘Šè¿˜åˆ†æåº”ç”¨åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶ä¸ä¼šç»å¸¸ç”¨åˆ°ã€‚ä¸ºäº†æ–¹ä¾¿ä½ ç†è§£ã€è®°å¿†ï¼Œæˆ‘è¿™é‡Œç®€å•æ€»ç»“ä¸€ä¸‹å®ƒä»¬çš„åº”ç”¨åœºæ™¯ã€‚å¦‚æœä½ é‡åˆ°äº†ï¼ŒçŸ¥é“æ˜¯æ€ä¹ˆå›äº‹å„¿å°±è¡Œäº†ã€‚</p><p>å¯¹ä¸€ä¸ªæ•°æ®ç»“æ„è¿›è¡Œä¸€ç»„è¿ç»­æ“ä½œä¸­ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦éƒ½å¾ˆä½ï¼Œåªæœ‰ä¸ªåˆ«æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œè€Œä¸”è¿™äº›æ“ä½œä¹‹é—´å­˜åœ¨å‰åè¿è´¯çš„æ—¶åºå…³ç³»ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™ä¸€ç»„æ“ä½œæ”¾åœ¨ä¸€å—å„¿åˆ†æï¼Œçœ‹æ˜¯å¦èƒ½å°†è¾ƒé«˜æ—¶é—´å¤æ‚åº¦é‚£æ¬¡æ“ä½œçš„è€—æ—¶ï¼Œå¹³æ‘Šåˆ°å…¶ä»–é‚£äº›æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒä½çš„æ“ä½œä¸Šã€‚è€Œä¸”ï¼Œåœ¨èƒ½å¤Ÿåº”ç”¨å‡æ‘Šæ—¶é—´å¤æ‚åº¦åˆ†æçš„åœºåˆï¼Œä¸€èˆ¬å‡æ‘Šæ—¶é—´å¤æ‚åº¦å°±ç­‰äºæœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦ã€‚</p><p>å°½ç®¡å¾ˆå¤šæ•°æ®ç»“æ„å’Œç®—æ³•ä¹¦ç±éƒ½èŠ±äº†å¾ˆå¤§åŠ›æ°”æ¥åŒºåˆ†å¹³å‡æ—¶é—´å¤æ‚åº¦å’Œå‡æ‘Šæ—¶é—´å¤æ‚åº¦ï¼Œä½†å…¶å®æˆ‘ä¸ªäººè®¤ä¸ºï¼Œå‡æ‘Šæ—¶é—´å¤æ‚åº¦å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬æ²¡å¿…è¦èŠ±å¤ªå¤šç²¾åŠ›å»åŒºåˆ†å®ƒä»¬ã€‚ä½ æœ€åº”è¯¥æŒæ¡çš„æ˜¯å®ƒçš„åˆ†ææ–¹æ³•ï¼Œæ‘Šè¿˜åˆ†æã€‚è‡³äºåˆ†æå‡ºæ¥çš„ç»“æœæ˜¯å«å¹³å‡è¿˜æ˜¯å«å‡æ‘Šï¼Œè¿™åªæ˜¯ä¸ªè¯´æ³•ï¼Œå¹¶ä¸é‡è¦ã€‚</p><p>è½¬è‡ªã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æœ€å¥½ã€æœ€åã€å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦</title>
    <link href="/2021/07/05/some-time-complexity/"/>
    <url>/2021/07/05/some-time-complexity/</url>
    
    <content type="html"><![CDATA[<h2 id="æœ€å¥½ã€æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦"><a href="#æœ€å¥½ã€æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦" class="headerlink" title="æœ€å¥½ã€æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦"></a>æœ€å¥½ã€æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// nè¡¨ç¤ºæ•°ç»„arrayçš„é•¿åº¦</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] <span class="hljs-built_in">array</span>, <span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>  <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">int</span> pos = <span class="hljs-number">-1</span>;<br>  <span class="hljs-keyword">for</span> (; i &lt; n; ++i) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">array</span>[i] == x) pos = i;<br>  &#125;<br>  <span class="hljs-keyword">return</span> pos;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç è¦å®ç°çš„åŠŸèƒ½æ˜¯ï¼Œåœ¨ä¸€ä¸ªæ— åºçš„æ•°ç»„ï¼ˆarrayï¼‰ä¸­ï¼ŒæŸ¥æ‰¾å˜é‡ x å‡ºç°çš„ä½ç½®ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±è¿”å› -1ã€‚æŒ‰ç…§ä¸ŠèŠ‚è¯¾è®²çš„åˆ†ææ–¹æ³•ï¼Œè¿™æ®µä»£ç çš„å¤æ‚åº¦æ˜¯ $O(n)$ï¼Œå…¶ä¸­ï¼Œn ä»£è¡¨æ•°ç»„çš„é•¿åº¦ã€‚</p><p>æˆ‘ä»¬åœ¨æ•°ç»„ä¸­æŸ¥æ‰¾ä¸€ä¸ªæ•°æ®ï¼Œå¹¶ä¸éœ€è¦æ¯æ¬¡éƒ½æŠŠæ•´ä¸ªæ•°ç»„éƒ½éå†ä¸€éï¼Œå› ä¸ºæœ‰å¯èƒ½ä¸­é€”æ‰¾åˆ°å°±å¯ä»¥æå‰ç»“æŸå¾ªç¯äº†ã€‚ä½†æ˜¯ï¼Œè¿™æ®µä»£ç å†™å¾—ä¸å¤Ÿé«˜æ•ˆã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä¼˜åŒ–ä¸€ä¸‹è¿™æ®µæŸ¥æ‰¾ä»£ç ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// nè¡¨ç¤ºæ•°ç»„arrayçš„é•¿åº¦</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] <span class="hljs-built_in">array</span>, <span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>  <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">int</span> pos = <span class="hljs-number">-1</span>;<br>  <span class="hljs-keyword">for</span> (; i &lt; n; ++i) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">array</span>[i] == x) &#123;<br>       pos = i;<br>       <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> pos;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™ï¼Œé—®é¢˜å°±æ¥äº†ã€‚æˆ‘ä»¬ä¼˜åŒ–å®Œä¹‹åï¼Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯ O(n) å—ï¼Ÿ</p><p>è¦æŸ¥æ‰¾çš„å˜é‡ x å¯èƒ½å‡ºç°åœ¨æ•°ç»„çš„ä»»æ„ä½ç½®ã€‚å¦‚æœæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ­£å¥½æ˜¯è¦æŸ¥æ‰¾çš„å˜é‡ xï¼Œé‚£å°±ä¸éœ€è¦ç»§ç»­éå†å‰©ä¸‹çš„ n-1 ä¸ªæ•°æ®äº†ï¼Œé‚£æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(1)ã€‚ä½†å¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨å˜é‡ xï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æŠŠæ•´ä¸ªæ•°ç»„éƒ½éå†ä¸€éï¼Œæ—¶é—´å¤æ‚åº¦å°±æˆäº† O(n)ã€‚æ‰€ä»¥ï¼Œä¸åŒçš„æƒ…å†µä¸‹ï¼Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>ä¸ºäº†è¡¨ç¤ºä»£ç åœ¨ä¸åŒæƒ…å†µä¸‹çš„ä¸åŒæ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸‰ä¸ªæ¦‚å¿µï¼šæœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦ã€æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦å’Œå¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦ã€‚</p><h3 id="æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦"><a href="#æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦" class="headerlink" title="æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦"></a>æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦</h3><p>åœ¨æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦ã€‚å°±åƒæˆ‘ä»¬åˆšåˆšè®²åˆ°çš„ï¼Œåœ¨æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œè¦æŸ¥æ‰¾çš„å˜é‡ x æ­£å¥½æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªæ—¶å€™å¯¹åº”çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦ã€‚</p><h3 id="æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦"><a href="#æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦" class="headerlink" title="æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦"></a>æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦</h3><p>åœ¨æœ€ç³Ÿç³•çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦ã€‚å°±åƒåˆšä¸¾çš„é‚£ä¸ªä¾‹å­ï¼Œå¦‚æœæ•°ç»„ä¸­æ²¡æœ‰è¦æŸ¥æ‰¾çš„å˜é‡ xï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ•´ä¸ªæ•°ç»„éƒ½éå†ä¸€éæ‰è¡Œï¼Œæ‰€ä»¥è¿™ç§æœ€ç³Ÿç³•æƒ…å†µä¸‹å¯¹åº”çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦ã€‚</p><h3 id="å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦"><a href="#å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦" class="headerlink" title="å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦"></a>å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦</h3><p>å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦å’Œæœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦å¯¹åº”çš„éƒ½æ˜¯æç«¯æƒ…å†µä¸‹çš„ä»£ç å¤æ‚åº¦ï¼Œå‘ç”Ÿçš„æ¦‚ç‡å…¶å®å¹¶ä¸å¤§ã€‚ä¸ºäº†æ›´å¥½åœ°è¡¨ç¤ºå¹³å‡æƒ…å†µä¸‹çš„å¤æ‚åº¦ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥å¦ä¸€ä¸ªæ¦‚å¿µï¼šå¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦ï¼Œåé¢ç®€ç§°ä¸ºå¹³å‡æ—¶é—´å¤æ‚åº¦ã€‚</p><p>è¦æŸ¥æ‰¾çš„å˜é‡ x åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œæœ‰ n+1 ç§æƒ…å†µï¼šåœ¨æ•°ç»„çš„ 0ï½n-1 ä½ç½®ä¸­å’Œä¸åœ¨æ•°ç»„ä¸­ã€‚æˆ‘ä»¬æŠŠæ¯ç§æƒ…å†µä¸‹ï¼ŒæŸ¥æ‰¾éœ€è¦éå†çš„å…ƒç´ ä¸ªæ•°ç´¯åŠ èµ·æ¥ï¼Œç„¶åå†é™¤ä»¥ n+1ï¼Œå°±å¯ä»¥å¾—åˆ°éœ€è¦éå†çš„å…ƒç´ ä¸ªæ•°çš„å¹³å‡å€¼ï¼Œå³ï¼š</p><img src="https://static001.geekbang.org/resource/image/d8/2f/d889a358b8eccc5bbb90fc16e327a22f.jpg"/><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ—¶é—´å¤æ‚åº¦çš„å¤§ O æ ‡è®°æ³•ä¸­ï¼Œå¯ä»¥çœç•¥æ‰ç³»æ•°ã€ä½é˜¶ã€å¸¸é‡ï¼Œæ‰€ä»¥ï¼Œå’±ä»¬æŠŠåˆšåˆšè¿™ä¸ªå…¬å¼ç®€åŒ–ä¹‹åï¼Œå¾—åˆ°çš„å¹³å‡æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(n)ã€‚</p><p>è¿™ä¸ªç»“è®ºè™½ç„¶æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯è®¡ç®—è¿‡ç¨‹ç¨å¾®æœ‰ç‚¹å„¿é—®é¢˜ã€‚ç©¶ç«Ÿæ˜¯ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬åˆšè®²çš„è¿™ n+1 ç§æƒ…å†µï¼Œå‡ºç°çš„æ¦‚ç‡å¹¶ä¸æ˜¯ä¸€æ ·çš„ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œè¦æŸ¥æ‰¾çš„å˜é‡ xï¼Œè¦ä¹ˆåœ¨æ•°ç»„é‡Œï¼Œè¦ä¹ˆå°±ä¸åœ¨æ•°ç»„é‡Œã€‚è¿™ä¸¤ç§æƒ…å†µå¯¹åº”çš„æ¦‚ç‡ç»Ÿè®¡èµ·æ¥å¾ˆéº»çƒ¦ï¼Œä¸ºäº†æ–¹ä¾¿ä½ ç†è§£ï¼Œæˆ‘ä»¬å‡è®¾åœ¨æ•°ç»„ä¸­ä¸ä¸åœ¨æ•°ç»„ä¸­çš„æ¦‚ç‡éƒ½ä¸º 1/2ã€‚å¦å¤–ï¼Œè¦æŸ¥æ‰¾çš„æ•°æ®å‡ºç°åœ¨ 0ï½n-1 è¿™ n ä¸ªä½ç½®çš„æ¦‚ç‡ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¸º 1/nã€‚æ‰€ä»¥ï¼Œæ ¹æ®æ¦‚ç‡ä¹˜æ³•æ³•åˆ™ï¼Œè¦æŸ¥æ‰¾çš„æ•°æ®å‡ºç°åœ¨ 0ï½n-1 ä¸­ä»»æ„ä½ç½®çš„æ¦‚ç‡å°±æ˜¯ 1/(2n)ã€‚</p><p>å› æ­¤ï¼Œå‰é¢çš„æ¨å¯¼è¿‡ç¨‹ä¸­å­˜åœ¨çš„æœ€å¤§é—®é¢˜å°±æ˜¯ï¼Œæ²¡æœ‰å°†å„ç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡è€ƒè™‘è¿›å»ã€‚å¦‚æœæˆ‘ä»¬æŠŠæ¯ç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡ä¹Ÿè€ƒè™‘è¿›å»ï¼Œé‚£å¹³å‡æ—¶é—´å¤æ‚åº¦çš„è®¡ç®—è¿‡ç¨‹å°±å˜æˆäº†è¿™æ ·ï¼š</p><img src="https://static001.geekbang.org/resource/image/36/7f/36c0aabdac69032f8a43368f5e90c67f.jpg"/><p>è¿™ä¸ªå€¼å°±æ˜¯æ¦‚ç‡è®ºä¸­çš„åŠ æƒå¹³å‡å€¼ï¼Œä¹Ÿå«ä½œæœŸæœ›å€¼ï¼Œæ‰€ä»¥å¹³å‡æ—¶é—´å¤æ‚åº¦çš„å…¨ç§°åº”è¯¥å«åŠ æƒå¹³å‡æ—¶é—´å¤æ‚åº¦æˆ–è€…æœŸæœ›æ—¶é—´å¤æ‚åº¦ã€‚</p><p>å¼•å…¥æ¦‚ç‡ä¹‹åï¼Œå‰é¢é‚£æ®µä»£ç çš„åŠ æƒå¹³å‡å€¼ä¸º (3n+1)/4ã€‚ç”¨å¤§ O è¡¨ç¤ºæ³•æ¥è¡¨ç¤ºï¼Œå»æ‰ç³»æ•°å’Œå¸¸é‡ï¼Œè¿™æ®µä»£ç çš„åŠ æƒå¹³å‡æ—¶é—´å¤æ‚åº¦ä»ç„¶æ˜¯ O(n)ã€‚</p><p>è½¬è‡ªã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç©ºé—´å¤æ‚åº¦ä»‹ç»</title>
    <link href="/2021/07/05/space-complexity/"/>
    <url>/2021/07/05/space-complexity/</url>
    
    <content type="html"><![CDATA[<h2 id="ç©ºé—´å¤æ‚åº¦"><a href="#ç©ºé—´å¤æ‚åº¦" class="headerlink" title="ç©ºé—´å¤æ‚åº¦"></a>ç©ºé—´å¤æ‚åº¦</h2><p>ç©ºé—´å¤æ‚åº¦è¡¨ç¤ºç®—æ³•çš„å­˜å‚¨ç©ºé—´ä¸æ•°æ®è§„æ¨¡ä¹‹é—´çš„å¢é•¿å…³ç³»ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;<br>  <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">int</span>[] a = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n];<br>  <span class="hljs-keyword">for</span> (i; i &lt;n; ++i) &#123;<br>    a[i] = i * i;<br>  &#125;<br><br>  <span class="hljs-keyword">for</span> (i = n<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i) &#123;<br>    print out a[i]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è·Ÿæ—¶é—´å¤æ‚åº¦åˆ†æä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ 2 è¡Œä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”³è¯·äº†ä¸€ä¸ªç©ºé—´å­˜å‚¨å˜é‡ iï¼Œä½†æ˜¯å®ƒæ˜¯å¸¸é‡é˜¶çš„ï¼Œè·Ÿæ•°æ®è§„æ¨¡ n æ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¿½ç•¥ã€‚ç¬¬ 3 è¡Œç”³è¯·äº†ä¸€ä¸ªå¤§å°ä¸º n çš„ int ç±»å‹æ•°ç»„ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå‰©ä¸‹çš„ä»£ç éƒ½æ²¡æœ‰å ç”¨æ›´å¤šçš„ç©ºé—´ï¼Œæ‰€ä»¥æ•´æ®µä»£ç çš„ç©ºé—´å¤æ‚åº¦å°±æ˜¯ $O(n)$ã€‚</p><p>æˆ‘ä»¬å¸¸è§çš„ç©ºé—´å¤æ‚åº¦å°±æ˜¯ O(1)ã€O(n)ã€O(n2 )ï¼Œåƒ O(logn)ã€O(nlogn) è¿™æ ·çš„å¯¹æ•°é˜¶å¤æ‚åº¦å¹³æ—¶éƒ½ç”¨ä¸åˆ°ã€‚è€Œä¸”ï¼Œç©ºé—´å¤æ‚åº¦åˆ†ææ¯”æ—¶é—´å¤æ‚åº¦åˆ†æè¦ç®€å•å¾ˆå¤šã€‚æ‰€ä»¥ï¼Œå¯¹äºç©ºé—´å¤æ‚åº¦ï¼ŒæŒæ¡åˆšæˆ‘è¯´çš„è¿™äº›å†…å®¹å·²ç»è¶³å¤Ÿäº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ—¶é—´å¤æ‚åº¦ä»‹ç»</title>
    <link href="/2021/07/05/time-complexity/"/>
    <url>/2021/07/05/time-complexity/</url>
    
    <content type="html"><![CDATA[<h2 id="æ—¶é—´å¤æ‚åº¦"><a href="#æ—¶é—´å¤æ‚åº¦" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h2><h3 id="O-1"><a href="#O-1" class="headerlink" title="$O(1)$"></a>$O(1)$</h3><p>é¦–å…ˆä½ å¿…é¡»æ˜ç¡®ä¸€ä¸ªæ¦‚å¿µï¼Œ$O(1)$ åªæ˜¯å¸¸é‡çº§æ—¶é—´å¤æ‚åº¦çš„ä¸€ç§è¡¨ç¤ºæ–¹æ³•ï¼Œå¹¶ä¸æ˜¯æŒ‡åªæ‰§è¡Œäº†ä¸€è¡Œä»£ç ã€‚æ¯”å¦‚è¿™æ®µä»£ç ï¼Œå³ä¾¿æœ‰ 3 è¡Œï¼Œå®ƒçš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ $O(1ï¼‰$ï¼Œè€Œä¸æ˜¯ $O(3)$ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">int</span> i = <span class="hljs-number">8</span>;<br><span class="hljs-keyword">int</span> j = <span class="hljs-number">6</span>; <br><span class="hljs-keyword">int</span> sum = i + j;<br></code></pre></td></tr></table></figure><p>åªè¦ä»£ç çš„æ‰§è¡Œæ—¶é—´ä¸éš n çš„å¢å¤§è€Œå¢é•¿ï¼Œè¿™æ ·ä»£ç çš„æ—¶é—´å¤æ‚åº¦æˆ‘ä»¬éƒ½è®°ä½œ O(1)ã€‚æˆ–è€…è¯´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªè¦ç®—æ³•ä¸­ä¸å­˜åœ¨å¾ªç¯è¯­å¥ã€é€’å½’è¯­å¥ï¼Œå³ä½¿æœ‰æˆåƒä¸Šä¸‡è¡Œçš„ä»£ç ï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ÎŸ(1)ã€‚</p><h3 id="O-logn-ã€-O-nlogn"><a href="#O-logn-ã€-O-nlogn" class="headerlink" title="$O(logn)$ã€$O(nlogn)$"></a>$O(logn)$ã€$O(nlogn)$</h3><p>å¯¹æ•°é˜¶æ—¶é—´å¤æ‚åº¦éå¸¸å¸¸è§ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æœ€éš¾åˆ†æçš„ä¸€ç§æ—¶é—´å¤æ‚åº¦ã€‚æˆ‘é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">i=<span class="hljs-number">1</span>;<br><br><span class="hljs-keyword">while</span> (i &lt;= n)<br>    &#123; <br>        i = i * <span class="hljs-number">2</span>; <br>    &#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®æˆ‘ä»¬å‰é¢è®²çš„å¤æ‚åº¦åˆ†ææ–¹æ³•ï¼Œç¬¬ä¸‰è¡Œä»£ç æ˜¯å¾ªç¯æ‰§è¡Œæ¬¡æ•°æœ€å¤šçš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦èƒ½è®¡ç®—å‡ºè¿™è¡Œä»£ç è¢«æ‰§è¡Œäº†å¤šå°‘æ¬¡ï¼Œå°±èƒ½çŸ¥é“æ•´æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œå˜é‡ i çš„å€¼ä» 1 å¼€å§‹å–ï¼Œæ¯å¾ªç¯ä¸€æ¬¡å°±ä¹˜ä»¥ 2ã€‚å½“å¤§äº n æ—¶ï¼Œå¾ªç¯ç»“æŸã€‚è¿˜è®°å¾—æˆ‘ä»¬é«˜ä¸­å­¦è¿‡çš„ç­‰æ¯”æ•°åˆ—å—ï¼Ÿå®é™…ä¸Šï¼Œå˜é‡ i çš„å–å€¼å°±æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—ã€‚å¦‚æœæˆ‘æŠŠå®ƒä¸€ä¸ªä¸€ä¸ªåˆ—å‡ºæ¥ï¼Œå°±åº”è¯¥æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><img src="https://static001.geekbang.org/resource/image/9b/9a/9b1c88264e7a1a20b5954be9bc4bec9a.jpg"/><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦çŸ¥é“ $x$ å€¼æ˜¯å¤šå°‘ï¼Œå°±çŸ¥é“è¿™è¡Œä»£ç æ‰§è¡Œçš„æ¬¡æ•°äº†ã€‚é€šè¿‡ $2x=n$ æ±‚è§£ $x$ è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æƒ³é«˜ä¸­åº”è¯¥å°±å­¦è¿‡äº†ï¼Œæˆ‘å°±ä¸å¤šè¯´äº†ã€‚$x=log_2n$ï¼Œæ‰€ä»¥ï¼Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(log_2n)$ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘æŠŠä»£ç ç¨å¾®æ”¹ä¸‹ï¼Œä½ å†çœ‹çœ‹ï¼Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">i=<span class="hljs-number">1</span>; <br><span class="hljs-keyword">while</span> (i &lt;= n) <br>    &#123; <br>        i = i * <span class="hljs-number">3</span>; <br>    &#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®æˆ‘åˆšåˆšè®²çš„æ€è·¯ï¼Œå¾ˆç®€å•å°±èƒ½çœ‹å‡ºæ¥ï¼Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(log_3n)$ã€‚</p><p>å®é™…ä¸Šï¼Œä¸ç®¡æ˜¯ä»¥ 2 ä¸ºåº•ã€ä»¥ 3 ä¸ºåº•ï¼Œè¿˜æ˜¯ä»¥ 10 ä¸ºåº•ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰å¯¹æ•°é˜¶çš„æ—¶é—´å¤æ‚åº¦éƒ½è®°ä¸º $O(logn)$ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹æ•°ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è½¬æ¢çš„ï¼Œ$log_3n$ å°±ç­‰äº $log_32 * log_2n$ï¼Œæ‰€ä»¥ $O(log_3n) = O(C * log_2n)$ï¼Œå…¶ä¸­ $C=log_32$ æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚åŸºäºæˆ‘ä»¬å‰é¢çš„ä¸€ä¸ªç†è®ºï¼šåœ¨é‡‡ç”¨å¤§ O æ ‡è®°å¤æ‚åº¦çš„æ—¶å€™ï¼Œå¯ä»¥å¿½ç•¥ç³»æ•°ï¼Œå³ $O(Cf(n)) = O(f(n))$ã€‚æ‰€ä»¥ï¼Œ$O(log_2n)$ å°±ç­‰äº $O(log_3n)$ã€‚å› æ­¤ï¼Œåœ¨å¯¹æ•°é˜¶æ—¶é—´å¤æ‚åº¦çš„è¡¨ç¤ºæ–¹æ³•é‡Œï¼Œæˆ‘ä»¬å¿½ç•¥å¯¹æ•°çš„â€œåº•â€ï¼Œç»Ÿä¸€è¡¨ç¤ºä¸º O(logn)ã€‚</p><p>å¦‚æœä½ ç†è§£äº†æˆ‘å‰é¢è®²çš„ $O(logn)$ï¼Œé‚£ $O(nlogn)$ å°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚è¿˜è®°å¾—æˆ‘ä»¬åˆšè®²çš„ä¹˜æ³•æ³•åˆ™å—ï¼Ÿå¦‚æœä¸€æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(logn)$ï¼Œæˆ‘ä»¬å¾ªç¯æ‰§è¡Œ n éï¼Œæ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(nlogn)$ äº†ã€‚è€Œä¸”ï¼Œ$O(nlogn)$ ä¹Ÿæ˜¯ä¸€ç§éå¸¸å¸¸è§çš„ç®—æ³•æ—¶é—´å¤æ‚åº¦ã€‚æ¯”å¦‚ï¼Œå½’å¹¶æ’åºã€å¿«é€Ÿæ’åºçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(nlogn)$ã€‚</p><h3 id="O-m-n-ã€O-m-n"><a href="#O-m-n-ã€O-m-n" class="headerlink" title="$O(m+n)ã€O(m*n)$"></a>$O(m+n)ã€O(m*n)$</h3><p>æˆ‘ä»¬å†æ¥è®²ä¸€ç§è·Ÿå‰é¢éƒ½ä¸ä¸€æ ·çš„æ—¶é—´å¤æ‚åº¦ï¼Œä»£ç çš„å¤æ‚åº¦ç”±ä¸¤ä¸ªæ•°æ®çš„è§„æ¨¡æ¥å†³å®šã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">cal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> m, <span class="hljs-keyword">int</span> n)</span> </span>&#123;<br>  <span class="hljs-keyword">int</span> sum_1 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">for</span> (; i &lt; m; ++i) &#123;<br>    sum_1 = sum_1 + i;<br>  &#125;<br><br>  <span class="hljs-keyword">int</span> sum_2 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">for</span> (; j &lt; n; ++j) &#123;<br>    sum_2 = sum_2 + j;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> sum_1 + sum_2;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œm å’Œ n æ˜¯è¡¨ç¤ºä¸¤ä¸ªæ•°æ®è§„æ¨¡ã€‚æˆ‘ä»¬æ— æ³•äº‹å…ˆè¯„ä¼° m å’Œ n è°çš„é‡çº§å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¡¨ç¤ºå¤æ‚åº¦çš„æ—¶å€™ï¼Œå°±ä¸èƒ½ç®€å•åœ°åˆ©ç”¨åŠ æ³•æ³•åˆ™ï¼Œçœç•¥æ‰å…¶ä¸­ä¸€ä¸ªã€‚æ‰€ä»¥ï¼Œä¸Šé¢ä»£ç çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(m+n)$ã€‚</p><p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒåŸæ¥çš„åŠ æ³•æ³•åˆ™å°±ä¸æ­£ç¡®äº†ï¼Œæˆ‘ä»¬éœ€è¦å°†åŠ æ³•è§„åˆ™æ”¹ä¸ºï¼š$T1(m) + T2(n) = O(f(m) + g(n))$ã€‚ä½†æ˜¯ä¹˜æ³•æ³•åˆ™ç»§ç»­æœ‰æ•ˆï¼š$T1(m)*T2(n) = O(f(m) * f(n))$ã€‚</p><p>è½¬è‡ªã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>TypeScript è£…é¥°å™¨</title>
    <link href="/2021/07/03/decorators/"/>
    <url>/2021/07/03/decorators/</url>
    
    <content type="html"><![CDATA[<p>è£…é¥°å™¨ æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å£°æ˜ï¼Œå®ƒèƒ½å¤Ÿè¢«é™„åŠ åˆ°ç±»å£°æ˜ï¼Œæ–¹æ³•ï¼Œ è®¿é—®ç¬¦ï¼Œå±æ€§æˆ–å‚æ•°ä¸Šã€‚ è£…é¥°å™¨ä½¿ç”¨ @expressionè¿™ç§å½¢å¼ï¼Œexpressionæ±‚å€¼åå¿…é¡»ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä¼šåœ¨è¿è¡Œæ—¶è¢«è°ƒç”¨ï¼Œè¢«è£…é¥°çš„å£°æ˜ä¿¡æ¯åšä¸ºå‚æ•°ä¼ å…¥ã€‚</p><h2 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h2><h3 id="è£…é¥°å™¨å·¥å‚"><a href="#è£…é¥°å™¨å·¥å‚" class="headerlink" title="è£…é¥°å™¨å·¥å‚"></a>è£…é¥°å™¨å·¥å‚</h3><p>å¦‚æœæˆ‘ä»¬è¦å®šåˆ¶ä¸€ä¸ªä¿®é¥°å™¨åº”ç”¨åˆ°ä¸€ä¸ªå£°æ˜ä¸Šï¼Œæˆ‘ä»¬å¾—å†™ä¸€ä¸ªè£…é¥°å™¨å·¥å‚å‡½æ•°ã€‚ è£…é¥°å™¨å·¥å‚å°±æ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä»¥ä¾›è£…é¥°å™¨åœ¨è¿è¡Œæ—¶è°ƒç”¨ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">color</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) </span>&#123; <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªè£…é¥°å™¨å·¥å‚</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target</span>) </span>&#123; <span class="hljs-comment">//  è¿™æ˜¯è£…é¥°å™¨</span><br>        <span class="hljs-comment">// do something with &quot;target&quot; and &quot;value&quot;...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å±æ€§æè¿°ç¬¦"><a href="#å±æ€§æè¿°ç¬¦" class="headerlink" title="å±æ€§æè¿°ç¬¦"></a>å±æ€§æè¿°ç¬¦</h3><p>Object.defineProperty() æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ç°æœ‰å±æ€§ï¼Œå¹¶è¿”å›æ­¤å¯¹è±¡ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* obj: è¦å®šä¹‰å±æ€§çš„å¯¹è±¡ã€‚</span><br><span class="hljs-comment">* prop: è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„åç§°æˆ– Symbol ã€‚</span><br><span class="hljs-comment">* descriptor: è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§æè¿°ç¬¦ã€‚</span><br><span class="hljs-comment">*/</span><br><span class="hljs-built_in">Object</span>.defineProperty(obj, prop, descriptor)<br></code></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•å…è®¸ç²¾ç¡®åœ°æ·»åŠ æˆ–ä¿®æ”¹å¯¹è±¡çš„å±æ€§ã€‚é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ Object.defineProperty() æ·»åŠ çš„å±æ€§å€¼æ˜¯ä¸å¯ä¿®æ”¹(immutable)çš„ã€‚</p><h3 id="æ•°æ®æè¿°ç¬¦"><a href="#æ•°æ®æè¿°ç¬¦" class="headerlink" title="æ•°æ®æè¿°ç¬¦"></a>æ•°æ®æè¿°ç¬¦</h3><p>æ•°æ®æè¿°ç¬¦æ˜¯ä¸€ä¸ªå…·æœ‰å€¼çš„å±æ€§ï¼Œè¯¥å€¼å¯ä»¥æ˜¯å¯å†™çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸å¯å†™çš„ã€‚</p><h3 id="å­˜å–æè¿°ç¬¦"><a href="#å­˜å–æè¿°ç¬¦" class="headerlink" title="å­˜å–æè¿°ç¬¦"></a>å­˜å–æè¿°ç¬¦</h3><p>å­˜å–æè¿°ç¬¦æ˜¯ç”± getter å‡½æ•°å’Œsetter å‡½æ•°æ‰€æè¿°çš„å±æ€§ã€‚</p><h3 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h3><h5 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h5><p>Reflectæ˜¯ ES6 ä¸ºäº†æ“ä½œå¯¹è±¡è€Œæä¾›çš„æ–° APIã€‚Reflectå¯¹è±¡çš„è®¾è®¡ç›®çš„æœ‰è¿™æ ·å‡ ä¸ªã€‚</p><p>å°† Object å¯¹è±¡çš„ä¸€äº›æ˜æ˜¾å±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•ï¼ˆæ¯”å¦‚ Object.definePropertyï¼‰ï¼Œæ”¾åˆ° Reflect å¯¹è±¡ä¸Šã€‚ç°é˜¶æ®µï¼ŒæŸäº›æ–¹æ³•åŒæ—¶åœ¨ Objectå’Œ Reflect å¯¹è±¡ä¸Šéƒ¨ç½²ï¼Œæœªæ¥çš„æ–°æ–¹æ³•å°†åªéƒ¨ç½²åœ¨ Reflect å¯¹è±¡ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä» Reflect å¯¹è±¡ä¸Šå¯ä»¥æ‹¿åˆ°è¯­è¨€å†…éƒ¨çš„æ–¹æ³•ã€‚</p><p>ä¿®æ”¹æŸäº› Object æ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ã€‚æ¯”å¦‚ï¼ŒObject.defineProperty(obj, name, desc)åœ¨æ— æ³•å®šä¹‰å±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè€Œ Reflect.defineProperty(obj, name, desc) åˆ™ä¼šè¿”å› falseã€‚</p><p>è®© Object æ“ä½œéƒ½å˜æˆå‡½æ•°è¡Œä¸ºã€‚æŸäº› Object æ“ä½œæ˜¯å‘½ä»¤å¼ï¼Œæ¯”å¦‚ name in obj å’Œ delete obj[name]ï¼Œè€Œ Reflect.has(obj, name) å’ŒReflect.deleteProperty(obj, name) è®©å®ƒä»¬å˜æˆäº†å‡½æ•°è¡Œä¸ºã€‚</p><p>Reflect å¯¹è±¡çš„æ–¹æ³•ä¸ Proxy å¯¹è±¡çš„æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼Œåªè¦æ˜¯ Proxy å¯¹è±¡çš„æ–¹æ³•ï¼Œå°±èƒ½åœ¨ Reflect å¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚è¿™å°±è®© Proxy å¯¹è±¡å¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨å¯¹åº”çš„ Reflect æ–¹æ³•ï¼Œå®Œæˆé»˜è®¤è¡Œä¸ºï¼Œä½œä¸ºä¿®æ”¹è¡Œä¸ºçš„åŸºç¡€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡ Proxy æ€ä¹ˆä¿®æ”¹é»˜è®¤è¡Œä¸ºï¼Œä½ æ€»å¯ä»¥åœ¨Reflect ä¸Šè·å–é»˜è®¤è¡Œä¸ºã€‚</p><h2 id="ç±»è£…é¥°å™¨"><a href="#ç±»è£…é¥°å™¨" class="headerlink" title="ç±»è£…é¥°å™¨"></a>ç±»è£…é¥°å™¨</h2><p>ç±»è£…é¥°å™¨åº”ç”¨äºç±»æ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥ç›‘è§†ï¼Œä¿®æ”¹æˆ–æ›¿æ¢ç±»å®šä¹‰</p><p>æ¥å£å®šä¹‰ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">declare</span> <span class="hljs-keyword">type</span> ClassDecorator = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TFunction</span> <span class="hljs-attr">extends</span> <span class="hljs-attr">Function</span>&gt;</span>(target: TFunction) =&gt; TFunction | void;</span><br><span class="xml">ç±»è£…é¥°å™¨è¡¨è¾¾å¼ä¼šåœ¨è¿è¡Œæ—¶å½“ä½œå‡½æ•°è¢«è°ƒç”¨ï¼Œç±»çš„æ„é€ å‡½æ•°ä½œä¸ºå…¶å”¯ä¸€çš„å‚æ•°ã€‚</span><br></code></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œå†™ä¸€ä¸ªæœ€ç®€å•çš„è£…é¥°å™¨ï¼š</p><p>decorator.ts :</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">helloWorld</span>(<span class="hljs-params">target: <span class="hljs-built_in">any</span></span>) </span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;hello World!&#x27;</span>)<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;target :&#x27;</span>, target.toString())<br>&#125;<br><br><span class="hljs-meta">@helloWorld</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloWorldClass</span> </span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;jerome&#x27;</span><br>    <br>    <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;I am constructor.&#x27;</span>)<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-title">test</span>(<span class="hljs-params"></span>)</span> &#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;I am test method.&#x27;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œ tsc -p . ç¼–è¯‘ ts æ–‡ä»¶ï¼Œç”Ÿæˆ js æ–‡ä»¶ï¼Œå¹¶ç”¨ node æ‰§è¡Œè¿™ä¸ª js æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> node decorator/decorator.js</span> <br>hello World!<br>target : function HelloWorldClass() &#123;<br>        this.name = &#x27;jerome&#x27;;<br>        console.log(&#x27;I am constructor.&#x27;);<br>    &#125;<br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯è§ï¼Œè£…é¥°å™¨åœ¨è¿è¡Œæ—¶å°±è¢«æ‰§è¡Œï¼Œtarget ä¼ é€’çš„å°±æ˜¯ HelloWorldClass ç±»çš„æ„é€ å‡½æ•°ï¼Œä¹Ÿå°è¯äº†è£…é¥°å™¨çš„å®šä¹‰ä¸­ï¼Œå®ƒåœ¨è¿è¡Œæ—¶è¢«è°ƒç”¨ï¼Œè¢«è£…é¥°çš„å£°æ˜ä¿¡æ¯ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è§£æä¸€ä¸‹è¿™ä¸ª js æ–‡ä»¶ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> __decorate = (<span class="hljs-built_in">this</span> &amp;&amp; <span class="hljs-built_in">this</span>.__decorate) || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">decorators, target, key, desc</span>) </span>&#123;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-built_in">arguments</span>.length,<br>        r = c &lt; <span class="hljs-number">3</span> ? target : desc === <span class="hljs-literal">null</span> ? desc = <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(target, key) : desc,<br>        d;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Reflect</span> === <span class="hljs-string">&quot;object&quot;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Reflect</span>.decorate === <span class="hljs-string">&quot;function&quot;</span>) r = <span class="hljs-built_in">Reflect</span>.decorate(decorators, target, key, desc);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = decorators.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)<br>            <span class="hljs-keyword">if</span> (d = decorators[i]) r = (c &lt; <span class="hljs-number">3</span> ? d(r) : c &gt; <span class="hljs-number">3</span> ? d(target, key, r) : d(target, key)) || r;<br>    <span class="hljs-keyword">return</span> c &gt; <span class="hljs-number">3</span> &amp;&amp; r &amp;&amp; <span class="hljs-built_in">Object</span>.defineProperty(target, key, r), r;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">helloWorld</span>(<span class="hljs-params">target</span>) </span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;hello World!&#x27;</span>);<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;target :&#x27;</span>, target.toString());<br>&#125;<br><span class="hljs-keyword">var</span> HelloWorldClass = <span class="hljs-comment">/** <span class="hljs-doctag">@class </span>*/</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HelloWorldClass</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-built_in">this</span>.name = <span class="hljs-string">&#x27;jerome&#x27;</span>;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;I am constructor.&#x27;</span>);<br>    &#125;<br>    HelloWorldClass.prototype.test = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;I am test method.&#x27;</span>);<br>    &#125;;<br>    HelloWorldClass = __decorate([<br>        helloWorld<br>    ], HelloWorldClass);<br>    <span class="hljs-keyword">return</span> HelloWorldClass;<br>&#125;());<br></code></pre></td></tr></table></figure><p>ä»£ç å¤ªå¤šï¼Œè®©æˆ‘ä»¬åˆ†å‡ æ­¥æ¥è§£æï¼š</p><p>@helloWorld ç±»è£…é¥°å™¨è§£æ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> __decorate = (<span class="hljs-built_in">this</span> &amp;&amp; <span class="hljs-built_in">this</span>.__decorate) || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">decorators, target, key, desc</span>) </span>&#123;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-built_in">arguments</span>.length,<br>        r = c &lt; <span class="hljs-number">3</span> ? target : desc === <span class="hljs-literal">null</span> ? desc = <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(target, key) : desc,<br>        d;<br>   <span class="hljs-comment">// å¦‚æœåŸç”Ÿåå°„å¯ç”¨ï¼Œä½¿ç”¨åŸç”Ÿåå°„è§¦å‘è£…é¥°å™¨</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Reflect</span> === <span class="hljs-string">&quot;object&quot;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Reflect</span>.decorate === <span class="hljs-string">&quot;function&quot;</span>) r = <span class="hljs-built_in">Reflect</span>.decorate(decorators, target, key, desc);<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-comment">// è‡ªå³å‘å·¦è¿­ä»£è£…é¥°å™¨</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = decorators.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)<br>          <span class="hljs-comment">// å¦‚æœè£…é¥°å™¨åˆæ³•ï¼Œå°†å…¶èµ‹å€¼ç»™ d</span><br>            <span class="hljs-keyword">if</span> (d = decorators[i]) r = (c &lt; <span class="hljs-number">3</span> ? d(r) : c &gt; <span class="hljs-number">3</span> ? d(target, key, r) : d(target, key)) || r;<br>  <span class="hljs-keyword">return</span> c &gt; <span class="hljs-number">3</span> &amp;&amp; r &amp;&amp; <span class="hljs-built_in">Object</span>.defineProperty(target, key, r), r;<br>&#125;;<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€è¡Œå®šä¹‰äº† __decorate å‡½æ•°ï¼Œå°±æ˜¯é€šè¿‡ @helloWorld è§£æå‡ºæ¥çš„ï¼Œç”¨æ¥å¤„ç†è£…é¥°å™¨çš„åŠŸèƒ½ã€‚</p><p>è¿™ä¸ªå‡½æ•°æœ‰å››ä¸ªå‚æ•°ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹éƒ½æ˜¯äº›ä»€ä¹ˆ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"> <span class="hljs-comment">/**</span><br><span class="hljs-comment">  * decorators: æ•°ç»„ï¼ŒåŒ…å«å¤šä¸ªè£…é¥°å™¨</span><br><span class="hljs-comment">  * target: è¢«è£…é¥°çš„ç±»ï¼Œå³ HelloWorldClass çš„æ„é€ å‡½æ•°</span><br><span class="hljs-comment">  * key: å˜é‡åç§°</span><br><span class="hljs-comment">  * desc: å±æ€§æè¿°ç¬¦</span><br><span class="hljs-comment">*/</span><br> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">decorators, target, key, desc</span>) </span>&#123;...&#125;<br></code></pre></td></tr></table></figure><p>c &lt; 3 ? ä¸ºä»€ä¹ˆæ˜¯ 3ï¼Œc ä»£è¡¨çš„æ˜¯ä¼ å…¥å‚æ•°çš„ä¸ªæ•°ï¼Œå¦‚æœæœªä¼ å…¥å±æ€§æè¿°ç¬¦ï¼Œr éƒ½ä¸º targetï¼Œè‹¥ä¼ å…¥å±æ€§æè¿°ç¬¦ä¸”ä¸ä¸ºç©ºï¼Œåˆ™ r ä¸ºå±æ€§æè¿°ç¬¦ã€‚</p><p>é€šè¿‡å¯¹è¿™æ®µ js çš„åˆ†æä¹‹åï¼Œå¯ä»¥ç®€åŒ–ä¸ºå¦‚ä¸‹ï¼š</p>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> c = <span class="hljs-number">2</span>, r = target, d;<br> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = decorators.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)<br>   <span class="hljs-keyword">if</span> (d = decorators[i]) r = d(r) || r;<br>   <span class="hljs-keyword">return</span> r;<br></code></pre></td></tr></table></figure><p>å½“è£…é¥°å™¨åˆæ³•æ—¶ï¼Œå°†å…¶èµ‹å€¼ç»™ dï¼Œr = d(r) || r ç›¸å½“äºæŠŠ target ä½œä¸ºå‚æ•°è°ƒç”¨è£…é¥°å™¨å‡½æ•°çš„ç»“æœèµ‹å€¼ç»™ r, å¦‚æœ d(r) æ²¡æœ‰è¿”å›å€¼ï¼Œè¿”å›çš„æ˜¯åŸæ¥çš„ç±» targetï¼Œå½“æœ‰è¿”å›å€¼çš„æ—¶å€™ï¼Œè¿”å›çš„æ˜¯ d(r) çš„ return å†…å®¹ã€‚</p><p>HelloWorldClass ç±»</p><p>ä»æ‰“åŒ…å‡ºçš„ç»“æœæ¥çœ‹ï¼Œç±» HelloWorld è¢«è§£ææˆäº†ä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> HelloWorldClass = <span class="hljs-comment">/** <span class="hljs-doctag">@class </span>*/</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HelloWorldClass</span>(<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-built_in">this</span>.name = <span class="hljs-string">&#x27;jerome&#x27;</span>;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;I am constructor.&#x27;</span>);<br>  &#125;<br>  HelloWorldClass.prototype.test = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;I am test method.&#x27;</span>);<br>  &#125;;<br>  HelloWorldClass = __decorate([<br>      helloWorld<br>  ], HelloWorldClass);<br>  <span class="hljs-keyword">return</span> HelloWorldClass;<br>&#125;());<br></code></pre></td></tr></table></figure><p>åœ¨è‡ªæ‰§è¡Œå‡½æ•°ä¸­ï¼ŒHelloWorldClass æ¥æ”¶ __decorate() å‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œç›¸å½“äºæ”¹å˜äº†æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è£…é¥°å™¨ä¿®æ”¹ç±»çš„åŠŸèƒ½ã€‚</p><h2 id="å¸¦è¿”å›å€¼çš„ç±»è£…é¥°å™¨"><a href="#å¸¦è¿”å›å€¼çš„ç±»è£…é¥°å™¨" class="headerlink" title="å¸¦è¿”å›å€¼çš„ç±»è£…é¥°å™¨"></a>å¸¦è¿”å›å€¼çš„ç±»è£…é¥°å™¨</h2><p>ä¸Šé¢çš„ä¾‹å­æ˜¯æ²¡æœ‰è¿”å›å€¼çš„è£…é¥°å™¨å‡½æ•°ï¼Œå®ƒè¿”å›çš„æ˜¯åŸæ¥çš„ç±»ï¼Œé‚£ä¹ˆå¸¦è¿”å›å€¼çš„è£…é¥°å™¨å‡½æ•°æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿæ˜¯å¦æ˜¯è¢«è£…é¥°å™¨ä¿®æ”¹ä¹‹åçš„ç±»å‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥ä¸€èµ·æ¢ç©¶ä¸€ä¸‹ï¼š</p><p>æŒ‰ç…§ä¹‹å‰çš„æ­¥éª¤ï¼Œè¿™æ¬¡æˆ‘ä»¬çš„è£…é¥°å™¨è¦å¸¦æœ‰è¿”å›å€¼ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ª override æ„é€ å‡½æ•°çš„ä¾‹å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">classDecorator</span>&lt;<span class="hljs-title">T</span> <span class="hljs-title">extends</span> </span>&#123;<span class="hljs-keyword">new</span>(...args:any[]):&#123;&#125;&#125;&gt;(<span class="hljs-title">constructor</span>:<span class="hljs-title">T</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">constructor</span> </span>&#123;<br>        newProperty = <span class="hljs-string">&quot;new property&quot;</span>;<br>        hello = <span class="hljs-string">&quot;override&quot;</span>;<br>    &#125;<br>&#125;<br><br>@classDecorator<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Greeter</span> </span>&#123;<br>    property = <span class="hljs-string">&quot;property&quot;</span>;<br>    hello: string;<br>    <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">m: string</span>)</span> &#123;<br>        <span class="hljs-built_in">this</span>.hello = m;<br>    &#125;<br>&#125;<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> Greeter(<span class="hljs-string">&quot;world&quot;</span>));<br></code></pre></td></tr></table></figure><p>è¿è¡Œçš„ç»“æœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> node decorator/decoratorReturn.js</span> <br>class_1 &#123;<br>property: &#x27;property&#x27;,<br>hello: &#x27;override&#x27;,<br>newProperty: &#x27;new property&#x27;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±ä»£ç å¯çŸ¥ï¼ŒGreeter çš„æ„é€ å‡½æ•°æ˜¯å¯¹ hello çš„èµ‹å€¼ä¸º worldï¼Œç„¶è€Œåœ¨ä½¿ç”¨äº† @classDecorator è¿™ä¸ªæ„é€ å‡½æ•°ä¹‹åï¼Œhello çš„å€¼å˜ä¸ºäº† override, è¯´æ˜äº†ç±»è£…é¥°å™¨åº”ç”¨äºç±»æ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥ç›‘è§†ï¼Œä¿®æ”¹æˆ–æ›¿æ¢ç±»å®šä¹‰ã€‚</p><h2 id="å±æ€§è£…é¥°å™¨"><a href="#å±æ€§è£…é¥°å™¨" class="headerlink" title="å±æ€§è£…é¥°å™¨"></a>å±æ€§è£…é¥°å™¨</h2><p>å±æ€§è£…é¥°å™¨å£°æ˜åœ¨ä¸€ä¸ªå±æ€§å£°æ˜ä¹‹å‰ï¼Œå±æ€§è£…é¥°å™¨è¡¨è¾¾å¼ä¼šåœ¨è¿è¡Œæ—¶å½“ä½œå‡½æ•°è¢«è°ƒç”¨ï¼Œä¼ å…¥ä¸‹åˆ—2ä¸ªå‚æ•°ï¼š</p><p>å¯¹äºé™æ€æˆå‘˜æ¥è¯´æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œå¯¹äºå®ä¾‹æˆå‘˜æ˜¯ç±»çš„åŸå‹å¯¹è±¡<br>æˆå‘˜çš„åå­—ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">declare</span> <span class="hljs-keyword">type</span> PropertyDecorator =<br>  <span class="hljs-function">(<span class="hljs-params">target: <span class="hljs-built_in">Object</span>, propertyKey: <span class="hljs-built_in">string</span> | symbol</span>) =&gt;</span> <span class="hljs-built_in">void</span>;<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œå¦‚ä½•ç†è§£å‘¢ï¼Œè®©æˆ‘ä»¬æ¥çœ‹æ®µä»£ç ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logParameter</span>(<span class="hljs-params">target: <span class="hljs-built_in">Object</span>, propertyName: <span class="hljs-built_in">string</span></span>) </span>&#123;<br>    <span class="hljs-comment">// å±æ€§å€¼</span><br>    <span class="hljs-keyword">let</span> _val = <span class="hljs-built_in">this</span>[propertyName];<br><br>    <span class="hljs-comment">// å±æ€§è¯»å–è®¿é—®å™¨</span><br>    <span class="hljs-keyword">const</span> getter = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Get: <span class="hljs-subst">$&#123;propertyName&#125;</span> =&gt; <span class="hljs-subst">$&#123;_val&#125;</span>`</span>);<br>        <span class="hljs-keyword">return</span> _val;<br>    &#125;;<br><br>    <span class="hljs-comment">// å±æ€§å†™å…¥è®¿é—®å™¨</span><br>    <span class="hljs-keyword">const</span> setter = <span class="hljs-function"><span class="hljs-params">newVal</span> =&gt;</span> &#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Set: <span class="hljs-subst">$&#123;propertyName&#125;</span> =&gt; <span class="hljs-subst">$&#123;newVal&#125;</span>`</span>);<br>        _val = newVal;<br>    &#125;;<br><br>    <span class="hljs-comment">// åˆ é™¤å±æ€§</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">delete</span> <span class="hljs-built_in">this</span>[propertyName]) &#123;<br>        <span class="hljs-comment">// åˆ›å»ºæ–°å±æ€§åŠå…¶è¯»å–è®¿é—®å™¨ã€å†™å…¥è®¿é—®å™¨</span><br>        <span class="hljs-built_in">Object</span>.defineProperty(target, propertyName, &#123;<br>            <span class="hljs-attr">get</span>: getter,<br>            <span class="hljs-attr">set</span>: setter,<br>            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span><br>        &#125;);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Greeter</span> </span>&#123;<br>    <span class="hljs-meta">@logParameter</span><br>    <span class="hljs-attr">greeting</span>: <span class="hljs-built_in">string</span>;<br>&#125;<br><br><span class="hljs-keyword">const</span> greeter = <span class="hljs-keyword">new</span> Greeter();<br>greeter.greeting = <span class="hljs-string">&#x27;Jerome&#x27;</span>;<br>greeter.greeting<br></code></pre></td></tr></table></figure><p>è¿è¡Œè¿™æ®µä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> node decorator/prototype.js</span> <br>Set: greeting =&gt; Jerome<br>Get: greeting =&gt; Jerome<br></code></pre></td></tr></table></figure><p>ä»ç»“æœå¯çŸ¥ï¼Œåœ¨å®ä¾‹ä¸­ä½¿ç”¨äº† getter å’Œ setter æ–¹æ³•ä¹‹åï¼Œéƒ½ä¼šæ‰“å°å‡ºç›¸åº”çš„ logï¼Œå³è£…é¥°å™¨çš„è¡¨è¾¾å¼åœ¨è¿è¡Œçš„æ—¶å€™è¢«è°ƒç”¨äº†ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹ç¼–è¯‘æˆ js ä¹‹åçš„ Greeter ç±»</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> Greeter = <span class="hljs-comment">/** <span class="hljs-doctag">@class </span>*/</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Greeter</span>(<span class="hljs-params"></span>) </span>&#123;<br>    &#125;<br>    __decorate([<br>        logParameter,<br>        __metadata(<span class="hljs-string">&quot;design:type&quot;</span>, <span class="hljs-built_in">String</span>)<br>    ], Greeter.prototype, <span class="hljs-string">&quot;greeting&quot;</span>, <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">return</span> Greeter;<br>&#125;());<br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯è§ï¼Œæ­¤æ¬¡ __decorate å‡½æ•°ä¼ å…¥äº† 4 ä¸ªå‚æ•°ï¼Œç”±åœ¨ç±»è£…é¥°å™¨åˆ†æçš„ _decorate å‡½æ•°å¯çŸ¥ï¼š</p><p>â€‹ ä»å³å¾€å·¦è¿è¡Œè£…é¥°å™¨ï¼Œå…ˆè¿è¡Œ__metadata(â€œdesign:typeâ€, String) è¡¨ç¤ºè¢«è£…é¥°çš„å‚æ•° greeting æ˜¯ String ç±»å‹ï¼Œå†è¿è¡Œ logParameter è£…é¥°å™¨ï¼Œæ”¹å†™ greeting å‚æ•°çš„ getter å’Œ setter æ–¹æ³•ã€‚</p><h2 id="æ–¹æ³•è£…é¥°å™¨"><a href="#æ–¹æ³•è£…é¥°å™¨" class="headerlink" title="æ–¹æ³•è£…é¥°å™¨"></a>æ–¹æ³•è£…é¥°å™¨</h2><p>æ–¹æ³•è£…é¥°å™¨å£°æ˜åœ¨ä¸€ä¸ªæ–¹æ³•çš„å£°æ˜ä¹‹å‰ï¼ˆç´§é ç€æ–¹æ³•å£°æ˜ï¼‰ã€‚ å®ƒä¼šè¢«åº”ç”¨åˆ°æ–¹æ³•çš„ å±æ€§æè¿°ç¬¦ä¸Šï¼Œå¯ä»¥ç”¨æ¥ç›‘è§†ï¼Œä¿®æ”¹æˆ–è€…æ›¿æ¢æ–¹æ³•å®šä¹‰ã€‚</p><p>æ–¹æ³•è£…é¥°å™¨è¡¨è¾¾å¼ä¼šåœ¨è¿è¡Œæ—¶å½“ä½œå‡½æ•°è¢«è°ƒç”¨ï¼Œä¼ å…¥ä¸‹åˆ—3ä¸ªå‚æ•°ï¼š</p><p>targetï¼šå¯¹äºé™æ€æˆå‘˜æ¥è¯´æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œå¯¹äºå®ä¾‹æˆå‘˜æ˜¯ç±»çš„åŸå‹å¯¹è±¡ã€‚</p><p>propertyKeyï¼šæˆå‘˜çš„åå­—ã€‚</p><p>descriptorï¼šæˆå‘˜çš„å±æ€§æè¿°ç¬¦ã€‚</p><p>åŒæ ·åœ°ï¼Œè®©æˆ‘ä»¬æ¥çœ‹æ®µä»£ç ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logMethod</span>(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">    target: <span class="hljs-built_in">Object</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    propertyName: <span class="hljs-built_in">string</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    propertyDescriptor: PropertyDescriptor</span>): <span class="hljs-title">PropertyDescriptor</span> </span>&#123;<br>    <span class="hljs-keyword">const</span> method = propertyDescriptor.value;<br><br>    propertyDescriptor.value = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) </span>&#123;<br>        <span class="hljs-comment">// å°† greet çš„å‚æ•°åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span><br>        <span class="hljs-keyword">const</span> params = args.map(<span class="hljs-function"><span class="hljs-params">a</span> =&gt;</span> <span class="hljs-built_in">JSON</span>.stringify(a)).join();<br>        <span class="hljs-comment">// è°ƒç”¨ greet() å¹¶è·å–å…¶è¿”å›å€¼</span><br>        <span class="hljs-keyword">const</span> result = method.apply(<span class="hljs-built_in">this</span>, args);<br>        <span class="hljs-comment">// è½¬æ¢ç»“å°¾ä¸ºå­—ç¬¦ä¸²</span><br>        <span class="hljs-keyword">const</span> r = <span class="hljs-built_in">JSON</span>.stringify(result);<br>        <span class="hljs-comment">// åœ¨ç»ˆç«¯æ˜¾ç¤ºå‡½æ•°è°ƒç”¨ç»†èŠ‚</span><br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Call: <span class="hljs-subst">$&#123;propertyName&#125;</span>(<span class="hljs-subst">$&#123;params&#125;</span>) =&gt; <span class="hljs-subst">$&#123;r&#125;</span>`</span>);<br>        <span class="hljs-comment">// è¿”å›è°ƒç”¨å‡½æ•°çš„ç»“æœ</span><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>    <span class="hljs-keyword">return</span> propertyDescriptor;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Greeter</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> name: <span class="hljs-built_in">string</span></span>)</span> &#123; &#125;<br><br>    <span class="hljs-meta">@logMethod</span><br>    greet(message: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-built_in">this</span>.name&#125;</span> says: <span class="hljs-subst">$&#123;message&#125;</span>`</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> greeter = <span class="hljs-keyword">new</span> Greeter(<span class="hljs-string">&#x27;Jerome&#x27;</span>);<br>greeter.greet(<span class="hljs-string">&#x27;Hello&#x27;</span>);<br></code></pre></td></tr></table></figure><p>è¿è¡Œè¿™æ®µä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> node decorator/method.js</span> <br>Call: greet(&quot;Hello&quot;) =&gt; &quot;Jerome says: Hello&quot;<br></code></pre></td></tr></table></figure><p>ç”±æ‰“å°ç»“æœå¯çŸ¥ï¼ŒlogMethod è¿™ä¸ªæ–¹æ³•è£…é¥°å™¨åœ¨è¿è¡Œæ—¶å½“ä½œäº†å‡½æ•°è¢«è°ƒç”¨ã€‚è¯¥å‡½æ•°æœ‰åˆ©äºå†…å®¡æ–¹æ³•çš„è°ƒç”¨ï¼Œç¬¦åˆé¢å‘åˆ‡é¢ç¼–ç¨‹çš„æ€æƒ³ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹ç¼–è¯‘æˆ js ä¹‹åçš„ Greeter ç±»ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> Greeter = <span class="hljs-comment">/** <span class="hljs-doctag">@class </span>*/</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Greeter</span>(<span class="hljs-params">name</span>) </span>&#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br>    Greeter.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; says: &quot;</span> + message;<br>    &#125;;<br>    __decorate([<br>        logMethod,<br>        __metadata(<span class="hljs-string">&quot;design:type&quot;</span>, <span class="hljs-built_in">Function</span>),<br>        __metadata(<span class="hljs-string">&quot;design:paramtypes&quot;</span>, [<span class="hljs-built_in">String</span>]),<br>        __metadata(<span class="hljs-string">&quot;design:returntype&quot;</span>, <span class="hljs-built_in">String</span>)<br>    ], Greeter.prototype, <span class="hljs-string">&quot;greet&quot;</span>, <span class="hljs-literal">null</span>);<br>    <span class="hljs-keyword">return</span> Greeter;<br>&#125;());<br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯è§ï¼Œæ­¤æ¬¡ __decorate å‡½æ•°ä¼ å…¥äº† 4 ä¸ªå‚æ•°ï¼Œç”±åœ¨ç±»è£…é¥°å™¨åˆ†æçš„ _decorate å‡½æ•°å¯çŸ¥ï¼š</p><p>â€‹ ä»å³å¾€å·¦è¿è¡Œè£…é¥°å™¨ï¼Œå…ˆè¿è¡Œ__metadata(â€œdesign:returntypeâ€, String) è¡¨ç¤ºè¢«è£…é¥°çš„æ–¹æ³• greet çš„è¿”å›å€¼çš„å±æ€§æ˜¯ String ç±»å‹ï¼Œ __metadata(â€œdesign:paramtypesâ€, [String]) è¡¨ç¤ºæ–¹æ³•å‚æ•°çš„ç±»å‹æ˜¯ Stringï¼Œ__metadata(â€œdesign:typeâ€, Function)è¡¨ç¤ºè¢«è£…é¥°çš„æ˜¯å‡½æ•°ç±»å‹ï¼Œå†è¿è¡Œ logMethod è£…é¥°å™¨ï¼Œæ‰“å°å‡ºäº†å‡½æ•°è°ƒç”¨çš„ç»†èŠ‚ã€‚</p><h2 id="å‚æ•°è£…é¥°å™¨"><a href="#å‚æ•°è£…é¥°å™¨" class="headerlink" title="å‚æ•°è£…é¥°å™¨"></a>å‚æ•°è£…é¥°å™¨</h2><p>å‚æ•°è£…é¥°å™¨å£°æ˜åœ¨ä¸€ä¸ªå‚æ•°å£°æ˜ä¹‹å‰ï¼ˆç´§é ç€å‚æ•°å£°æ˜ï¼‰ã€‚ å‚æ•°è£…é¥°å™¨åº”ç”¨äºç±»æ„é€ å‡½æ•°æˆ–æ–¹æ³•å£°æ˜ã€‚</p><p>å‚æ•°è£…é¥°å™¨è¡¨è¾¾å¼ä¼šåœ¨è¿è¡Œæ—¶å½“ä½œå‡½æ•°è¢«è°ƒç”¨ï¼Œä¼ å…¥ä¸‹åˆ—3ä¸ªå‚æ•°ï¼š</p><p>targetï¼šå¯¹äºé™æ€æˆå‘˜æ¥è¯´æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œå¯¹äºå®ä¾‹æˆå‘˜æ˜¯ç±»çš„åŸå‹å¯¹è±¡ã€‚</p><p>propertyKeyï¼šæˆå‘˜çš„åå­—ã€‚</p><p>indexï¼šå‚æ•°åœ¨å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­çš„ç´¢å¼•ã€‚</p><p>åŒæ ·åœ°ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logParameter</span>(<span class="hljs-params">target: <span class="hljs-built_in">Object</span>, propertyName: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>) </span>&#123;<br>    <span class="hljs-comment">// ä¸ºç›¸åº”æ–¹æ³•ç”Ÿæˆå…ƒæ•°æ®é”®ï¼Œä»¥å‚¨å­˜è¢«è£…é¥°çš„å‚æ•°çš„ä½ç½®</span><br>    <span class="hljs-keyword">const</span> metadataKey = <span class="hljs-string">`log_<span class="hljs-subst">$&#123;propertyName&#125;</span>_parameters`</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(target[metadataKey])) &#123;<br>        target[metadataKey].push(index);<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        target[metadataKey] = [index];<br>    &#125;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;target =&gt; &#x27;</span>, target)<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Greeter</span> </span>&#123;<br>    greet(<span class="hljs-meta">@logParameter</span> message: <span class="hljs-built_in">string</span>, <span class="hljs-attr">middle</span>:<span class="hljs-built_in">string</span>, <span class="hljs-meta">@logParameter</span> name: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;name&#125;</span> : <span class="hljs-subst">$&#123;message&#125;</span>`</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">const</span> greeter = <span class="hljs-keyword">new</span> Greeter();<br>greeter.greet(<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-string">&#x27;I am middle&#x27;</span>, <span class="hljs-string">&#x27;jerome&#x27;</span>);<br></code></pre></td></tr></table></figure><p>è¿è¡Œæ‰“åŒ…ä¹‹åçš„ jsï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> node decorator/parameter.js</span> <br>target =&gt;  Greeter &#123; greet: [Function], log_greet_parameters: [ 2 ] &#125;<br>target =&gt;  Greeter &#123; greet: [Function], log_greet_parameters: [ 2, 0 ] &#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæ‰“å°äº†ä¸¤ä¸ª logï¼Œmessage å’Œ name çš„ä½ç½®åˆ†åˆ«æ˜¯ 0 å’Œ 2ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹ç¼–è¯‘æˆ js ä¹‹åçš„ Greeter ç±»ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> Greeter = <span class="hljs-comment">/** <span class="hljs-doctag">@class </span>*/</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Greeter</span>(<span class="hljs-params"></span>) </span>&#123;<br>    &#125;<br>    Greeter.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">message, middle, name</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> name + <span class="hljs-string">&quot; : &quot;</span> + message;<br>    &#125;;<br>    __decorate([<br>        __param(<span class="hljs-number">0</span>, logParameter), __param(<span class="hljs-number">2</span>, logParameter),<br>        __metadata(<span class="hljs-string">&quot;design:type&quot;</span>, <span class="hljs-built_in">Function</span>),<br>        __metadata(<span class="hljs-string">&quot;design:paramtypes&quot;</span>, [<span class="hljs-built_in">String</span>, <span class="hljs-built_in">String</span>, <span class="hljs-built_in">String</span>]),<br>        __metadata(<span class="hljs-string">&quot;design:returntype&quot;</span>, <span class="hljs-built_in">String</span>)<br>    ], Greeter.prototype, <span class="hljs-string">&quot;greet&quot;</span>, <span class="hljs-literal">null</span>);<br>    <span class="hljs-keyword">return</span> Greeter;<br>&#125;());<br></code></pre></td></tr></table></figure><p>â€‹ ç”±æ­¤å¯è§ï¼Œæ­¤æ¬¡ _decorate å‡½æ•°ä¹Ÿä¼ å…¥ 4 ä¸ªå‚æ•°ï¼Œæ³¨æ„ç¬¬ 4 ä¸ªå‚æ•°ä¸º nullï¼Œè¿™åœ¨ _decorate å‡½æ•°ä¸­ä¼šä½¿ r çš„å€¼æœ‰æ‰€ä¸åŒã€‚ç”±å‰é¢å¯çŸ¥ï¼Œè£…é¥°å™¨ä»å³å¾€å·¦è¿è¡Œï¼Œä¾æ¬¡ç¡®å®šè¢«è£…é¥°å¯¹è±¡çš„è¿”å›å€¼ç±»å‹ï¼Œå‚æ•°ç±»å‹ä»¥åŠè‡ªèº«çš„ç±»å‹ä¸º Functionï¼Œè¿™é‡Œæœ‰ä¸ªä¸ä¸€æ ·çš„ __param() è£…é¥°å™¨ï¼Œè®©æˆ‘ä»¬ä¹Ÿæ¥äº†è§£ä¸€ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> __param = (<span class="hljs-built_in">this</span> &amp;&amp; <span class="hljs-built_in">this</span>.__param) || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">paramIndex, decorator</span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, key</span>) </span>&#123;<br>        decorator(target, key, paramIndex);<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>å¯è§ï¼Œä»–è°ƒç”¨äº† logParameter å‡½æ•°ï¼Œå¹¶ä¼ å…¥äº†ä¸€ä¸ª paramIndex è¡¨ç¤ºå‚æ•°çš„ä½ç½®ã€‚ç”±æ­¤ï¼Œå‚æ•°è£…é¥°å™¨ä¹Ÿä¸€ç›®äº†ç„¶äº†ã€‚</p><p>è®¿é—®å™¨è£…é¥°å™¨<br>è®¿é—®å™¨è£…é¥°å™¨åº”ç”¨äºè®¿é—®å™¨çš„å±æ€§æè¿°ç¬¦ï¼Œå¯ç”¨äºè§‚æµ‹ã€ä¿®æ”¹ã€æ›¿æ¢è®¿é—®å™¨çš„å®šä¹‰ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enumerable</span>(<span class="hljs-params">value: <span class="hljs-built_in">boolean</span></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">        target: <span class="hljs-built_in">any</span>, propertyKey: <span class="hljs-built_in">string</span>, descriptor: PropertyDescriptor</span>) </span>&#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;decorator - sets the enumeration part of the accessor&#x27;</span>);<br>        descriptor.enumerable = value;<br>    &#125;;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> _age: <span class="hljs-built_in">number</span> = <span class="hljs-number">18</span>;<br>    <span class="hljs-keyword">private</span> _name: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;jerome&#x27;</span>;<br><br>    <span class="hljs-meta">@enumerable</span>(<span class="hljs-literal">false</span>)<br>    <span class="hljs-keyword">get</span> <span class="hljs-title">age</span>() &#123; <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._age; &#125;<br><br>    <span class="hljs-keyword">set</span> <span class="hljs-title">age</span>(<span class="hljs-params">age: <span class="hljs-built_in">any</span></span>) &#123; <span class="hljs-built_in">this</span>._age = age; &#125;<br><br>    <span class="hljs-meta">@enumerable</span>(<span class="hljs-literal">true</span>)<br>    <span class="hljs-keyword">get</span> <span class="hljs-title">name</span>() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._name;<br>    &#125;<br><br>    <span class="hljs-keyword">set</span> <span class="hljs-title">name</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) &#123;<br>        <span class="hljs-built_in">this</span>._name = name;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> Person();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> prop <span class="hljs-keyword">in</span> person) &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`enumerable property = <span class="hljs-subst">$&#123;prop&#125;</span>`</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œä¹‹åï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> node decorator/defineObject.js</span> <br>decorator - sets the enumeration part of the accessor<br>decorator - sets the enumeration part of the accessor<br>enumerable property = _age<br>enumerable property = _name<br>enumerable property = name<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªè®¿é—®å™¨ name å’Œ age ï¼Œå¹¶é€šè¿‡è£…é¥°å™¨è®¾ç½®æ˜¯å¦å°†å…¶åˆ—å…¥å¯æšä¸¾å±æ€§ï¼Œæˆ‘ä»¬æŠŠ age è®¾ç½®ä¸ºfalseï¼Œ æ‰€ä»¥åœ¨æ¸…å•ä¸­ä¸ä¼šå‡ºç° ageã€‚</p><h2 id="å…ƒæ•°æ®"><a href="#å…ƒæ•°æ®" class="headerlink" title="å…ƒæ•°æ®"></a>å…ƒæ•°æ®</h2><p>Reflect Metadataæ˜¯ ES7 çš„ä¸€ä¸ªææ¡ˆï¼Œå®ƒä¸»è¦ç”¨æ¥åœ¨å£°æ˜çš„æ—¶å€™æ·»åŠ å’Œè¯»å–å…ƒæ•°æ®ã€‚</p><p>å¯ä»¥é€šè¿‡ npm å®‰è£…è¿™ä¸ªåº“ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm i reflect-metadata --save<br></code></pre></td></tr></table></figure><p>TypeScript æ”¯æŒä¸ºå¸¦æœ‰è£…é¥°å™¨çš„å£°æ˜ç”Ÿæˆå…ƒæ•°æ®ã€‚ ä½ éœ€è¦åœ¨å‘½ä»¤è¡Œæˆ– tsconfig.json é‡Œå¯ç”¨ emitDecoratorMetadata ç¼–è¯‘å™¨é€‰é¡¹ã€‚</p><p>å‘½ä»¤è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tsc --target ES5 --experimentalDecorators --emitDecoratorMetadata<br></code></pre></td></tr></table></figure><p>tsconfig.jsonï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;compilerOptions&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;target&quot;</span>: <span class="hljs-string">&quot;ES5&quot;</span>,<br>        <span class="hljs-attr">&quot;experimentalDecorators&quot;</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">&quot;emitDecoratorMetadata&quot;</span>: <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“å¯ç”¨åï¼Œåªè¦ reflect-metadata åº“è¢«å¼•å…¥äº†ï¼Œè®¾è®¡é˜¶æ®µæ·»åŠ çš„ç±»å‹ä¿¡æ¯å¯ä»¥åœ¨è¿è¡Œæ—¶ä½¿ç”¨ã€‚å…ƒä¿¡æ¯åå°„ API èƒ½å¤Ÿç”¨æ¥ä»¥æ ‡å‡†æ–¹å¼ç»„ç»‡å…ƒä¿¡æ¯ã€‚ã€Œåå°„ã€çš„æ„æ€æ˜¯ä»£ç å¯ä»¥ä¾¦æµ‹åŒä¸€ç³»ç»Ÿä¸­çš„å…¶ä»–ä»£ç ï¼ˆæˆ–å…¶è‡ªèº«ï¼‰ã€‚åå°„åœ¨ç»„åˆ/ä¾èµ–æ³¨å…¥ã€è¿è¡Œæ—¶ç±»å‹æ–­è¨€ã€æµ‹è¯•ç­‰ä½¿ç”¨åœºæ™¯ä¸‹å¾ˆæœ‰ç”¨ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¹‹å‰å­¦è¿‡çš„å„ç±»è£…é¥°å™¨æ¥ä¿®é¥°ä½ çš„ä»£ç ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;reflect-metadata&quot;</span>;<br><br><span class="hljs-comment">// ã€å‚æ•°è£…é¥°å™¨ã€‘ç”¨æ¥å­˜å‚¨è¢«è£…é¥°å‚æ•°çš„ç´¢å¼•</span><br><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logParameter</span>(<span class="hljs-params">target: <span class="hljs-built_in">Object</span>, propertyName: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> indices = <span class="hljs-built_in">Reflect</span>.getMetadata(<span class="hljs-string">`log_<span class="hljs-subst">$&#123;propertyName&#125;</span>_parameters`</span>, target, propertyName) || [];<br>    indices.push(index);<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;indices =&gt; &#x27;</span>, indices);<br>    <span class="hljs-built_in">Reflect</span>.defineMetadata(<span class="hljs-string">`log_<span class="hljs-subst">$&#123;propertyName&#125;</span>_parameters`</span>, indices, target, propertyName);<br>&#125;<br><br><span class="hljs-comment">// ã€å±æ€§è£…é¥°å™¨ã€‘ç”¨æ¥è·å–å±æ€§çš„è¿è¡Œæ—¶ç±»å‹</span><br><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logProperty</span>(<span class="hljs-params">target: <span class="hljs-built_in">Object</span>, propertyName: <span class="hljs-built_in">string</span></span>): <span class="hljs-title">void</span> </span>&#123;<br>    <span class="hljs-comment">// è·å–å¯¹è±¡å±æ€§çš„è®¾è®¡ç±»å‹</span><br>    <span class="hljs-keyword">var</span> t = <span class="hljs-built_in">Reflect</span>.getMetadata(<span class="hljs-string">&quot;design:type&quot;</span>, target, propertyName);<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">$&#123;propertyName&#125;</span> type: <span class="hljs-subst">$&#123;t.name&#125;</span>`</span>);<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Greeter</span> </span>&#123;<br>    <span class="hljs-meta">@logProperty</span><br>    <span class="hljs-keyword">private</span> name: <span class="hljs-built_in">string</span>;<br>    <br>    <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    greet(<span class="hljs-meta">@logParameter</span> message: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-built_in">this</span>.name&#125;</span> says: <span class="hljs-subst">$&#123;message&#125;</span>`</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> greeter = <span class="hljs-keyword">new</span> Greeter(<span class="hljs-string">&#x27;jerome&#x27;</span>);<br>greeter.greet(<span class="hljs-string">&#x27;hello&#x27;</span>);<br></code></pre></td></tr></table></figure><p>design:type è¡¨ç¤ºè¢«è£…é¥°çš„å¯¹è±¡æ˜¯ä»€ä¹ˆç±»å‹<br>design:paramtypes è¡¨ç¤ºè¢«è£…é¥°å¯¹è±¡çš„å‚æ•°ç±»å‹<br>design:returntype è¡¨ç¤ºè¢«è£…é¥°å¯¹è±¡çš„è¿”å›å€¼å±æ€§</p><p>è¿è¡Œè¿™æ®µä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> node decorator/reflect-metadata.js</span> <br>name type: String<br>indices =&gt;  [ 0 ]<br></code></pre></td></tr></table></figure><p>æ‰“å°å‡ºäº†æˆ‘ä»¬æƒ³çŸ¥é“çš„ name çš„ç±»å‹ä»¥åŠ message çš„å‚æ•°ç´¢å¼•ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>typescript çš„è£…é¥°å™¨æœ¬è´¨ä¸Šæä¾›äº†è¢«è£…é¥°å¯¹è±¡ Property Descriptor çš„æ“ä½œï¼Œéƒ½æ˜¯åœ¨è¿è¡Œçš„æ—¶å€™è¢«å½“ä½œå‡½æ•°è°ƒç”¨ã€‚çœ‹äº†è¿™ç¯‡æ–‡ç« ï¼Œæ˜¯å¦è§‰å¾— typescript è¿™ä¸ªè£…é¥°å™¨çš„ç‰¹æ€§æœ‰ç‚¹åƒ java spring ä¸­æ³¨è§£çš„å†™æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æˆ‘ä»¬å†™çš„è£…é¥°å™¨æ¥å®ç°åå°„ã€ä¾èµ–æ³¨å…¥ï¼Œç±»å‹æ–­è¨€ç­‰ï¼Œå®ç°åœ¨è¿è¡Œä¸­ç¨‹åºå¯¹è‡ªèº«è¿›è¡Œæ£€æŸ¥ï¼Œvscode å°±æ˜¯å…¸å‹çš„åˆ©ç”¨ typescript çš„è£…é¥°å™¨å®ç°äº†ä¾èµ–æ³¨å…¥ï¼Œæœ‰å…´è¶£çš„è¯·å…³æ³¨åç»­çš„æ–‡ç« ã€‚</p><h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>è£…é¥°å™¨æ˜¯æ‰©å±• JavaScript ç±»çš„å»ºè®®ï¼ŒTC39 äº”å¹´æ¥ä¸€ç›´åœ¨ç ”ç©¶è£…é¥°æ–¹æ¡ˆï¼Œæœ‰å…´è¶£çš„å¯ä»¥å…³æ³¨ä¸‹ TC39 çš„è¿™ä¸ª<a href="https://github.com/tc39/proposal-decorators">ææ¡ˆ</a>ï¼Œbabel ä¹Ÿå®ç°äº†è¯¥ææ¡ˆï¼Œ<a href="https://babeljs.io/docs/en/babel-plugin-proposal-decorators">å…·ä½“å¯æŸ¥</a>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>TypeScript</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åŸå‹æ¨¡å¼</title>
    <link href="/2021/06/27/prototype/"/>
    <url>/2021/06/27/prototype/</url>
    
    <content type="html"><![CDATA[<h3 id="åŸå‹å¯¹è±¡"><a href="#åŸå‹å¯¹è±¡" class="headerlink" title="åŸå‹å¯¹è±¡"></a>åŸå‹å¯¹è±¡</h3><p>åœ¨æˆ‘ä»¬åˆ›å»ºçš„ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œéƒ½æœ‰ä¸€ä¸ª prototypeï¼ˆåŸå‹ï¼‰å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ª<strong>æŒ‡é’ˆ</strong>ï¼ŒæŒ‡å‘<strong>åŸå‹å¯¹è±¡</strong>ï¼Œå¹¶ä¸”æ‰€æœ‰çš„åŸå‹å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨è·å¾—ä¸€ä¸ª constructor ï¼Œä¸‹é¢æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶æŠŠæ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•éƒ½æŒ‚è½½åœ¨å‡½æ•°çš„ prototype å±æ€§ä¸‹ï¼Œå¹¶æ–°å»ºä¸¤ä¸ªå¯¹è±¡å®ä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params"></span>) </span>&#123;&#125;<br><br>Person.prototype.name = <span class="hljs-string">&#x27;jerome&#x27;</span><br>Person.prototype.age = <span class="hljs-number">18</span><br>Person.prototype.job = <span class="hljs-string">&#x27;Front End Engineer&#x27;</span><br>Person.prototype.sayName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    alter(<span class="hljs-built_in">this</span>.name)<br>&#125;<br><br><span class="hljs-keyword">const</span> person1 = <span class="hljs-keyword">new</span> Person()<br><span class="hljs-keyword">const</span> person2 = <span class="hljs-keyword">new</span> Person()<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œä»£ç ä¸­å®é™…ä¸Š Person æ„é€ å‡½æ•°ã€Person çš„åŸå‹å±æ€§ä»¥åŠ Person ç°æœ‰çš„ä¸¤ä¸ªå®ä¾‹é—´çš„å…³ç³»æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Œè®©æˆ‘ä»¬çœ‹ä¸‹å›¾ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20210503234607875.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2plcm9tZV83Nzc=,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒPerson çš„ prototype å±æ€§æŒ‡å‘äº† Person çš„åŸå‹å¯¹è±¡ï¼Œè€ŒåŸå‹å¯¹è±¡ä¸­çš„ constructor åˆæŒ‡å›äº† Peronã€‚å¹¶ä¸”åœ¨ Person çš„åŸå‹ä¸‹ï¼Œè¿˜æœ‰æˆ‘ä»¬å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•ã€‚å†çœ‹åˆ›å»ºçš„ä¸¤ä¸ªå®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨å±æ€§ [[prototype]]ï¼ˆ__proto__ï¼‰ æŒ‡å‘äº†åŸå‹å¯¹è±¡ã€‚</p><h3 id="åŸå‹å¯¹è±¡çš„é—®é¢˜"><a href="#åŸå‹å¯¹è±¡çš„é—®é¢˜" class="headerlink" title="åŸå‹å¯¹è±¡çš„é—®é¢˜"></a>åŸå‹å¯¹è±¡çš„é—®é¢˜</h3><p>ç”±äºåŸå‹æ¨¡å¼çœç•¥äº†ä¸ºæ„é€ å‡½æ•°åˆå§‹åŒ–å‚æ•°è¿™ä¸€ç¯èŠ‚ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰çš„å®ä¾‹éƒ½ä¼šå–å¾—ç›¸åŒçš„å±æ€§å€¼ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé€ æˆäº†ä¸ä¾¿ã€‚ä½†æ˜¯ï¼Œè¿˜æœ‰ä¸€ä¸ªæ›´å¤§çš„é—®é¢˜ï¼Œæ˜¯ç”±å…¶å…±äº«çš„æœ¬æ€§æ‰€å¯¼è‡´çš„ï¼Œåœ¨å±æ€§æœ‰å¼•ç”¨ç±»å‹çš„æ—¶å€™ï¼Œè¿™ä¸ªé—®é¢˜å°±æ¯”è¾ƒçªå‡ºäº†ï¼Œè®©æˆ‘ä»¬çœ‹ä¸‹ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params"></span>) </span>&#123;&#125;<br><br>Person.prototype = &#123;<br>    <span class="hljs-attr">constrcutor</span>: Person,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;jerome&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">job</span>: <span class="hljs-string">&#x27;Front End Engineer&#x27;</span>,<br>    <span class="hljs-attr">friends</span>: [<span class="hljs-string">&#x27;shy&#x27;</span>, <span class="hljs-string">&#x27;faker&#x27;</span>],<br>    <span class="hljs-attr">sayName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        alter(<span class="hljs-built_in">this</span>.name)<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> person1 = <span class="hljs-keyword">new</span> Person()<br><span class="hljs-keyword">const</span> person2 = <span class="hljs-keyword">new</span> Person()<br><br>person1.friends.push(<span class="hljs-string">&#x27;rookie&#x27;</span>)<br><br><span class="hljs-built_in">console</span>.log(person1.friends)    <span class="hljs-comment">// &quot;shy,faker,rookie&quot;</span><br><span class="hljs-built_in">console</span>.log(person2.friends)    <span class="hljs-comment">// &quot;shy,faker,rookie&quot;</span><br><span class="hljs-built_in">console</span>.log(person1.friends === person2.friends)    <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>å½“åŸå‹å¯¹è±¡ä¸­æœ‰å¼•ç”¨ç±»å‹çš„å€¼æ—¶ï¼Œä¿®æ”¹å¼•ç”¨ç±»å‹çš„å€¼ï¼Œç”±äºä»–æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ï¼Œä¼šä¿®æ”¹æ‰€æœ‰å®ä¾‹çš„è¿™ä¸ªå±æ€§çš„å€¼ï¼Œå°±å¦‚ä¸Šä»£ç ï¼Œåœ¨ person1.friends å¢åŠ ä¸€ä¸ªå€¼ä¹‹åï¼Œperson1 å’Œ person2 çš„ friends éƒ½è¢«ä¿®æ”¹äº†ã€‚</p><h3 id="ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼"><a href="#ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼" class="headerlink" title="ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼"></a>ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼</h3><p>ç”±äºåœ¨ä½¿ç”¨åŸå‹æ¨¡å¼æ—¶æœ‰å¼•ç”¨ç±»å‹ä¼šé€ æˆçš„é—®é¢˜ï¼Œé‚£ä¹ˆå¯ä»¥ç»“åˆæ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼æ¥ä½¿ç”¨ã€‚è¿™ä¸ªæ–¹æ³•æˆ‘æ€»ç»“äº†ä¸€å¥è¯ï¼šå±æ€§ä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼ï¼ˆä¸å…±äº«ï¼‰ï¼Œæ–¹æ³•ä½¿ç”¨åŸå‹æ¨¡å¼ï¼ˆå…±äº«ï¼‰ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name, age, job</span>) </span>&#123;<br>    <span class="hljs-built_in">this</span>.name = name<br>    <span class="hljs-built_in">this</span>.age = age<br>    <span class="hljs-built_in">this</span>.job = job<br>    <span class="hljs-built_in">this</span>.friends = [<span class="hljs-string">&#x27;shy&#x27;</span>, <span class="hljs-string">&#x27;faker&#x27;</span>]<br>&#125;<br><br>Person.prototype = &#123;<br>    <span class="hljs-attr">constrcutor</span>: Person,<br>    <span class="hljs-attr">sayName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        alter(<span class="hljs-built_in">this</span>.name)<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> person1 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">&#x27;jerome&#x27;</span>, <span class="hljs-number">18</span>, <span class="hljs-string">&#x27;Front End Engineer&#x27;</span>)<br><span class="hljs-keyword">const</span> person2 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">&#x27;the shy&#x27;</span>, <span class="hljs-number">18</span>, <span class="hljs-string">&#x27;gamer&#x27;</span>)<br><br>person1.friends.push(<span class="hljs-string">&#x27;rookie&#x27;</span>)<br><br><span class="hljs-built_in">console</span>.log(person1.friends)    <span class="hljs-comment">// &quot;shy,faker,rookie&quot;</span><br><span class="hljs-built_in">console</span>.log(person2.friends)    <span class="hljs-comment">// &quot;shy,faker&quot;</span><br><span class="hljs-built_in">console</span>.log(person1.friends === person2.friends)    <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªå®ä¾‹çš„ friends å·²ç»ä¸å…±äº«äº†ã€‚</p><h2 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="headerlink" title="åŸå‹é“¾"></a>åŸå‹é“¾</h2><p>åŸå‹é“¾çš„åŸºæœ¬æ€æƒ³æ˜¯åˆ©ç”¨åŸå‹è®©ä¸€ä¸ªå¼•ç”¨ç±»å‹ç»§æ‰¿å¦ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SuperType</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">this</span>.property = <span class="hljs-literal">true</span><br>&#125;<br><br>SuperType.prototype.getSuperValue = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.property<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SubType</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">this</span>.subproperty = <span class="hljs-literal">false</span><br>&#125;<br><br>SubType.prototype = <span class="hljs-keyword">new</span> SuperType()<br><br>SubType.property.getSubValue = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.subproperty<br>&#125;<br><br><span class="hljs-keyword">const</span> instance = <span class="hljs-keyword">new</span> SubType()<br><span class="hljs-built_in">console</span>.log(instance.getSuperValue())   <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œinstance æ˜¯ SubType å¯¹è±¡ï¼Œå´å¯ä»¥ä½¿ç”¨ SuperType çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯ç»§æ‰¿äº† SuperType ï¼Œè€Œç»§æ‰¿çš„å®ç°å°±æ˜¯é€šè¿‡åˆ›å»ºçˆ¶å‡½æ•°çš„å®ä¾‹ï¼Œå¹¶å°†è¯¥å®ä¾‹èµ‹å€¼ç»™å­å‡½æ•°çš„ prototype å®ç°çš„ã€‚å®ç°çš„æœ¬è´¨æ˜¯é‡å†™åŸå‹å¯¹è±¡ï¼Œä»£ä¹‹ä»¥ä¸€ä¸ªæ–°ç±»å‹çš„å®ä¾‹ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸‹ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20210503234623313.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2plcm9tZV83Nzc=,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ SubType é»˜è®¤çš„åŸå‹å¯¹è±¡ï¼Œè€Œæ˜¯ä½¿ç”¨äº† SuperType çš„å®ä¾‹å½“ä½œä»–çš„åŸå‹ã€‚è¿™ä¸ªåŸå‹å«æœ‰ SuperType æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ã€‚ä»ä¹‹å‰åŸå‹å¯¹è±¡çš„çŸ¥è¯†ç‚¹å¯çŸ¥ï¼Œå®ä¾‹çš„å†…éƒ¨è¿˜æœ‰ä¸€ä¸ªæŒ‡é’ˆï¼ˆ[[prototype]]ï¼‰ï¼ŒæŒ‡å‘åŸå‹ï¼Œè¿™é‡Œç›¸å½“äºæ˜¯ SubType çš„åŸå‹å¯¹è±¡æŒ‡å‘äº† SuperType çš„åŸå‹ï¼Œè¿™æ ·å°±å®ç°äº†ç»§æ‰¿ã€‚</p><h3 id="åŸå‹é“¾çš„é—®é¢˜"><a href="#åŸå‹é“¾çš„é—®é¢˜" class="headerlink" title="åŸå‹é“¾çš„é—®é¢˜"></a>åŸå‹é“¾çš„é—®é¢˜</h3><p>åŒæ ·çš„ï¼ŒåŸå‹é“¾ä¹Ÿå«æœ‰å¼•ç”¨ç±»å‹çš„é—®é¢˜ï¼Œé‚£ä¹ˆï¼Œæ¥ä¸‹æ¥æˆ‘å°†ä»‹ç»ä¸€ä¸‹å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h4 id="å€Ÿç”¨æ„é€ å‡½æ•°"><a href="#å€Ÿç”¨æ„é€ å‡½æ•°" class="headerlink" title="å€Ÿç”¨æ„é€ å‡½æ•°"></a>å€Ÿç”¨æ„é€ å‡½æ•°</h4><p>è¿™ä¸ªæ–¹æ³•çš„åŸºæœ¬æ€æƒ³å°±æ˜¯åœ¨å­ç±»å‹æ„é€ å‡½æ•°çš„å†…éƒ¨é€šè¿‡ call æˆ–è€… apply è°ƒç”¨è¶…ç±»å‹æ„é€ å‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SuperType</span>(<span class="hljs-params">name</span>) </span>&#123;<br>    <span class="hljs-built_in">this</span>.name = name<br>    <span class="hljs-built_in">this</span>.friends = [<span class="hljs-string">&#x27;the shy&#x27;</span>, <span class="hljs-string">&#x27;faker&#x27;</span>]<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SubType</span>(<span class="hljs-params"></span>) </span>&#123;<br>    SuperType.call(<span class="hljs-built_in">this</span>, <span class="hljs-string">&#x27;jerome&#x27;</span>)<br>    <span class="hljs-built_in">this</span>.age = <span class="hljs-number">18</span><br>&#125;<br><br><span class="hljs-keyword">const</span> instance1 = <span class="hljs-keyword">new</span> SubType()<br>instance1.friends.push(<span class="hljs-string">&#x27;rookie&#x27;</span>)<br><span class="hljs-built_in">console</span>.log(instance1.friends)   <span class="hljs-comment">// [ &#x27;the shy&#x27;, &#x27;faker&#x27;, &#x27;rookie&#x27; ]</span><br><span class="hljs-built_in">console</span>.log(instance1.name)      <span class="hljs-comment">// jerome</span><br><br><span class="hljs-keyword">const</span> instance2 = <span class="hljs-keyword">new</span> SubType()<br><span class="hljs-built_in">console</span>.log(instance2.friends)   <span class="hljs-comment">// [ &#x27;the shy&#x27;, &#x27;faker&#x27; ]</span><br></code></pre></td></tr></table></figure><p>ä½†è¿™ä¸ªæ–¹æ³•å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæ–¹æ³•éƒ½åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰ï¼Œå‡½æ•°å¤ç”¨ä¹Ÿæ— ä»è¯´èµ·ï¼Œè¿™ä¸ªæ–¹æ³•å¾ˆå°‘å•ç‹¬ä½¿ç”¨ã€‚</p><h4 id="ç»„åˆç»§æ‰¿"><a href="#ç»„åˆç»§æ‰¿" class="headerlink" title="ç»„åˆç»§æ‰¿"></a>ç»„åˆç»§æ‰¿</h4><p>ç»„åˆç»§æ‰¿ï¼Œå°±æ˜¯å°†åŸå‹é“¾å’Œå€Ÿç”¨æ„é€ å‡½æ•°çš„æŠ€æœ¯ç»„åˆåˆ°ä¸€èµ·ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SuperType</span>(<span class="hljs-params">name</span>) </span>&#123;<br>    <span class="hljs-built_in">this</span>.name = name<br>    <span class="hljs-built_in">this</span>.friends = [<span class="hljs-string">&#x27;the shy&#x27;</span>, <span class="hljs-string">&#x27;faker&#x27;</span>]<br>&#125;<br><br>SuperType.prototype.sayName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.name)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SubType</span>(<span class="hljs-params">name, age</span>) </span>&#123;<br>    SuperType.call(<span class="hljs-built_in">this</span>, name)<br>    <span class="hljs-built_in">this</span>.age = age<br>&#125;<br><br><span class="hljs-comment">// ç»§æ‰¿æ–¹æ³•</span><br>SubType.prototype = <span class="hljs-keyword">new</span> SuperType()<br>SubType.prototype.constructor = SubType<br>SubType.prototype.sayAge = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.age)<br>&#125;<br><br><span class="hljs-keyword">const</span> instance1 = <span class="hljs-keyword">new</span> SubType(<span class="hljs-string">&#x27;jerome&#x27;</span>, <span class="hljs-number">18</span>)<br>instance1.friends.push(<span class="hljs-string">&#x27;rookie&#x27;</span>)<br><span class="hljs-built_in">console</span>.log(instance1.friends)  <span class="hljs-comment">// [ &#x27;the shy&#x27;, &#x27;faker&#x27;, &#x27;rookie&#x27; ]</span><br>instance1.sayName() <span class="hljs-comment">// jerome</span><br>instance1.sayAge()  <span class="hljs-comment">// 18</span><br><br><span class="hljs-keyword">const</span> instance2 = <span class="hljs-keyword">new</span> SubType(<span class="hljs-string">&#x27;the shy&#x27;</span>, <span class="hljs-number">19</span>)<br><span class="hljs-built_in">console</span>.log(instance2.friends)  <span class="hljs-comment">// [ &#x27;the shy&#x27;, &#x27;faker&#x27; ]</span><br>instance2.sayName() <span class="hljs-comment">// the shy</span><br>instance2.sayAge()  <span class="hljs-comment">// 19</span><br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯ä»¥çœ‹åˆ° SubType ç»§æ‰¿äº† SuperType çš„å±æ€§å’Œæ–¹æ³•ï¼Œåˆæœ‰è‡ªå·±çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸” friends å±æ€§æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œé¿å…äº†åŸå‹é“¾ï¼ˆå¼•ç”¨ç±»å‹é—®é¢˜ï¼‰å’Œå€Ÿç”¨æ„é€ å‡½æ•°ï¼ˆæ–¹æ³•æ— æ³•å¤ç”¨ï¼‰çš„ç¼ºé™·ï¼Œä½†ç»„åˆç»§æ‰¿ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œæˆ‘ä»¬åç»­ä¼šè¯´åˆ°ã€‚</p><h4 id="åŸå‹å¼ç»§æ‰¿"><a href="#åŸå‹å¼ç»§æ‰¿" class="headerlink" title="åŸå‹å¼ç»§æ‰¿"></a>åŸå‹å¼ç»§æ‰¿</h4><p>åŸå‹å¼ç»§æ‰¿ï¼Œå°±æ˜¯å€ŸåŠ©åŸå‹å¯ä»¥åŸºäºå·²æœ‰çš„å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡ï¼ŒåŒæ—¶è¿˜ä¸å¿…å› æ­¤åˆ›å»ºè‡ªå®šä¹‰ç±»å‹ã€‚å¯ä»¥åˆ©ç”¨ Object.create() æ¥å®ç°ï¼Œè¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªç”¨ä½œæ–°å¯¹è±¡åŸå‹çš„å¯¹è±¡å’Œä¸€ä¸ªä¸ºæ–°å¯¹è±¡å®šä¹‰é¢å¤–å±æ€§çš„å¯¹è±¡ï¼ˆå¯é€‰ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> person = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;jerome&#x27;</span>,<br>    <span class="hljs-attr">friends</span>: [<span class="hljs-string">&#x27;the shy&#x27;</span>, <span class="hljs-string">&#x27;faker&#x27;</span>]<br>&#125;<br><br><span class="hljs-keyword">const</span> anotherPerson = <span class="hljs-built_in">Object</span>.create(person, &#123;<br>    <span class="hljs-attr">name</span>: &#123;<br>        <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;rookie&#x27;</span><br>    &#125;<br>&#125;)<br><br>anotherPerson.friends.push(<span class="hljs-string">&#x27;zoom&#x27;</span>)  <br><span class="hljs-built_in">console</span>.log(anotherPerson.name)     <span class="hljs-comment">// rookie</span><br><span class="hljs-built_in">console</span>.log(person.friends)     <span class="hljs-comment">// [ &#x27;the shy&#x27;, &#x27;faker&#x27;, &#x27;zoom&#x27; ]</span><br><span class="hljs-built_in">console</span>.log(anotherPerson.friends)  <span class="hljs-comment">// [ &#x27;the shy&#x27;, &#x27;faker&#x27;, &#x27;zoom&#x27; ]</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒåŸå‹å¼ç»§æ‰¿è¿˜æœ‰å¼•ç”¨ç±»å‹çš„é—®é¢˜</p><h4 id="å¯„ç”Ÿå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿå¼ç»§æ‰¿"></a>å¯„ç”Ÿå¼ç»§æ‰¿</h4><p>å¯„ç”Ÿå¼ç»§æ‰¿ï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ªä»…ç”¨äºå°è£…ç»§æ‰¿è¿‡ç¨‹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨å†…éƒ¨ä»¥æŸç§æ–¹å¼æ¥å¢å¼ºå¯¹è±¡ï¼Œæœ€åè¿”å›å¯¹è±¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createAnother</span>(<span class="hljs-params">original</span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> clone = <span class="hljs-built_in">Object</span>.create(original)<br>    clone.sayHi = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;hi&#x27;</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> clone<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¾‹å­ä¸­ï¼Œè¯¥å‡½æ•°ä¸ºæºå¯¹è±¡å¢åŠ äº†ä¸€ä¸ª sayHi çš„æ–¹æ³•ï¼Œå’ŒåŸå‹å¼ç»§æ‰¿ç±»ä¼¼ã€‚</p><h4 id="å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"></a>å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿</h4><p>ä»å‰é¢çœ‹ï¼Œç»„åˆå¼ç»§æ‰¿ä¼¼ä¹å°±æ˜¯æœ€å¥½æœ€å¸¸ç”¨çš„ç»§æ‰¿æ–¹å¼ï¼Œä¸è¿‡ï¼Œå®ƒä¹Ÿæœ‰è‡ªå·±çš„ä¸è¶³ï¼Œç»„åˆå¼ç»§æ‰¿æ— è®ºåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œéƒ½ä¼šè°ƒç”¨ä¸¤æ¬¡è¶…ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡æ˜¯åœ¨ new SuperType() çš„æ—¶å€™ï¼Œç¬¬äºŒæ¬¡æ˜¯åœ¨è°ƒç”¨ SuperType.call çš„æ—¶å€™ã€‚</p><p>å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œå³é€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥ç»§æ‰¿å±æ€§ï¼Œé€šè¿‡åŸå‹é“¾çš„æ··æˆå½¢å¼æ¥ç»§æ‰¿æ–¹æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// ç›¸å½“äº subType çš„åŸå‹å¯¹è±¡ä¸ç›´æ¥ new å‡ºæ¥ï¼Œè€Œæ˜¯ä» Object ç»§æ‰¿ä¸‹æ¥</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inheritPrototype</span>(<span class="hljs-params">subType, superType</span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> prototype = <span class="hljs-built_in">Object</span>.create(superType.prototype)<br>    prototype.constructor = subType<span class="hljs-comment">// constructor æŒ‡å›æ„é€ å‡½æ•°</span><br>    subType.prototype = prototype<span class="hljs-comment">// prototype æŒ‡å‘åŸå‹å¯¹è±¡</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SuperType</span>(<span class="hljs-params">name</span>) </span>&#123;<br>    <span class="hljs-built_in">this</span>.name = name<br>    <span class="hljs-built_in">this</span>.friends = [<span class="hljs-string">&#x27;the shy&#x27;</span>, <span class="hljs-string">&#x27;faker&#x27;</span>]<br>&#125;<br><br>SuperType.prototype.sayName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.name)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SubType</span>(<span class="hljs-params">name, age</span>) </span>&#123;<br>    SuperType.call(<span class="hljs-built_in">this</span>, name)<br>    <span class="hljs-built_in">this</span>.age = age<br>&#125;<br><br>inheritPrototype(SubType, SuperType)<br><br>SubType.prototype.sayAge = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.age)<br>&#125;<br><br><span class="hljs-keyword">const</span> instance1 = <span class="hljs-keyword">new</span> SubType(<span class="hljs-string">&#x27;jerome&#x27;</span>, <span class="hljs-number">18</span>)<br>instance1.friends.push(<span class="hljs-string">&#x27;zoom&#x27;</span>)<br><span class="hljs-built_in">console</span>.log(instance1.friends)  <span class="hljs-comment">// [ &#x27;the shy&#x27;, &#x27;faker&#x27;, &#x27;chen&#x27; ]</span><br>instance1.sayName() <span class="hljs-comment">// jerome</span><br>instance1.sayAge()  <span class="hljs-comment">// 18</span><br><br><br><span class="hljs-keyword">const</span> instance2 = <span class="hljs-keyword">new</span> SubType(<span class="hljs-string">&#x27;rookie&#x27;</span>, <span class="hljs-number">19</span>)<br><span class="hljs-built_in">console</span>.log(instance2.friends)  <span class="hljs-comment">// [ &#x27;the shy&#x27;, &#x27;faker&#x27; ]</span><br>instance2.sayName() <span class="hljs-comment">// rookie</span><br>instance2.sayAge()  <span class="hljs-comment">//19</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­çš„é«˜æ•ˆç‡æç°åœ¨å®ƒåªè°ƒç”¨äº†ä¸€æ¬¡è¶…ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œé¿å…åœ¨ SubType.prototype ä¸Šåˆ›å»ºä¸å¿…è¦çš„ã€å¤šä½™çš„å±æ€§ã€‚ä¸æ­¤åŒæ—¶ï¼ŒåŸå‹é“¾è¿˜èƒ½ä¿æŒä¸å˜ï¼Œå¯„ç”Ÿç»„åˆç»§æ‰¿æ˜¯å¼•ç”¨ç±»å‹æœ€ç†æƒ³çš„ç»§æ‰¿èŒƒå¼ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
